(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["centerCheckBill4cld"],{"0002c":function(t,e,i){"use strict";var s=i("6736"),n=i.n(s);n.a},"01f7":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"details-content",staticClass:"item-details-content"},[i("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoadMore},model:{value:t.currentListLoading,callback:function(e){t.currentListLoading=e},expression:"currentListLoading"}},t._l(t.itemList,function(e,s){return i("div",{key:e.goodsDTO.id,ref:"details-row-"+s,refInFor:!0,staticClass:"item-detail"},[t._t("item-cell",null,{$item:e,$index:s})],2)}),0)],1)},n=[],a=i("795b"),o=i.n(a),c=(i("c5f6"),{name:"addItemList",props:{value:[String,Number],itemList:{type:Array,default:function(){return[]}},listLoading:Boolean,loadFinished:Boolean,listError:{type:Boolean,default:!1}},data:function(){return{currentListLoading:!1}},watch:{listLoading:{handler:function(t){this.currentListLoading=t},immediate:!0},currentListLoading:function(t){this.$emit("update:listLoading",t)}},computed:{comptedItemImgSrc:function(t){return function(t){return 0===t.length?"":t[0]}}},methods:{onLoadMore:function(){this.$emit("on-load-more")},onSelectLetter:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,i=this.$refs["details-row-".concat(t)];if(!i||0===i.length)return!1;var s=i[0].offsetTop,n=this.$refs["details-content"];this.$fxUtils.scrollTopW({offsetTop:s,$el:n,distance:e})},prev:function(t){var e=this;return new o.a(function(i){if(0===t)return!1;var s=t-1,n=e.itemList[s];e.onSelectLetter(s),i({data:n,index:s})})},next:function(t){var e=this;return new o.a(function(i){if(t===e.itemList.length-1)return!1;var s=t+1,n=e.itemList[s];e.onSelectLetter(s),i({data:n,index:s})})}}}),l=c,r=(i("2f8b"),i("2877")),d=Object(r["a"])(l,s,n,!1,null,"7690e6e7",null);e["a"]=d.exports},"08d9":function(t,e,i){},"09fc":function(t,e,i){},"0a97":function(t,e,i){"use strict";var s=i("09fc"),n=i.n(s);n.a},"0f38":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.visibleFlag,expression:"visibleFlag"}],staticClass:"order-checkbox",on:{click:t.onCheckboxClick},scopedSlots:t._u([{key:"icon",fn:function(e){return i("img",{staticClass:"checked-box-icon",attrs:{src:e.checked?t.checkedIcon.active:t.checkedIcon.normal}})}}]),model:{value:t.$attrs.checked,callback:function(e){t.$set(t.$attrs,"checked",e)},expression:"$attrs.checked"}})},n=[],a={name:"checkBox",props:{visibleFlag:{type:Boolean,default:!1}},data:function(){return{checkedIcon:{normal:i("41c0"),active:i("f3c0")}}},methods:{onCheckboxClick:function(){this.$emit("on-checkbox-click")}}},o=a,c=(i("dab9"),i("2877")),l=Object(c["a"])(o,s,n,!1,null,"4e0c8b3e",null);e["a"]=l.exports},"11a2":function(t,e,i){},"1dcf":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",[i("w-app-container",[i("w-header",{attrs:{title:t.orderInfoData.sysbillCode,titleFontSize:"3.733vw",border:!0}}),i("orderInfo",{ref:"orderInfo",attrs:{data:t.orderInfoData,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("centerCheckBill4cld.save")},on:{"on-rdc-click":t.onRdcClick,"on-house-click":t.onHouseClick,"on-checkType-click":t.onCheckTypeClick,"on-busdate-click":t.onBusinessDateClick,"on-notCheckType-click":t.onNotCheckTypeClick,"on-groupFlag-click":t.onGroupFlagClick,"on-costType-click":t.onCostTypeClick,"on-businessType-click":t.onBillTypeClick,"on-item-clear":t.onItemClear}}),i("orderItem",{ref:"orderItem",attrs:{data:t.orderItemList,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("centerCheckBill4cld.save"),itemInputFocusing:t.itemInputFocusing,showAddItemBtn:!t.$fxAuth("centerCheckBill4cld.notAllAddDetail"),inShopId:t.orderInfoData.inShopDTO&&t.orderInfoData.inShopDTO.id,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,editAmountType:t.editAmountType,editIndex:t.editIndex,showPackInfo:"1"===t.centerCheck_enableItemPack},on:{"update:itemInputFocusing":function(e){t.itemInputFocusing=e},"update:item-input-focusing":function(e){t.itemInputFocusing=e},"on-add-click":t.onAddClick,"on-search-click":t.onSearchClick,"on-item-edit":t.onItemEdit,"on-amount-edit":t.onAmountEdit}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showKeyboard,expression:"showKeyboard"}],staticClass:"keyboard-masker",on:{click:t.onKeyboardClose}})],1),i("w-bottom-btn-bar",{directives:[{name:"show",rawName:"v-show",value:!t.showKeyboard,expression:"!showKeyboard"}]},[i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("centerCheckBill4cld.del"),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('centerCheckBill4cld.del')"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onDeleteClick")}}},[t._v("删除")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState("unCheck")&&t.$fxAuth("centerCheckBill4cld.drawback"),expression:"isBillState('unCheck') && $fxAuth('centerCheckBill4cld.drawback')"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onReturnClick")}}},[t._v("退回")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState("checked")&&t.$fxAuth("centerCheckBill4cld.unCheck"),expression:"isBillState('checked') && $fxAuth('centerCheckBill4cld.unCheck')"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onUnExpressClick")}}},[t._v("反审")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState("rechecked")&&t.$fxAuth("centerCheckBill4cld.unReCheck"),expression:"isBillState('rechecked') && $fxAuth('centerCheckBill4cld.unReCheck')"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onUnExpressAgainClick")}}},[t._v("取消复审")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unCheck","unSubmit","returned"])&&t.$fxAuth("centerCheckBill4cld.check"),expression:"isBillState(['unCheck', 'unSubmit', 'returned']) && $fxAuth('centerCheckBill4cld.check')"}],attrs:{size:"large",type:"info"},on:{click:function(e){return t.onClickHandler("onExpressClick")}}},[t._v("审核")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("centerCheckBill4cld.submit"),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('centerCheckBill4cld.submit')"}],attrs:{size:"large",type:"info"},on:{click:function(e){return t.onClickHandler("onSubmitClick")}}},[t._v("提交")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("centerCheckBill4cld.save"),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('centerCheckBill4cld.save')"}],attrs:{size:"large",type:"primary"},on:{click:function(e){return t.onClickHandler("onSaveClick")}}},[t._v("保存")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["checked","cancelRechecked"])&&t.$fxAuth("centerCheckBill4cld.reCheck"),expression:"isBillState(['checked', 'cancelRechecked']) && $fxAuth('centerCheckBill4cld.reCheck')"}],attrs:{size:"large",type:"info"},on:{click:function(e){return t.onClickHandler("onExpressAgainClick")}}},[t._v("复审")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.orderInfoData.checkInBill,expression:"orderInfoData.checkInBill"}],attrs:{size:"large",type:"primary"},on:{click:function(e){return t.onClickHandler("goCenterCheckInBill")}}},[t._v("去盘盈单")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.orderInfoData.checkOutBill,expression:"orderInfoData.checkOutBill"}],attrs:{size:"large",type:"primary"},on:{click:function(e){return t.onClickHandler("goCenterCheckOutBill")}}},[t._v("去盘亏单")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("centerCheckBill4cld.save"),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('centerCheckBill4cld.save')"}],attrs:{size:"large",type:"primary"},on:{click:function(e){return t.onClickHandler("onMoreClick")}}},[t._v("更多")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.rdcPopShow,expression:"rdcPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.rdcPopShow,callback:function(e){t.rdcPopShow=e},expression:"rdcPopShow"}},[i("listComp",{attrs:{visibleFlag:t.rdcPopShow,data:t.rdcList,loadFinished:!0,title:"请选择配送中心"},on:{"update:visibleFlag":function(e){t.rdcPopShow=e},"update:visible-flag":function(e){t.rdcPopShow=e},"on-search":t.searchRdc,"on-select":t.selectRdc}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.housePopShow,expression:"housePopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.housePopShow,callback:function(e){t.housePopShow=e},expression:"housePopShow"}},[i("listComp",{attrs:{visibleFlag:t.housePopShow,data:t.houseList,loadFinished:!0,title:"请选择盘点仓库"},on:{"update:visibleFlag":function(e){t.housePopShow=e},"update:visible-flag":function(e){t.housePopShow=e},"on-search":t.searchHouse,"on-select":t.selectHouse}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.checkTypePopShow,expression:"checkTypePopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.checkTypePopShow,callback:function(e){t.checkTypePopShow=e},expression:"checkTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.checkTypePopShow,data:t.checkTypeList,loadFinished:!0,title:"请选择盘点分类"},on:{"update:visibleFlag":function(e){t.checkTypePopShow=e},"update:visible-flag":function(e){t.checkTypePopShow=e},"on-search":t.searchCheckType,"on-select":t.selectCheckType}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.datePickerShow,expression:"datePickerShow"}],attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.billTypePopShow,expression:"billTypePopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.billTypePopShow,callback:function(e){t.billTypePopShow=e},expression:"billTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.billTypePopShow,data:t.billTypeList,loadFinished:!0,title:"单据类型检索"},on:{"update:visibleFlag":function(e){t.billTypePopShow=e},"update:visible-flag":function(e){t.billTypePopShow=e},"on-search":t.searchBillType,"on-select":t.selectBillType}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemPopShow,expression:"itemPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemPopShow,callback:function(e){t.itemPopShow=e},expression:"itemPopShow"}},[i("itemEditComp",{ref:"itemEditComp",attrs:{visibleFlag:t.itemPopShow,orderInfoData:t.orderInfoData,orderItemList:t.orderItemList,superaddition:t.superaddition,beforeConfirm:t.itemEditBeforeConfirm},on:{"update:visibleFlag":function(e){t.itemPopShow=e},"update:visible-flag":function(e){t.itemPopShow=e}}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemRowEditPopShow,expression:"itemRowEditPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemRowEditPopShow,callback:function(e){t.itemRowEditPopShow=e},expression:"itemRowEditPopShow"}},[i("itemRowEditPop",{attrs:{visibleFlag:t.itemRowEditPopShow,itemData:t.itemEditRowData,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("centerCheckBill4cld.save")},on:{"update:visibleFlag":function(e){t.itemRowEditPopShow=e},"update:visible-flag":function(e){t.itemRowEditPopShow=e}}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemSearchPopShow,expression:"itemSearchPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemSearchPopShow,callback:function(e){t.itemSearchPopShow=e},expression:"itemSearchPopShow"}},[i("itemSearchPop",{attrs:{visibleFlag:t.itemSearchPopShow,data:t.searchItem,inShopId:t.orderInfoData.inShopDTO&&t.orderInfoData.inShopDTO.id,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("centerCheckBill4cld.save"),showScanCode:"",businessDate:t.orderInfoData.businessDate},on:{"update:visibleFlag":function(e){t.itemSearchPopShow=e},"update:visible-flag":function(e){t.itemSearchPopShow=e},"on-search-confirm":t.onSearchConfirm}})],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.notCheckTypeActionShow,expression:"notCheckTypeActionShow"}],ref:"notCheckTypeActionSheet",attrs:{actions:t.notCheckTypeList},model:{value:t.notCheckTypeActionShow,callback:function(e){t.notCheckTypeActionShow=e},expression:"notCheckTypeActionShow"}}),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.groupFlagActionShow,expression:"groupFlagActionShow"}],ref:"groupFlagActionSheet",attrs:{actions:t.groupFlagList},model:{value:t.groupFlagActionShow,callback:function(e){t.groupFlagActionShow=e},expression:"groupFlagActionShow"}}),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.costTypeActionShow,expression:"costTypeActionShow"}],ref:"costTypeActionSheet",attrs:{actions:t.costTypeList},model:{value:t.costTypeActionShow,callback:function(e){t.costTypeActionShow=e},expression:"costTypeActionShow"}}),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.moreActionShow,expression:"moreActionShow"}],ref:"moreActionSheet",attrs:{actions:t.moreList},model:{value:t.moreActionShow,callback:function(e){t.moreActionShow=e},expression:"moreActionShow"}}),i("itemNumberKeyboard",{ref:"itemNumberKeyboard",on:{prev:t.onKeyboardPrev,next:t.onKeyboardNext,close:t.onKeyboardClose,"on-edit-amount-type-change":t.onEditAmountTypeChange},model:{value:t.showKeyboard,callback:function(e){t.showKeyboard=e},expression:"showKeyboard"}})],1)},n=[],a=(i("a481"),i("7f7f"),i("75fc")),o=(i("20d6"),i("59ad")),c=i.n(o),l=i("5176"),r=i.n(l),d=i("795b"),h=i.n(d),u=(i("ac6a"),i("cebc")),m=i("2f62"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-info-block fx-shadow-block"},[i("van-collapse",{attrs:{border:!1},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("van-collapse-item",{attrs:{name:"1",disabled:t.collapseDisabled}},[i("div",{staticClass:"info-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"info-title-name"},[t._v("单据信息")]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("distributionOutBill4cld.sortingState"),expression:"$fxAuth('distributionOutBill4cld.sortingState')"}],staticClass:"stateTag fl-r"},[t._v(t._s(t.$fxStateMiddleware.getStateName("sortingState")(t.data.sortingState)))]),i("span",{staticClass:"stateTag fl-r"},[t._v(t._s(t.$fxStateMiddleware.getStateName("stateCld")(t.data.billStateFlag)))])]),i("van-tabs",{attrs:{animated:""},model:{value:t.tabActive,callback:function(e){t.tabActive=e},expression:"tabActive"}},[i("van-tab",{attrs:{title:"表头1"}},[i("w-cell",{staticClass:"info-item",attrs:{title:"配送中心","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-rdc-click")}}},[t._v(t._s(t.data.rdcDTO&&t.data.rdcDTO.name))]),i("w-cell",{staticClass:"info-item",attrs:{title:"盘点仓库","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-house-click")}}},[t._v(t._s(t.data.houseDTO&&t.data.houseDTO.name))]),i("w-cell",{staticClass:"info-item",attrs:{title:"盘点分类","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-checkType-click")}}},[t._v(t._s(t.data.checkTypeDTO&&t.data.checkTypeDTO.name))]),i("w-cell",{staticClass:"info-item",attrs:{title:"业务日期","is-link":!t.isDisabled},on:{click:t.onBusDateClick}},[t._v(t._s(t.formatterDate(t.data.businessDate)))]),i("w-cell",{staticClass:"info-item",attrs:{title:"业务人员"}},[t._v(t._s(t.data.busUser&&t.data.busUser.name))])],1),i("van-tab",{attrs:{title:"表头2"}},[i("w-cell",{staticClass:"info-item",attrs:{title:"未盘品项","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-notCheckType-click")}}},[t._v(t._s(t.unCheckItemDoTypeName))]),i("w-cell",{staticClass:"info-item",attrs:{title:"盘点方式","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-groupFlag-click")}}},[t._v(t._s(t.groupFlagName))]),i("w-cell",{staticClass:"info-item",attrs:{title:"成本类型","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-costType-click")}}},[t._v(t._s(t.costTypeName))]),i("van-pro-field",{staticClass:"info-item",attrs:{label:"处理意见",placeholder:t.isDisabled?"":"请输入处理意见","input-align":"right",maxlength:"50",disabled:t.isDisabled},model:{value:t.data.billMemo,callback:function(e){t.$set(t.data,"billMemo",e)},expression:"data.billMemo"}}),i("w-cell",{staticClass:"info-item",attrs:{title:"业务类型","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-businessType-click")}}},[t._v(t._s(t.data.businessTypeDTO&&t.data.businessTypeDTO.name))])],1),i("van-tab",{attrs:{title:"更多"}},[i("van-pro-field",{staticClass:"info-item",attrs:{label:"整单备注",placeholder:t.isDisabled?"":"请输入整单备注","input-align":"right",maxlength:"50",disabled:t.isDisabled},model:{value:t.data.billMemo,callback:function(e){t.$set(t.data,"billMemo",e)},expression:"data.billMemo"}}),i("w-cell",{staticClass:"info-item",attrs:{title:"制单人"}},[t._v(t._s(t.data.billEmp))]),i("w-cell",{staticClass:"info-item",attrs:{title:"制单日期"}},[t._v(t._s(t.formatterDate(t.data.billDate)))]),i("w-cell",{staticClass:"info-item",attrs:{title:"审核人"}},[t._v(t._s(t.data.checkEmp))]),i("w-cell",{staticClass:"info-item",attrs:{title:"审核日期"}},[t._v(t._s(t.formatterDate(t.data.checkDate)))])],1)],1)],1)],1)],1)},p=[],k={name:"orderInfo",props:{data:{type:Object,default:function(){return{}}},isDisabled:Boolean,collapseDisabled:Boolean},data:function(){return{activeNames:["1"],tabActive:0}},computed:Object(u["a"])({},Object(m["c"])({sysPointSize:"sysPointSize",numberLength:"numberLength",maxAmount:"maxAmount"}),{formatterDate:function(t){var e=this;return function(t){return"number"===typeof t?e.$fxUtils.setDateTime(new Date(t),"时分"):""}},unCheckItemDoTypeName:function(){return this.$fxTypeMiddleware.getCommonTypeItemById("notCheckType")(this.data.unCheckItemDoType).name},groupFlagName:function(){return this.$fxTypeMiddleware.getCommonTypeItemById("checkWay")(this.data.groupFlag).name},costTypeName:function(){return this.$fxTypeMiddleware.getCommonTypeItemById("costType")(this.data.costType).name}}),methods:{onEmitClick:function(t){if(this.isDisabled)return!1;this.$emit(t)},closeCollapse:function(){this.activeNames=[]},onBusDateClick:function(){this.onEmitClick("on-busdate-click")}}},v=k,b=(i("6f71"),i("2877")),C=Object(b["a"])(v,f,p,!1,null,"0256732e",null),g=C.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-item-block fx-shadow-block"},[i("div",{staticClass:"item-title"},[i("span",{staticClass:"title-name"},[t._v("单据明细")]),i("span",{staticClass:"title-count"},[t._v("明细：")]),i("span",[t._v(t._s(t.detailsLength))]),i("i",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled&&t.showAddItemBtn,expression:"!isDisabled && showAddItemBtn"}],staticClass:"title-add-icon fl-r",on:{click:function(e){return t.onEmitClick("on-add-click")}}}),i("i",{staticClass:"title-search-icon fl-r",on:{click:t.onSearchClick}})]),i("div",{ref:"details-content",staticClass:"item-list"},[t._l(t.visiableData,function(e,s){return[i("van-swipe-cell",{key:e.uuid,class:"item-row item-row-"+s,attrs:{"right-width":80,disabled:t.isDisabled||!t.$fxAuth("centerCheckBill4cld.delDetail")}},[i("itemInfoCell",t._g(t._b({ref:"itemInfoCell",refInFor:!0,attrs:{itemData:e,isDisabled:t.isDisabled,itemIndex:s,isEdit:s===t.editIndex}},"itemInfoCell",t.$attrs,!1),t.$listeners)),i("div",{staticClass:"item-row-delete",attrs:{slot:"right"},on:{click:function(i){return t.onDeleteClick(e,s)}},slot:"right"},[t._v("删除")])],1)]})],2)])},D=[],w=(i("c5f6"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-info-cell",class:{"is-edit":t.isEdit}},[i("div",{staticClass:"item-details-main"},[i("div",{staticClass:"item-img"},[i("w-img",{attrs:{src:t.itemData.goodsDTO.imageUrls}})],1),i("div",{staticClass:"item-details"},[i("div",{staticClass:"item-details-cell"},[i("div",{staticClass:"item-name fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.name))]),i("w-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled&&!t.disabledEditBtn,expression:"!isDisabled && !disabledEditBtn"}],staticClass:"block-item-edit",attrs:{type:"item-edit"},on:{click:t.onItemEditClick}}),i("w-icon",{directives:[{name:"show",rawName:"v-show",value:t.isDisabled&&t.showEditBtn,expression:"isDisabled && showEditBtn"}],staticClass:"block-item-edit",attrs:{type:"item-info"},on:{click:t.onItemEditClick}})],1),i("div",{staticClass:"item-details-cell"},[i("span",[t._v("规格：")]),i("div",{staticClass:"fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.spec))])]),i("div",{staticClass:"item-details-cell"},[t.showPackInfo?i("span",[t._v("包装信息：")]):t._e(),t.showPackInfo?i("div",{staticClass:"fx-ellipsis"},[t._v(t._s(t.itemData.itemPack&&t.itemData.itemPack.name))]):t._e()])])]),i("div",{staticClass:"item-details-other"},[i("div",{staticClass:"item-details-cell",on:{click:function(e){return t.onAmountClick("busFactAmount1")}}},[i("div",{staticClass:"item-details-cell__label"},[t._v("账存：")]),i("div",{staticClass:"item-details-cell__content"},[i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.busBillAmount1))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.busUnit1))])]),t.hasBusUnit2?i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.busBillAmount2))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.busUnit2))])]):t._e()])]),i("div",{staticClass:"item-details-cell",on:{click:function(e){return t.onAmountClick("busFactAmount1")}}},[i("div",{staticClass:"item-details-cell__label"},[t._v("差异：")]),i("div",{staticClass:"item-details-cell__content"},[i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.busDiffAmount))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.busUnit1))])]),t.hasBusUnit2?i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.busDiffAmount2))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.busUnit2))])]):t._e()])]),i("div",{staticClass:"item-details-cell",class:{"is-active":"busFactAmount1"===t.editAmountType&&t.isEdit},on:{click:function(e){return t.onAmountClick("busFactAmount1")}}},[i("div",{staticClass:"item-details-cell__label"},[t._v("实盘数量：")]),i("div",{staticClass:"item-details-cell__content"},[i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.busFactAmount1))]),i("span",{staticClass:"item-details-unit fx-ellipsis"},[t._v(t._s(t.itemData.busUnit1))])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasBusUnit2,expression:"hasBusUnit2"}],staticClass:"item-details-cell",class:{"is-active":"busFactAmount2"===t.editAmountType&&t.isEdit},on:{click:function(e){return t.onAmountClick("busFactAmount2")}}},[i("div",{staticClass:"item-details-cell__label"}),i("div",{staticClass:"item-details-cell__content"},[i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.busFactAmount2))]),i("span",{staticClass:"item-details-unit fx-ellipsis"},[t._v(t._s(t.itemData.busUnit2))])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.itemData.assistUnit,expression:"itemData.assistUnit"}],staticClass:"item-details-cell"},[i("div",{staticClass:"item-details-cell__content"},[i("span",{staticClass:"item-details-cell__label"},[t._v("辅助账存：")]),i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.assistBillAmount))]),i("span",{staticClass:"item-details-unit fx-ellipsis"},[t._v(t._s(t.itemData.assistUnit))])])]),i("div",{staticClass:"item-details-cell__content"},[i("span",{staticClass:"item-details-cell__label"},[t._v("差异：")]),i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.assistDiffAmount))]),i("span",{staticClass:"item-details-unit fx-ellipsis"},[t._v(t._s(t.itemData.assistUnit))])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.itemData.assistUnit,expression:"itemData.assistUnit"}],staticClass:"item-details-cell",class:{"is-active":"assistFactAmount"===t.editAmountType&&t.isEdit},on:{click:function(e){return t.onAmountClick("assistFactAmount")}}},[i("div",{staticClass:"item-details-cell__label"},[t._v("辅助实盘：")]),i("div",{staticClass:"item-details-cell__content"},[i("div",{staticClass:"item-details-cell__content-item"},[i("span",[t._v(t._s(t.itemData.assistFactAmount))]),i("span",{staticClass:"item-details-unit fx-ellipsis"},[t._v(t._s(t.itemData.assistUnit))])])])])])])}),S=[],T={name:"itemInfoCell",props:{itemData:{type:Object,default:function(){return{}}},isDisabled:Boolean,disabledEditBtn:Boolean,showEditBtn:{type:Boolean,default:function(){return!0}},itemIndex:Number,isEdit:Boolean,editAmountType:String,showPackInfo:Boolean},computed:{hasBusUnit2:function(){return this.itemData.busUnit1!==this.itemData.busUnit2&&!!this.itemData.busUnit1}},methods:{onItemEditClick:function(){this.editItem(),this.$emit("on-item-edit",this.itemData)},editItem:function(){this.itemData.id&&(this.itemData.changeType="edit")},onAmountClick:function(t){if(this.isDisabled)return!1;this.$emit("on-amount-edit",t,this.itemData,this.itemIndex)}}},x=T,A=(i("9fc4"),Object(b["a"])(x,w,S,!1,null,"5eb20743",null)),I=A.exports,P={name:"orderItem",components:{itemInfoCell:I},props:{data:{type:Array,default:function(){return[]}},isDisabled:Boolean,showAddItemBtn:Boolean,editIndex:Number},inheritAttrs:!1,computed:{visiableData:function(){return this.data.filter(function(t){return"del"!==t.changeType})},detailsLength:function(){return this.visiableData.length}},methods:{onEmitClick:function(t){if(this.isDisabled)return!1;this.$emit(t)},onSearchClick:function(){this.$emit("on-search-click")},onDeleteClick:function(t){if(t.id)this.$set(t,"changeType","del");else{var e=this.data.findIndex(function(e){return e.goodsDTO.id===t.goodsDTO.id});~e&&this.data.splice(e,1)}},prev:function(t){if(0===t)return!1;var e=t-1,i=document.querySelector(".item-row-".concat(e));this.$fxUtils.doScrollTop(i);var s=this.visiableData[e];this.$emit("on-amount-edit","busFactAmount1",s,e)},next:function(t){if(t===this.visiableData.length-1)return!1;var e=t+1,i=document.querySelector(".item-row-".concat(e));this.$fxUtils.doScrollTop(i);var s=this.visiableData[e];this.$emit("on-amount-edit","busFactAmount1",s,e)},scrollTop:function(t){var e=this.$refs["details-content"].querySelector(".item-row-".concat(t));this.$fxUtils.doScrollTop(e)}}},_=P,L=(i("e27e"),Object(b["a"])(_,y,D,!1,null,"781274c6",null)),B=L.exports,F=i("f6bb"),$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fx-item-row-edit",{attrs:{title:t.itemData.goodsDTO.name},on:{"on-back":t.onConfirmClick}},[i("van-cell-group",[i("w-cell",{attrs:{title:"品项编号"}},[t._v(t._s(t.itemData.goodsDTO.code))]),i("w-cell",{attrs:{title:"净重量"}},[t._v(t._s(t.itemData.netWeight))]),i("w-cell",{attrs:{title:"毛重量"}},[t._v(t._s(t.itemData.grossWeight))]),i("w-cell",{attrs:{title:"皮重量"}},[t._v(t._s(t.itemData.skinWeight))]),i("w-cell",{attrs:{title:"称重单位"}},[t._v(t._s(t.itemData.weightUnit))]),i("w-cell",{attrs:{title:"图片","is-link":!!t.itemData.weightPic},on:{click:t.onWeigthPicClick}},[t._v("查看")]),i("w-cell",{attrs:{title:"账存金额"}},[t._v(t._s(t.itemData.billMoney))]),i("w-cell",{attrs:{title:"含税账存金额"}},[t._v(t._s(t.itemData.billTaxMoney))]),i("w-cell",{attrs:{title:"实盘金额"}},[t._v(t._s(t.itemData.factMoney))]),i("w-cell",{attrs:{title:"含税实盘金额"}},[t._v(t._s(t.itemData.factTaxMoney))]),i("w-cell",{attrs:{title:"盈亏金额"}},[t._v(t._s(t.itemData.diffMoney))]),i("w-cell",{attrs:{title:"含税盘亏金额"}},[t._v(t._s(t.itemData.diffTaxMoney))]),i("w-cell",{attrs:{title:"辅助单位差异数"}},[t._v(t._s(t.itemData.assistDiffAmoun))]),i("w-cell",{attrs:{title:"库位号"}},[t._v(t._s(t.itemData.storeHouseName))]),i("w-cell",{attrs:{title:"批次号"}},[t._v(t._s(t.itemData.batchCode))]),i("van-pro-field",{ref:"memo",attrs:{placeholder:t.setPlaceholder("请输入备注"),disabled:t.isDisabled,label:"备注","input-align":"right"},on:{focus:function(e){return t.onFocus("memo")}},model:{value:t.itemData.memo,callback:function(e){t.$set(t.itemData,"memo",e)},expression:"itemData.memo"}})],1),t.isDisabled?t._e():i("w-button",{attrs:{slot:"bottom-btn",size:"large",type:"primary"},on:{click:t.onConfirmClick},slot:"bottom-btn"},[t._v("保存\n\t")])],1)},O=[],E={name:"itemRowEdit",props:{visibleFlag:Boolean,itemData:{type:Object,default:function(){return{}}},isDisabled:Boolean},computed:{setPlaceholder:function(t){var e=this;return function(t){return e.isDisabled?"":t}}},methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onConfirmClick:function(){this.itemData.id&&(this.itemData.changeType="edit"),this.$emit("on-Confirm",this.itemData),this.$emit("update:visibleFlag",!1)},onFocus:function(t){this.$fxUtils.doScrollTop(this.$refs[t].$el)},onWeigthPicClick:function(){this.itemData.weightPic&&this.$fxImagePreview([this.itemData.weightPic])}}},N=E,R=Object(b["a"])(N,$,O,!1,null,null,null),M=R.exports,U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",{staticClass:"item-search-block"},[i("w-app-container",[i("w-header",{attrs:{title:"搜索品项",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("fx-search-bar",{attrs:{isSelectAll:t.isSelectAll,showSelectAllBtn:!t.isDisabled},on:{"on-select-click":t.onSelectAllClick},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),i("div",{ref:"details-content",staticClass:"item-list"},[t._l(t.detailsComputed,function(e,s){return[i("van-swipe-cell",{directives:[{name:"show",rawName:"v-show",value:"del"!==e.changeType,expression:"item.changeType !== 'del'"}],key:e.goodsDTO.id+"-"+s,ref:"details-row",refInFor:!0,class:"item-row item-row-"+s,attrs:{"right-width":80,disabled:t.isDisabled||!t.$fxAuth("centerCheckBill4cld.delDetail")}},[i("div",{staticClass:"item-cell"},[i("checkBox",{staticClass:"search-checkbox",attrs:{visibleFlag:!t.isDisabled,checked:e.checked},on:{"on-checkbox-click":function(i){return t.onCheckBoxClick(e)}}}),i("itemInfoCell",{staticClass:"search-info",attrs:{itemData:e,itemIndex:s,editAmountType:t.editAmountType,isEdit:s===t.editIndex,isDisabled:t.isDisabled,showPackInfo:"1"===t.centerCheck_enableItemPack},on:{"on-item-edit":t.onSearchItemEdit,"on-amount-edit":t.onAmountEdit}})],1),i("div",{staticClass:"item-row-delete",attrs:{slot:"right"},on:{click:function(i){return t.onDeleteClick(e,s,t.storeItem.details)}},slot:"right"},[t._v("删除")])])]})],2),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showKeyboard,expression:"showKeyboard"}],staticClass:"keyboard-masker",on:{click:t.onKeyboardClose}})],1),i("w-bottom-btn-bar",{directives:[{name:"show",rawName:"v-show",value:!t.showKeyboard,expression:"!showKeyboard"}]},[i("w-button",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],attrs:{size:"large",type:"primary"},on:{click:t.onSearchConfirm}},[t._v("保存")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],attrs:{size:"large",type:"danger"},on:{click:t.onSelectConfirm}},[t._v("删除")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemRowEditPopShow,expression:"itemRowEditPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemRowEditPopShow,callback:function(e){t.itemRowEditPopShow=e},expression:"itemRowEditPopShow"}},[i("itemRowEditPop",{attrs:{visibleFlag:t.itemRowEditPopShow,itemData:t.itemEditRowData,isDisabled:t.isDisabled},on:{"update:visibleFlag":function(e){t.itemRowEditPopShow=e},"update:visible-flag":function(e){t.itemRowEditPopShow=e}}})],1),i("itemNumberKeyboard",{ref:"itemNumberKeyboard",on:{prev:t.prev,next:t.next,close:t.onKeyboardClose,"on-edit-amount-type-change":t.onEditAmountTypeChange},model:{value:t.showKeyboard,callback:function(e){t.showKeyboard=e},expression:"showKeyboard"}})],1)},H=[],j=(i("7514"),i("0f38")),K=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],ref:"",staticClass:"item-number-keyboard fx-shadow-up"},[i("div",{staticClass:"number-keyboard-title",on:{click:function(e){return t.onAmountClick("busFactAmount1")}}},[i("div",{staticClass:"title-name fx-ellipsis"},[t._v(t._s(t.title))]),i("div",{staticClass:"title-amount",class:{"is-active":"busFactAmount1"===t.active}},["busFactAmount1"===t.active?i("i",{staticClass:"active-icon"}):t._e(),t._v(t._s(t.itemDetails.busFactAmount1)+"\n\t\t")]),i("div",{staticClass:"title-unit"},[t._v(t._s(t.itemDetails.busUnit1))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasBusUnit2,expression:"hasBusUnit2"}],staticClass:"number-keyboard-title",on:{click:function(e){return t.onAmountClick("busFactAmount2")}}},[i("div",{staticClass:"title-name fx-ellipsis"}),i("div",{staticClass:"title-amount",class:{"is-active":"busFactAmount2"===t.active}},["busFactAmount2"===t.active?i("i",{staticClass:"active-icon"}):t._e(),t._v(t._s(t.itemDetails.busFactAmount2)+"\n\t\t")]),i("div",{staticClass:"title-unit"},[t._v(t._s(t.itemDetails.busUnit2))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.itemDetails.assistUnit,expression:"itemDetails.assistUnit"}],staticClass:"number-keyboard-title",on:{click:function(e){return t.onAmountClick("assistFactAmount")}}},[i("div",{staticClass:"title-name fx-ellipsis"}),i("div",{staticClass:"title-amount",class:{"is-active":"assistFactAmount"===t.active}},["assistFactAmount"===t.active?i("i",{staticClass:"active-icon"}):t._e(),t._v(t._s(t.itemDetails.assistFactAmount)+"\n\t\t")]),i("div",{staticClass:"title-unit"},[t._v(t._s(t.itemDetails.assistUnit))])]),i("w-number-keyboard",{attrs:{value:t.amount,pointSize:t.sysPointSize,intLength:t.numberLength},on:{change:t.onAmountChange,prev:t.onPrevClick,next:t.onNextClick,close:t.close}}),i("div",{staticClass:"number-keyboard-masker"})],1)},z=[],G={name:"itemNumberKeyboard",props:{value:Boolean,busFactAmount1ChangeMethods:Function,busFactAmount2ChangeMethods:Function,assistFactAmountChangeMethods:Function},data:function(){return{active:"",itemDetails:{},itemIndex:-1,fxCalculation:this.$fxCalculation("centerCheckBill4cld")}},computed:Object(u["a"])({},Object(m["c"])({sysPointSize:"sysPointSize",numberLength:"numberLength"}),{title:function(){return this.itemDetails.goodsDTO&&this.itemDetails.goodsDTO.name},hasBusUnit2:function(){return this.itemDetails.busUnit1!==this.itemDetails.busUnit2&&!!this.itemDetails.busUnit1},amount:function(){return"busFactAmount1"===this.active?this.itemDetails.busFactAmount1:"busFactAmount2"===this.active?this.itemDetails.busFactAmount2:this.itemDetails.assistFactAmount}}),methods:{open:function(t,e,i){this.active=t,this.itemDetails=e,this.itemIndex=i,this.$emit("input",!0)},close:function(){this.$emit("input",!1),this.$emit("close",!1)},editItem:function(){this.itemDetails.id&&(this.itemDetails.changeType="edit")},onAmountChange:function(t){"busFactAmount1"===this.active?(this.itemDetails.busFactAmount1=t,this.onBusFactAmount1Change(t,this.itemDetails)):"busFactAmount2"===this.active?(this.itemDetails.busFactAmount2=t,this.onBusFactAmount2Change(t,this.itemDetails)):(this.itemDetails.assistFactAmount=t,this.onAssistFactAmountChange(t,this.itemDetails))},onPrevClick:function(){this.$emit("prev",this.itemIndex)},onNextClick:function(){this.$emit("next",this.itemIndex)},onBusFactAmount1Change:function(t,e){if("function"===typeof this.busFactAmount1ChangeMethods)return this.busFactAmount1ChangeMethods(e),!1;this.fxCalculation.computeDiffAmount(e),this.editItem()},onBusFactAmount2Change:function(t,e){if("function"===typeof this.busFactAmount2ChangeMethods)return this.busFactAmount2ChangeMethods(e),!1;this.fxCalculation.computeDiffAmount2(e),this.editItem()},onAssistFactAmountChange:function(t,e){if("function"===typeof this.assistFactAmountChangeMethods)return this.assistFactAmountChangeMethods(e),!1;this.fxCalculation.computeDiffAssistAmount(e),this.editItem()},onAmountClick:function(t){this.active=t,this.$emit("on-edit-amount-type-change",t)}}},W=G,Y=(i("2a4a"),Object(b["a"])(W,K,z,!1,null,"3eb68c89",null)),Z=Y.exports,V=["code","name","pinYin"],Q={name:"itemSearchPop",components:{itemInfoCell:I,itemRowEditPop:M,checkBox:j["a"],itemNumberKeyboard:Z},props:{data:{type:Array,default:function(){return[]}},isDisabled:Boolean,visibleFlag:Boolean,inShopId:{type:String,default:""},rdcId:{type:String,default:""},businessDate:{type:[String,Number],default:""},showScanCode:Boolean},data:function(){return{query:this.$route.query,leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",searchKeywords:V,itemRowEditPopShow:!1,itemEditRowData:{},showKeyboard:!1,editIndex:-1,editAmountType:""}},watch:{visibleFlag:{handler:function(t){t?this.searchKey="":this.$dialog.close()},immediate:!0}},computed:Object(u["a"])({},Object(m["c"])({sysPointSize:"sysPointSize",centerCheck_enableItemPack:function(t){return t.systemParamsCld.centerCheck_enableItemPack}}),{isSelectAll:function(){return this.data.every(function(t){return"del"!==t.changeType&&!!t.checked})},detailsComputed:function(){var t=this;return this.data.filter(function(e){return"del"!==e.changeType&&!!t.searchKeywords.find(function(i){return t.$fxUtils.fuzzyQueryString(e.goodsDTO[i],t.searchKey)})})}}),methods:{detailFilter:function(t){var e=this;return t.filter(function(t){return"del"!==t.changeType&&!!e.searchKeywords.find(function(i){return e.$fxUtils.fuzzyQueryString(t.goodsDTO[i],e.searchKey)})})},onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onDeleteClick:function(t,e,i){t.id?this.$set(t,"changeType","del"):i.splice(e,1)},onSearchItemEdit:function(t){this.itemEditRowData=t,this.itemRowEditPopShow=!0},onSearchConfirm:function(){this.data.forEach(function(t){delete t.checked}),this.$emit("on-search-confirm",this.data),this.$emit("update:visibleFlag",!1)},onCheckBoxClick:function(t){this.$set(t,"checked",!t.checked)},onSelectAllClick:function(){var t=this,e=!this.isSelectAll;this.data.forEach(function(i){"del"!==i.changeType&&t.$set(i,"checked",e)})},onSelectConfirm:function(){var t=this,e=this.data.some(function(t){return t.checked&&"del"!==t.changeType});if(!e)return this.$fxToast.top("请先选择品项!"),!1;this.$dialog.confirm({title:"提示",message:"是否删除？"}).then(function(){for(var e=t.data.length-1;e>=0;e--){var i=t.data[e];i.checked&&(i.id?t.$set(i,"changeType","del"):i.splice(e,1))}})},onAmountEdit:function(t,e,i){this.editAmountType=t,this.editIndex=i,this.$refs.itemNumberKeyboard.open(t,e,i),this.scrollTop(i)},prev:function(t){if(0===t)return!1;var e=t-1;this.editIndex=e;var i=this.detailsComputed[e];this.$refs.itemNumberKeyboard.open("busFactAmount1",i,e),this.scrollTop(e)},next:function(t){if(t===this.detailsComputed.length-1)return!1;var e=t+1;this.editIndex=e;var i=this.detailsComputed[e];this.$refs.itemNumberKeyboard.open("busFactAmount1",i,e),this.scrollTop(e)},scrollTop:function(t){var e=this.$refs["details-content"].querySelector(".item-row-".concat(t));this.$fxUtils.doScrollTop(e)},onKeyboardClose:function(){this.editAmountType="",this.editIndex=-1,this.showKeyboard=!1},onEditAmountTypeChange:function(t){this.editAmountType=t}}},J=Q,X=(i("4a6f"),Object(b["a"])(J,U,H,!1,null,"5c63a66c",null)),q=X.exports,tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",{staticClass:"item-edit"},[i("w-app-container",[i("w-header",{attrs:{title:(t.superaddition?"追加":"选择")+"品项",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}},[i("van-icon",{staticClass:"header-confirm-btn",attrs:{slot:"header-right",name:"success"},on:{click:t.onItemConfirm},slot:"header-right"})],1),i("div",{staticClass:"item-search clearfix"},[i("van-search",{attrs:{placeholder:"请输入搜索关键词",shape:"round"},on:{search:t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1),i("div",{staticClass:"item-edit-content"},[i("addItemClassList",{attrs:{itemClassList:t.itemClassList},on:{"on-change-class":t.changeClass},model:{value:t.currentClass,callback:function(e){t.currentClass=e},expression:"currentClass"}}),i("addItemList",{ref:"addItemList",staticClass:"add-item-list",attrs:{listLoading:t.listLoading,loadFinished:t.loadFinished,itemList:t.itemList},on:{"update:listLoading":function(e){t.listLoading=e},"update:list-loading":function(e){t.listLoading=e},"on-load-more":t.onLoadMore},scopedSlots:t._u([{key:"item-cell",fn:function(e){return[i("addItemCell",{attrs:{itemData:e.$item,itemIndex:e.$index,isEdit:e.$index===t.editIndex,isLoaded:e.$item.isLoaded,editAmountType:t.editAmountType},on:{"on-item-select-change":t.onItemSelectChange,"on-amount-edit":t.onAmountEdit}})]}}])})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showKeyboard,expression:"showKeyboard"}],staticClass:"keyboard-masker",on:{click:t.onKeyboardClose}})],1),i("itemNumberKeyboard",{ref:"itemNumberKeyboard",attrs:{busFactAmount1ChangeMethods:t.busFactAmount1ChangeMethods,busFactAmount2ChangeMethods:t.busFactAmount2ChangeMethods,assistFactAmountChangeMethods:t.assistFactAmountChangeMethods},on:{prev:t.onKeyboardPrev,next:t.onKeyboardNext,close:t.onKeyboardClose,"on-edit-amount-type-change":t.onEditAmountTypeChange},model:{value:t.showKeyboard,callback:function(e){t.showKeyboard=e},expression:"showKeyboard"}})],1)},et=[],it=i("768b"),st=i("d444"),nt=i("01f7"),at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-detail-cell",on:{click:t.onItemClick}},[i("div",{staticClass:"item-detail-cell_container"},[i("div",{staticClass:"item-detail-cell_container-main",on:{click:function(e){return t.onAmountClick("busFactAmount1")}}},[i("div",{staticClass:"item-details-img"},[i("w-img",{attrs:{src:t.itemData.goodsDTO.imageUrls}})],1),i("div",{staticClass:"item-details-params"},[i("div",{staticClass:"item-details-name fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.name))]),i("div",{staticClass:"item-details-spec fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.spec))])])]),t.isLoaded?i("div",{staticClass:"item-detail-cell_container-sub",class:{"is-active":"busFactAmount1"===t.editAmountType&&t.isEdit},on:{click:function(e){return t.onAmountClick("busFactAmount1")}}},[i("span",{staticClass:"item-details-sub-label"},[t._v("实盘数量")]),i("div",{staticClass:"item-details-sub-content"},[i("span",{staticClass:"item-details-count"},[t._v(t._s(t.itemData.busFactAmount1))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.busUnit1))])])]):t._e(),t.hasBusUnit2&&t.isLoaded?i("div",{staticClass:"item-detail-cell_container-sub",class:{"is-active":"busFactAmount2"===t.editAmountType&&t.isEdit},on:{click:function(e){return t.onAmountClick("busFactAmount2")}}},[i("span",{staticClass:"item-details-sub-label"}),i("div",{staticClass:"item-details-sub-content"},[i("span",{staticClass:"item-details-count"},[t._v(t._s(t.itemData.busFactAmount2))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.busUnit2))])])]):t._e(),t.itemData.assistUnit&&t.isLoaded?i("div",{staticClass:"item-detail-cell_container-sub",class:{"is-active":"assistFactAmount"===t.editAmountType&&t.isEdit},on:{click:function(e){return t.onAmountClick("assistFactAmount")}}},[i("span",{staticClass:"item-details-sub-label"},[t._v("辅助实盘：")]),i("div",{staticClass:"item-details-sub-content"},[i("span",{staticClass:"item-details-count"},[t._v(t._s(t.itemData.assistFactAmount))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.assistUnit))])])]):t._e()]),i("van-checkbox",{staticClass:"item-checkbox",on:{change:t.onCheckBoxChange},model:{value:t.itemData.checked,callback:function(e){t.$set(t.itemData,"checked",e)},expression:"itemData.checked"}})],1)},ot=[],ct={name:"bomAddItemCell",props:{itemData:{type:Object,default:function(){return{}}},itemIndex:Number,editAmountType:String,isEdit:Boolean,isLoaded:Boolean},computed:{comptedItemImgSrc:function(t){return function(t){return t?0===t.length?"":t[0]:""}},hasBusUnit2:function(){return this.itemData.busUnit1!==this.itemData.busUnit2&&!!this.itemData.busUnit1}},methods:{onItemClick:function(){this.$emit("on-item-click",this.itemIndex)},onCheckBoxChange:function(){this.$emit("on-item-select-change",this.itemData)},onAmountClick:function(t){this.$emit("on-amount-edit",t,this.itemData,this.itemIndex)}}},lt=ct,rt=(i("e7ae"),Object(b["a"])(lt,at,ot,!1,null,"1c88a543",null)),dt=rt.exports,ht=10,ut={name:"itemEditComp",components:{addItemClassList:st["a"],addItemList:nt["a"],addItemCell:dt,itemNumberKeyboard:Z},props:{visibleFlag:Boolean,orderInfoData:{type:Object,default:function(){return{}}},orderItemList:{type:Array,default:function(){return[]}},superaddition:Boolean,beforeConfirm:Function},data:function(){return{query:this.$route.query,leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",currentClass:"",itemClassList:[],itemList:[],selectedItemArr:[],itemListStart:0,listLoading:!1,loadFinished:!0,showKeyboard:!1,editAmountType:"",editIndex:-1,fxCalculation:this.$fxCalculation("centerCheckBill4cld"),fxVerification:this.$fxUtils.fxDataVerification()}},computed:Object(u["a"])({},Object(m["c"])({sysPointSize:"sysPointSize"})),watch:{visibleFlag:{handler:function(t){t&&(this.selectedItemArr=this.$fxUtils.deepClone(this.orderItemList),this.fxVerification.resetData(this.selectedItemArr),this.refresh())},immediate:!0}},methods:{refresh:function(){var t=this;this.searchKey="",this.getItemClass().then(function(e){t.itemClassList=e.goodsTypes,t.currentClass="",t.getItemByClass()})},onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onItemConfirm:function(){var t=this;this.$nextTick(function(){t.fxVerification.checkData(t.selectedItemArr)?t.$emit("update:visibleFlag",!1):"function"===typeof t.beforeConfirm?t.beforeConfirm(t.selectedItemArr).then(function(){t.$emit("on-confirm",t.selectedItemArr),t.$emit("update:visibleFlag",!1)}):(t.$emit("on-confirm",t.selectedItemArr),t.$emit("update:visibleFlag",!1))})},search:function(){this.getItemByClass()},getItemClass:function(){if(this.superaddition){var t={houseId:this.orderInfoData.houseDTO.id,billId:this.orderInfoData.id,checkWay:this.orderInfoData.groupFlag};return this.$fxApi("centerCheckBill4cld.getSuperadditionItemClass")({data:t})}var e={checkType:this.orderInfoData.checkTypeDTO.id,houseId:this.orderInfoData.houseDTO.id,rdcId:this.orderInfoData.rdcDTO.id,billId:this.orderInfoData.id};return this.$fxApi("centerCheckBill4cld.getItemClass")({data:e})},getItem:function(){var t={start:this.itemListStart,size:ht,paged:!0,goodsTypeId:this.currentClass||null,checkType:this.orderInfoData.checkTypeDTO.id,checkWay:this.orderInfoData.groupFlag,houseId:this.orderInfoData.houseDTO.id,rdcId:this.orderInfoData.rdcDTO.id,billId:this.orderInfoData.id,searchText:this.searchKey||""};return this.superaddition?this.$fxApi("centerCheckBill4cld.getSuperadditionItemByClass")({data:t}):this.$fxApi("centerCheckBill4cld.getItemByClass")({data:t})},getItemByClass:function(){var t=this;this.itemListStart=0,this.getItem().then(function(e){t.itemList=t.setResItem(e),t.setListLoading(e.length),t.$nextTick(function(){t.$refs.addItemList&&t.$refs.addItemList.onSelectLetter(0,200)})})},onLoadMore:function(){var t=this;this.getItem().then(function(e){var i;(i=t.itemList).push.apply(i,Object(a["a"])(t.setResItem(e))),t.setListLoading(e.length)})},setResItem:function(t){var e=this;return t.forEach(function(i,s){var n=e.selectedItemArr.findIndex(function(t){return i.goodsDTO.id===t.goodsDTO.id&&"del"!==t.changeType});if(i.assistUnit&&(i.assistFactAmount=0),i.checked=!!~n,~n){var a=e.selectedItemArr[n];a.isLoaded=!0,t.splice(s,1,a)}else i.isLoaded=!1}),t},setListLoading:function(t){this.listLoading=!1,this.itemListStart+=ht,this.loadFinished=t<ht},changeClass:function(t){var e=Object(it["a"])(t,2);e[0],e[1];this.searchKey="",this.getItemByClass()},onItemSelectChange:function(t){var e=this;t.checked?~this.getSelectItemIndex(t)||this.getItemDetailData({data:t}).then(function(t){var i=t.data;e.selectedItemArr.push(i)}):this.selectedItemArr.splice(this.getSelectItemIndex(t),1)},getSelectItemIndex:function(t){return this.selectedItemArr.findIndex(function(e){return e.id===t.goodsDTO.id})},scrollToActive:function(t){var e=this;this.$nextTick(function(){e.$refs.addItemList.onSelectLetter(t,20)})},onAmountEdit:function(t,e,i){var s=this;this.getItemDetailData({data:e,index:i}).then(function(e){var n=e.data;e.index;s.editAmountType=t,s.editIndex=i,s.syncAccountDepositAmount(n),s.$refs.itemNumberKeyboard.open(t,n,i),s.$refs.addItemList.onSelectLetter(i)})},syncAccountDepositAmount:function(t){t.busBillAmount1>0&&"0"==="".concat(t.busFactAmount1)&&(t.busFactAmount1=t.busBillAmount1,this.busFactAmount1ChangeMethods(t)),t.busBillAmount2>0&&"0"==="".concat(t.busFactAmount2)&&(t.busFactAmount2=t.busBillAmount2,this.busFactAmount2ChangeMethods(t)),t.assistBillAmount>0&&"0"==="".concat(t.assistFactAmount)&&(t.assistFactAmount=t.assistBillAmount)},getItemDetailData:function(t){var e=this,i=t.data,s=t.index;return new h.a(function(t){if(i.isLoaded)t({data:i,index:s});else{var n={billId:e.orderInfoData.id,houseId:e.orderInfoData.houseDTO.id,itemId:i.goodsDTO.id};e.$fxApi("centerCheckBill4cld.getItemDetaiData")({data:n}).then(function(e){var n=Object(it["a"])(e,1),a=n[0];i.isLoaded=!0,i=r()(i,a),t({data:i,index:s})})}})},onKeyboardPrev:function(t){var e=this,i="busFactAmount1";this.$refs.addItemList.prev(t).then(this.getItemDetailData).then(function(t){var s=t.data,n=t.index;e.editAmountType=i,e.editIndex=n,e.$refs.itemNumberKeyboard.open(i,s,n)})},onKeyboardNext:function(t){var e=this,i="busFactAmount1";this.$refs.addItemList.next(t).then(this.getItemDetailData).then(function(t){var s=t.data,n=t.index;e.editAmountType=i,e.editIndex=n,e.$refs.itemNumberKeyboard.open(i,s,n)})},onKeyboardClose:function(){this.editAmountType="",this.editIndex=-1,this.showKeyboard=!1},onEditAmountTypeChange:function(t){this.editAmountType=t},busFactAmount1ChangeMethods:function(t){this.fxCalculation.computeDiffAmount(t),t.checked=!0},busFactAmount2ChangeMethods:function(t){this.fxCalculation.computeDiffAmount2(t),t.checked=!0},assistFactAmountChangeMethods:function(t){this.fxCalculation.computeDiffAssistAmount(t),t.checked=!0}}},mt=ut,ft=(i("8af0"),Object(b["a"])(mt,tt,et,!1,null,"0ee8eef7",null)),pt=ft.exports,kt=[{id:0,name:"实盘为0",handler:"doCheckZero"},{id:1,name:"实盘取账存",handler:"doCheckAccount"},{id:2,name:"导入必盘品项",handler:"doImportMust"},{id:3,name:"导入盘点品项",handler:"doImportCheck"},{id:4,name:"追加",handler:"doSuperaddition"}],vt={name:"centerCheckBill4cldDetails",components:{orderInfo:g,orderItem:B,listComp:F["a"],itemRowEditPop:M,itemSearchPop:q,itemEditComp:pt,itemNumberKeyboard:Z},data:function(){return{query:this.$route.query,orderInfoData:{},orderItemList:[],currentDate:new Date,rdcPopShow:!1,rdcList:[],housePopShow:!1,houseList:[],checkTypePopShow:!1,checkTypeList:[],datePickerShow:!1,notCheckTypeActionShow:!1,notCheckTypeList:this.$fxTypeMiddleware.getCommonTypeList("notCheckType"),groupFlagActionShow:!1,groupFlagList:this.$fxTypeMiddleware.getCommonTypeList("checkWay"),costTypeActionShow:!1,costTypeList:this.$fxTypeMiddleware.getCommonTypeList("costType"),billTypePopShow:!1,billTypeList:[],itemSearchPopShow:!1,itemRowEditPopShow:!1,itemEditRowData:{},searchItem:[],itemPopShow:!1,itemInputFocusing:!1,checkActionSheetShow:!1,checkActions:[],fxOrderInfoVerification:this.$fxUtils.fxDataVerification(),fxOrderDetailsVerification:this.$fxUtils.fxDataVerification(),backAbsolute:!1,moreActionShow:!1,superaddition:!1,saveDebounce:this.$fxUtils.debounce(),showKeyboard:!1,editIndex:-1,editAmountType:""}},created:function(){this.getSystemParams().then(this.refreshOrderDetails)},beforeRouteLeave:function(t,e,i){var s=this;if(this.itemInputFocusing)return this.$router.go(1),!1;"/centerCheckBill4cld"!==t.path&&"/centerCheckIn4cld"!==t.path||!this.isChange||this.backAbsolute?i():this.$dialog.confirm({title:"提示",message:"当前单据已修改<br/>是否保存单据?"}).then(function(){return s.$router.go(1),s.checkOrderInfo().then(s.saveHandler).then(function(){s.backAbsolute=!0,s.$fxGo("BACK",s.$router)}),!1}).catch(function(){i()})},computed:Object(u["a"])({},Object(m["c"])({sysPointSize:"sysPointSize",sysMoneyPointSize:"sysMoneyPointSize",loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId},disOut_arrivalIntervalTime:function(t){return t.systemParamsCld.disOut_arrivalIntervalTime},disOut_setDate4Check:function(t){return t.systemParamsCld.disOut_setDate4Check},centerCheck_showAllCheckType:function(t){return t.systemParamsCld.centerCheck_showAllCheckType},centerCheck_enableItemPack:function(t){return t.systemParamsCld.centerCheck_enableItemPack}}),{isBillState:function(t){var e=this;return function(t){return e.$fxStateMiddleware.stateIs("stateAndRecheckSingleCld")(t)(e.orderInfoData.billStateFlag)}},isChange:function(){return!this.fxOrderInfoVerification.checkData(this.orderInfoData)||!this.fxOrderDetailsVerification.checkData(this.orderItemList)},moreList:function(){var t=[this.$fxAuth("centerCheckBill4cld.actualAmountZero"),this.$fxAuth("centerCheckBill4cld.actualAmountEqualsAcc"),this.$fxAuth("centerCheckBill4cld.importMustItems")&&!this.$fxAuth("centerCheckBill4cld.notAllAddDetail"),this.$fxAuth("centerCheckBill4cld.importCheckItems")&&!this.$fxAuth("centerCheckBill4cld.notAllAddDetail"),!this.$fxAuth("centerCheckBill4cld.notAllAddDetail")];return kt.filter(function(e){return t[e.id]})}}),methods:{getSystemParams:function(){var t=this;return this.$fxApi("centerCheckBill4cld.getSystemParams").then(function(e){var i={},s=e.baseDataVO;return s.forEach(function(t){i[t.key]=t.value}),t.$store.commit({type:"ADD_SYSTEM_PARAMS_CLD",state:{centerCheck_defaultCurrentTime:i.defaultCurrentTime,centerCheck_defaultCurrentDay:i.defaultCurrentDay,centerCheck_unCheckDoWay:i.unCheckDoWay,centerCheck_showAllCheckType:i.showAllCheckType,centerCheck_enableItemPack:i.enableItemPack}}),h.a.resolve(e)})},refreshOrderDetails:function(){return this.$fxApi("centerCheckBill4cld.getOrderDetails",this.query.orderId).then(this.initOrderDetails)},initOrderDetails:function(t){var e=this,i=t.storeBills[0];return this.orderInfoData=i,this.orderItemList=i.details,this.setDataUUID(this.orderItemList),this.$nextTick(function(){e.fxOrderInfoVerification.resetData(e.orderInfoData),e.fxOrderDetailsVerification.resetData(e.orderItemList)}),h.a.resolve()},setDataUUID:function(t){var e=this;t.forEach(function(t){t.uuid=e.$fxUtils.createUUID()})},clearItemConfirm:function(t){var e=this;return new h.a(function(i){var s=e.orderItemList.filter(function(t){return"del"!==t.changeType});0===s.length?i():e.$dialog.confirm({title:"提示",message:t}).then(function(){e.onItemClear(),i()})})},onRdcClick:function(){var t=this;this.getRdcListData().then(function(e){t.rdcList=e.shops,t.rdcPopShow=!0})},searchRdc:function(t){var e=this;this.getRdcListData(t).then(function(t){e.houserdcListList=t.shops})},selectRdc:function(t){var e=this;this.checkRdc(t).then(function(){var i=e.orderItemList.filter(function(t){return"del"!==t.changeType});0===i.length?e.$dialog.confirm({title:"提示",message:"修改配送中心将清空盘点仓库，是否继续?"}).then(function(){e.orderInfoData.rdcDTO=t,e.orderInfoData.houseDTO={}}):e.$dialog.confirm({title:"提示",message:"修改配送中心将清空盘点仓库和单据明细，是否继续?"}).then(function(){e.onItemClear(),e.orderInfoData.rdcDTO=t,e.orderInfoData.houseDTO={}})})},checkRdc:function(t){var e=this;return new h.a(function(i){var s=e.orderInfoData.rdcDTO;s.id!==t.id&&i()})},getRdcListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getRdcListData")({data:e})},onHouseClick:function(){var t=this;if(!this.orderInfoData.rdcDTO.id)return this.$fxToast.fail("请先选择配送中心!"),!1;this.getHouseListData().then(function(e){t.houseList=e.shops,t.housePopShow=!0})},searchHouse:function(t){var e=this;this.getHouseListData(t).then(function(t){e.houseList=t.shops})},selectHouse:function(t){var e=this;this.checkHouse(t).then(function(){"1"===t.refItemFlag?e.clearItemConfirm("切换关联品项的仓库将清空单据明细，是否继续?").then(function(){e.orderInfoData.houseDTO=t}):e.orderInfoData.houseDTO=t})},checkHouse:function(t){var e=this;return new h.a(function(i){var s=e.orderInfoData.houseDTO;s.id!==t.id&&i()})},getHouseListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getStoreListData",this.orderInfoData.rdcDTO.id)({data:e})},onCheckTypeClick:function(){var t=this;this.getCheckTypeListData().then(function(e){t.checkTypeList=e.baseDataVO,t.checkTypePopShow=!0})},searchCheckType:function(t){var e=this;this.getCheckTypeListData(t).then(function(t){e.checkTypeList=t.baseDataVO})},selectCheckType:function(t){var e=this;this.checkCheckType(t).then(function(){e.clearItemConfirm("切换盘点分类将清空单据明细，是否继续?").then(function(){e.orderInfoData.checkTypeDTO=t})})},checkCheckType:function(t){var e=this;return new h.a(function(i){var s=e.orderInfoData.checkTypeDTO;s.id!==t.id&&i()})},getCheckTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("centerCheckBill4cld.getCheckTypeList",this.orderInfoData.rdcDTO.id)({data:e})},onBusinessDateClick:function(){this.orderInfoData.businessDate&&(this.currentDate=new Date(this.orderInfoData.businessDate)),this.datePickerShow=!0},dateConfirmhandle:function(t){var e=t.getTime();this.orderInfoData.businessDate=e,this.datePickerShow=!1},onNotCheckTypeClick:function(){var t=this;this.$refs.notCheckTypeActionSheet.doSelect().then(function(e){t.orderInfoData.unCheckItemDoType=e.id})},onGroupFlagClick:function(){var t=this;this.$refs.groupFlagActionSheet.doSelect().then(function(e){t.orderInfoData.groupFlag=e.id})},onCostTypeClick:function(){var t=this;this.$refs.costTypeActionSheet.doSelect().then(function(e){t.$fxTypeMiddleware.isCommonType("costType")(["all"])(e.id)?t.orderInfoData.costType=e.id:t.clearItemConfirm("修改成本类型将清空单据明细，是否继续?").then(function(){t.orderInfoData.costType=e.id})})},onBillTypeClick:function(){var t=this;this.getBillTypeListData().then(function(e){t.billTypeList=e.businessTypes,t.billTypePopShow=!0})},selectBillType:function(t){this.billType=t},searchBillType:function(t){var e=this;this.getBillTypeListData(t).then(function(t){e.billTypeList=t.businessTypes})},getBillTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={m:"list4CenterCheck",keyword:t};return this.$fxApi("common.getBusinessTypeListData")({data:e})},onAddClick:function(){var t=this;this.checkOrderInfo().then(this.saveHandler).then(this.refreshOrderDetails).then(this.canAddItem).then(function(){t.superaddition=!1,t.itemPopShow=!0})},checkOrderInfo:function(){var t=this;return new h.a(function(e,i){t.orderInfoData.rdcDTO.id?t.orderInfoData.houseDTO.id?t.orderInfoData.checkTypeDTO.id?t.orderInfoData.businessDate?e():t.$fxToast.top("请先选择业务日期!"):t.$fxToast.top("请先选择盘点分类!"):t.$fxToast.top("请先选择盘点仓库!"):t.$fxToast.top("请先选择配送中心!")})},canAddItem:function(){return this.$fxApi("centerCheckBill4cld.canAddItem",this.query.orderId)},onSearchClick:function(){this.itemSearchPopShow=!0,this.searchItem=this.$fxUtils.deepClone(this.orderItemList)},onSaveClick:function(){var t=this;this.checkOrderInfo().then(function(){t.$dialog.confirm({title:"提示",message:"确定要保存该单据吗?"}).then(t.saveHandler).then(t.refreshOrderDetails).then(function(){t.$fxToast.success("保存成功")})})},saveHandler:function(){if(this.isBillState(["unSubmit","returned"])&&this.isChange){var t=this.getSaveParams();return this.$fxApi("centerCheckBill4cld.saveOrder")({data:t})}return h.a.resolve()},onExpressClick:function(){var t=this;this.checkOrderInfo().then(function(){t.checkValidate().then(function(e){t.$dialog.confirm({title:"提示",message:e}).then(t.saveHandler).then(t.refreshOrderDetails).then(t.expressHandler)})})},expressHandler:function(){var t=this,e=this.getSaveParams();return this.$fxApi("centerCheckBill4cld.checkOrder",this.query.orderId)({data:e}).then(function(e){t.refreshOrderDetails().then(function(){t.$fxToast.success("审核成功")})})},checkValidate:function(){var t=this;return new h.a(function(e){t.$fxApi("centerCheckBill4cld.checkValidate",t.query.orderId).then(function(t){e("确定要审核该单据吗?")}).catch(function(i){"3"===i.errorCode?e(i.message):t.$dialog.alert({title:"提示",message:i.message})})})},onUnExpressClick:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定要反审该单据吗?"}).then(this.unExpressHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("反审成功")})},unExpressHandler:function(){var t=this.getSaveParams();return this.$fxApi("centerCheckBill4cld.uncheckOrder",this.query.orderId)({data:t})},onDeleteClick:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定要删除该单据吗?";this.$dialog.confirm({title:"提示",message:e}).then(this.deleteOrderHandler).then(function(){t.$fxToast.success("删除成功").then(function(){t.backAbsolute=!0,t.$router.go(-1)})})},deleteOrderHandler:function(){var t=this.getSaveParams();return this.$fxApi("centerCheckBill4cld.deleteOrder",this.query.orderId)({data:t})},getSaveParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.orderItemList,e=t.filter(function(t){return"add"===t.changeType}),i=t.filter(function(t){return"del"===t.changeType}),s=t.filter(function(t){return"edit"===t.changeType}),n=r()({},this.orderInfoData,{detailAdd:e.length>0?e:null,detailDel:i.length>0?i:null,detailMdf:s.length>0?s:null,details:[]});return n},getValidItem:function(){return this.orderItemList.filter(function(t){return"del"!==t.changeType})},getItemLength:function(){return this.getValidItem().length},onItemEdit:function(t){this.itemEditRowData=t,this.itemRowEditPopShow=!0},toFixedNumberSize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sysMoneyPointSize;return c()(this.$fxUtils.toFixedSHW(t,e))},onItemClear:function(){var t=this.orderInfoData.details.filter(function(t){return!!t.id});t.forEach(function(t){t.changeType="del"}),this.orderInfoData.details=t,this.orderItemList=t},onClickHandler:function(t){if(this.itemInputFocusing)return!1;this[t]()},onSearchConfirm:function(t){var e=this;this.orderItemList=t,this.orderInfoData.details=t,this.saveHandler().then(this.refreshOrderDetails).then(function(){e.$fxToast.success("保存成功")})},itemEditBeforeConfirm:function(t){var e=this;return new h.a(function(i){if(t.length>0){var s="1";e.orderItemList.length>0&&(s=e.orderItemList[0].num-0+1);var n=t.filter(function(t){var i=e.orderItemList.findIndex(function(e){return e.goodsDTO.id===t.goodsDTO.id});return!~i});n.forEach(function(t){t.changeType="add",t.num=s}),e.itemEditConfirmsaveHandler([].concat(Object(a["a"])(e.orderItemList),Object(a["a"])(n))).then(e.refreshOrderDetails).then(function(){e.$fxToast.success("保存成功"),i()})}else i()})},itemEditConfirmsaveHandler:function(t){var e=this.getSaveParams(t);return this.$fxApi("centerCheckBill4cld.saveOrder")({data:e})},onSubmitClick:function(){var t=this;this.checkOrderInfo().then(function(){t.$dialog.confirm({title:"提示",message:"确定要提交该单据吗?"}).then(t.saveHandler).then(t.refreshOrderDetails).then(t.onSubmitHandler).then(t.refreshOrderDetails).then(function(){t.$fxToast.success("提交成功")})})},onSubmitHandler:function(){return this.$fxApi("centerCheckBill4cld.submitOrder",this.query.orderId)},onReturnClick:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定要退回该单据吗?"}).then(this.onReturnHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("退回成功")})},onReturnHandler:function(){return this.$fxApi("centerCheckBill4cld.returnOrder",this.query.orderId)},onExpressAgainClick:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定要复审该单据吗?"}).then(this.checkAgainHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("复审成功")})},checkAgainHandler:function(){var t=this.getSaveParams();return this.$fxApi("centerCheckBill4cld.checkAgain",this.query.orderId)({data:t})},onUnExpressAgainClick:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定要取消复审该单据吗?"}).then(this.UnExpressAgainHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("取消复审成功")})},UnExpressAgainHandler:function(){var t=this.getSaveParams();return this.$fxApi("centerCheckBill4cld.unReCheck",this.query.orderId)({data:t})},onMoreClick:function(){var t=this;this.checkOrderInfo().then(this.$refs.moreActionSheet.doSelect).then(function(e){t[e.handler]()})},doCheckZero:function(t){var e=this;this.$dialog.confirm({title:"提示",message:"确定进行实盘为0操作吗?"}).then(this.saveHandler).then(this.checkZeroHandler).then(this.refreshOrderDetails).then(function(){e.$fxToast.success("操作成功")})},checkZeroHandler:function(){return this.$fxApi("centerCheckBill4cld.checkZero",this.query.orderId)},doCheckAccount:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定进行实盘取账存操作吗?"}).then(this.saveHandler).then(this.checkAccountHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("操作成功")})},checkAccountHandler:function(){return this.$fxApi("centerCheckBill4cld.checkAccount",this.query.orderId)},doImportMust:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定进行导入必盘项操作吗?"}).then(this.saveHandler).then(this.importMustHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("导入成功")})},importMustHandler:function(){var t={checkBillId:this.query.orderId,storeId:this.orderInfoData.houseDTO.name,checkWay:this.orderInfoData.groupFlag};return this.$fxApi("centerCheckBill4cld.importMustItem",this.query.orderId)({data:t})},doImportCheck:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定进行导入盘点品项操作吗?"}).then(this.saveHandler).then(this.importCheckHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("导入成功")})},importCheckHandler:function(){var t={checkBillId:this.query.orderId,storeId:this.orderInfoData.houseDTO.name,checkWay:this.orderInfoData.groupFlag};return this.$fxApi("centerCheckBill4cld.importCheckItem",this.query.orderId)({data:t})},doSuperaddition:function(){var t=this;this.checkOrderInfo().then(this.saveHandler).then(this.refreshOrderDetails).then(this.canAddItem).then(function(){t.superaddition=!0,t.itemPopShow=!0})},saveSilenceHandler:function(){var t=this;this.saveDebounce(1e4).then(function(){if(t.isBillState(["unSubmit","returned"])&&t.isChange){var e=t.getSaveParams();t.$fxApi("centerCheckBill4cld.saveOrderSilence")({data:e}).then(function(){t.fxOrderInfoVerification.resetData(t.orderInfoData),t.fxOrderDetailsVerification.resetData(t.orderItemList)})}})},goCenterCheckInBill:function(){this.$router.replace({path:"centerCheckIn4cldDetails",query:{orderId:this.orderInfoData.checkInBill}})},goCenterCheckOutBill:function(){this.$router.replace({path:"centerCheckOut4cldDetails",query:{orderId:this.orderInfoData.checkOutBill}})},onAmountEdit:function(t,e,i){this.editAmountType=t,this.editIndex=i,this.$refs.orderInfo.closeCollapse(),this.$refs.itemNumberKeyboard.open(t,e,i),this.$refs.orderItem.scrollTop(i)},onKeyboardPrev:function(t){this.$refs.orderItem.prev(t),this.saveSilenceHandler()},onKeyboardNext:function(t){this.$refs.orderItem.next(t),this.saveSilenceHandler()},onKeyboardClose:function(){this.editAmountType="",this.editIndex=-1,this.showKeyboard=!1,this.saveSilenceHandler()},onEditAmountTypeChange:function(t){this.editAmountType=t}}},bt=vt,Ct=(i("0002c"),Object(b["a"])(bt,s,n,!1,null,"636e8a39",null));e["default"]=Ct.exports},"2a4a":function(t,e,i){"use strict";var s=i("c644"),n=i.n(s);n.a},"2f8b":function(t,e,i){"use strict";var s=i("8c37"),n=i.n(s);n.a},"41c0":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU5MzM3ODc2REY1QzExRTlBNjU4QkY2NDE0MTBEMjAzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU5MzM3ODc3REY1QzExRTlBNjU4QkY2NDE0MTBEMjAzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTkzMzc4NzRERjVDMTFFOUE2NThCRjY0MTQxMEQyMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTkzMzc4NzVERjVDMTFFOUE2NThCRjY0MTQxMEQyMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6ky6P/AAACeElEQVR42sSXTW8SURSGLwNhAZLQBAhb09K6Vxd+xpWJNboxqRub9meoP0D7M5roRl36lW6tsQvtvkobd4QASUkYWPDp+07OkENtYabD1ZO8cyHMvM+9d+695xAbjUbmf0QiyE3lcjmG5hZ0H7oBLUEL8vMxdAh9gz5Au6VSaeZoYtNGDKCDZhN6JrAgwU68hLbRgWFoMKAX0byBrnpTk0iYTCZjUqmUSSaTJh6PGz7b7/c9dTod47qu6fV6vsV36DHgvwODAb2D5h2UIzCXy3nQINFqtUyj0fA6g2hAjwD/MhMM6F0076FkOp02xWLROI4TauEMh0NTrVZNu93m1y70EPCdM8GArsgUZbLZrMnn85FWbr1eN81mkx9d6ArgP/3fHAWNo3lFKKc1KpRBD3lFF+gtjEkwYoMLie+0UCjMbb/Si56ySDcnwLJPuWW8hRT2nU4LetFT4qmwxiO+zX3qb5l5Bz1l1EvCGoNX/RtshfJe1eDrvPBwsBXK+5oGl3jhiWQrlPeyBnsHPo9BW6G8F05up38ajkptZjAYWAMp72MNLnuHardrDay8f2nwHi9MbbZCee9p8Ec/pdkK5f1Jg5kvD5lDbcDpKfmZ1cnuGCw10paXuZHEmU/nFfSip8SWXw7p7bQN/WDParXa3MD0ktHuC2MyLaInXO/rTNqcGibxqEEPeXUsBJ4I4698TPgBmjWuflYOlUrlXNPOZ/isVB/cR2viPbPYu4fmLSuHiMWeK9DPYcrbS2heQ5fPKm/9E4mHwynl7b5M70GUgv45tBhwpo+gF+cu6E/pwE3ogeTuxRN/YY7kLwzL4q/TgKHANuKPAAMAun8rS4SUYuAAAAAASUVORK5CYII="},"4a6f":function(t,e,i){"use strict";var s=i("eee7"),n=i.n(s);n.a},"4e06":function(t,e,i){},5402:function(t,e,i){"use strict";var s=i("73b7"),n=i.n(s);n.a},6736:function(t,e,i){},"6f71":function(t,e,i){"use strict";var s=i("11a2"),n=i.n(s);n.a},7290:function(t,e,i){},"73b7":function(t,e,i){},"7cc2":function(t,e,i){},"8af0":function(t,e,i){"use strict";var s=i("7cc2"),n=i.n(s);n.a},"8c37":function(t,e,i){},"8d5d":function(t,e,i){"use strict";var s=i("08d9"),n=i.n(s);n.a},"960a":function(t,e,i){"use strict";var s=i("ff4f"),n=i.n(s);n.a},"9fc4":function(t,e,i){"use strict";var s=i("4e06"),n=i.n(s);n.a},a09d:function(t,e,i){},a2a5:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",[i("fx-order-list-header",{attrs:{title:"中心盘点单",showCheckBtn:t.$fxAuth("centerCheckBill4cld.check"),checkBtnActive:t.orderEditFlag,showSearchBtn:!t.orderEditFlag,showSelectAllBtn:t.orderEditFlag,selectAllBtnActive:t.isSelectAll},on:{"on-check-click":t.onOrderEditClick,"on-search-click":t.onSearchClick,"on-selectAll-click":t.onSelectAllClick}}),i("fx-filter-tab",{attrs:{leftTabState:t.filterStateAndRestate,rightTabState:t.filterSortingState,leftTabType:"checkAndRecheckStateSingle",rightTabType:"weightStateCld"},on:{"on-left-tab-select":t.onStateSelect,"on-right-tab-select":t.onSortingSelect}}),i("fx-order-list-container",{attrs:{data:t.orderList,loadFinished:t.loadFinished},on:{"on-refresh":t.onPullRefresh,"on-loadMore":t.onLoadMore},model:{value:t.pullRefreshLoading,callback:function(e){t.pullRefreshLoading=e},expression:"pullRefreshLoading"}},t._l(t.orderList,function(e){return i("orderBlock",{directives:[{name:"show",rawName:"v-show",value:t.computedShowOrder(e.billStateFlag),expression:"computedShowOrder(item.billStateFlag)"}],key:e.id,attrs:{data:e,showCheckBox:t.orderEditFlag},on:{"on-click":function(i){return t.onClickOrder(e)}}})}),1),i("w-bottom-btn-bar",[i("w-button",{directives:[{name:"show",rawName:"v-show",value:!t.orderEditFlag&&t.$fxAuth("centerCheckBill4cld.add"),expression:"!orderEditFlag && $fxAuth('centerCheckBill4cld.add')"}],attrs:{size:"large",type:"primary"},on:{click:t.onCreateClick}},[t._v("添加单据\n\t\t")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.orderEditFlag&&t.$fxAuth("centerCheckBill4cld.check"),expression:"orderEditFlag && $fxAuth('centerCheckBill4cld.check')"}],attrs:{size:"large",type:"primary"},on:{click:t.onExpressClick}},[t._v("批量审核")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.filterPopShow,expression:"filterPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.filterPopShow,callback:function(e){t.filterPopShow=e},expression:"filterPopShow"}},[i("filterPop",{attrs:{visibleFlag:t.filterPopShow,filterParams:t.filterParams},on:{"update:visibleFlag":function(e){t.filterPopShow=e},"update:visible-flag":function(e){t.filterPopShow=e},"update:filterParams":function(e){t.filterParams=e},"update:filter-params":function(e){t.filterParams=e},"on-confirm":t.onFilterConfirm}})],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.checkActionSheetShow,expression:"checkActionSheetShow"}],ref:"checkActionSheet",attrs:{actions:t.checkActions},model:{value:t.checkActionSheetShow,callback:function(e){t.checkActionSheetShow=e},expression:"checkActionSheetShow"}}),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.sortingActionSheetShow,expression:"sortingActionSheetShow"}],ref:"sortingActionSheet",attrs:{actions:t.sortingCheckActions},model:{value:t.sortingActionSheetShow,callback:function(e){t.sortingActionSheetShow=e},expression:"sortingActionSheetShow"}})],1)},n=[],a=i("75fc"),o=i("5176"),c=i.n(o),l=i("795b"),r=i.n(l),d=i("cebc"),h=(i("6762"),i("2f62")),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-block fx-shadow-block",on:{click:t.onClick}},[i("checkBox",{staticClass:"order-checkbox",attrs:{visibleFlag:t.showCheckBox,checked:t.data.checked},on:{"on-checkbox-click":t.onClick}}),i("div",{staticClass:"block-content"},[i("div",{staticClass:"block-title"},[i("i",{staticClass:"block-icon"}),i("span",{staticClass:"title-text"},[t._v(t._s(t.data.rdcDTO.name))]),i("fx-state-tag",{staticClass:"state-tag",attrs:{type:"checkAndRecheckStateSingleCld",billState:t.data.billStateFlag}}),i("fx-state-tag",{staticClass:"weight-state-tag",attrs:{type:"weightStateCld",weightState:t.data.weightState}})],1),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[t._v(t._s(t.data.sysbillCode))])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[i("span",[t._v("盘点仓库：")]),i("span",[t._v(t._s(t.data.houseDTO.name))])])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[i("span",[t._v("明细数：")]),i("span",[t._v(t._s(t.data.detailCount))])])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[i("span",[t._v("业务日期：")]),i("span",[t._v(t._s(t._f("filterDateYMD")(t.data.businessDate)))])])])])],1)},m=[],f=i("59ad"),p=i.n(f),k=i("0f38"),v={name:"orderBlock",components:{checkBox:k["a"]},props:{data:{type:Object,default:function(){return{}}},showCheckBox:{type:Boolean,default:!1}},computed:Object(d["a"])({},Object(h["c"])({sysMoneyPointSize:"sysMoneyPointSize"}),{toFixedNumberSize:function(t){var e=this;return function(t){return p()(e.$fxUtils.toFixedSHW(t,e.sysMoneyPointSize))}}}),methods:{onClick:function(){this.showCheckBox?this.$set(this.data,"checked",!this.data.checked):this.$emit("on-click",this.data)}}},b=v,C=(i("960a"),i("2877")),g=Object(C["a"])(b,u,m,!1,null,"12cfb7e8",null),y=g.exports,D=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fx-order-list-filter",{on:{"on-back":t.onCloseClick}},[i("van-cell-group",[i("w-cell",{attrs:{title:"业务日期"}}),i("w-cell",{attrs:{title:"起始时间","is-link":""},on:{click:t.onBeginDateClick}},[t._v(t._s(t.beginDate))]),i("w-cell",{attrs:{title:"结束时间","is-link":""},on:{click:t.onEndDateClick}},[t._v(t._s(t.endDate))]),i("w-cell",{attrs:{title:"配送中心","is-link":""},on:{click:t.onRdcClick}},[t._v(t._s(t.rdc.name))]),i("w-cell",{attrs:{title:"盘点仓库","is-link":""},on:{click:t.onHouseClick}},[t._v(t._s(t.house.name))]),i("w-cell",{attrs:{title:"品项","is-link":""},on:{click:t.onGoodsClick}},[t._v(t._s(t.goods.name))]),i("w-cell",{attrs:{title:"业务类型","is-link":!t.billType.id,"is-clear":!!t.billType.id},on:{click:t.onBillTypeClick,"on-clear":t.onBillTypeClearClick}},[t._v(t._s(t.billType.name))]),i("van-pro-field",{ref:"billNo",attrs:{label:"系统单号",placeholder:"请输入系统单号","input-align":"right"},on:{focus:function(e){return t.onFocus("billNo")}},model:{value:t.billNo,callback:function(e){t.billNo=e},expression:"billNo"}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{type:"date",visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.rdcPopShow,callback:function(e){t.rdcPopShow=e},expression:"rdcPopShow"}},[i("listComp",{attrs:{visibleFlag:t.rdcPopShow,data:t.rdcList,loadFinished:!0,title:"配送中心检索"},on:{"update:visibleFlag":function(e){t.rdcPopShow=e},"update:visible-flag":function(e){t.rdcPopShow=e},"on-select":t.selectRdcs,"on-search":t.searchRdcs}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.housePopShow,callback:function(e){t.housePopShow=e},expression:"housePopShow"}},[i("listComp",{attrs:{visibleFlag:t.housePopShow,data:t.houseList,title:"仓库检索",loadFinished:!0},on:{"update:visibleFlag":function(e){t.housePopShow=e},"update:visible-flag":function(e){t.housePopShow=e},"on-select":t.selectHouse,"on-search":t.searchHouse}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.goodsPopShow,callback:function(e){t.goodsPopShow=e},expression:"goodsPopShow"}},[i("listComp",{attrs:{visibleFlag:t.goodsPopShow,data:t.goodsList,title:"品项检索",loading:t.goodsLoading,loadFinished:t.goodsLoadFinished},on:{"update:visibleFlag":function(e){t.goodsPopShow=e},"update:visible-flag":function(e){t.goodsPopShow=e},"update:loading":function(e){t.goodsLoading=e},"on-select":t.selectGoods,"on-search":t.searchGoods,"on-load":t.loadGoodsList}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.billTypePopShow,callback:function(e){t.billTypePopShow=e},expression:"billTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.billTypePopShow,data:t.billTypeList,title:"单据类型检索",loadFinished:!0},on:{"update:visibleFlag":function(e){t.billTypePopShow=e},"update:visible-flag":function(e){t.billTypePopShow=e},"on-select":t.selectBillType,"on-search":t.searchBillType}})],1),i("w-button",{attrs:{slot:"bottom-btn",size:"large",type:"info"},on:{click:t.onResetClick},slot:"bottom-btn"},[t._v("重置")]),i("w-button",{attrs:{slot:"bottom-btn",size:"large",type:"primary"},on:{click:t.onConfirmClick},slot:"bottom-btn"},[t._v("确定")])],1)},w=[],S=i("f6bb"),T=50,x={name:"FilterPop",components:{listComp:S["a"]},props:{visibleFlag:Boolean,filterParams:{type:Object,default:function(){return{}}}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},currentDate:new Date,datePickerShow:!1,beginDate:"",endDate:"",rdc:{name:"请选择"},rdcList:[],rdcPopShow:!1,house:{name:"请选择"},houseList:[],housePopShow:!1,goods:{name:"请选择"},goodsListStart:0,goodsList:[],goodsLoading:!1,goodsLoadFinished:!1,goodsPopShow:!1,searchGoodsKeyword:"",billType:{name:"请选择"},billTypeList:[],billTypePopShow:!1,billNo:""}},watch:{visibleFlag:{handler:function(t){t&&this.$fxUtils.isEmptyObjSHW(this.filterParams)&&this.resetHandler()},immediate:!0},businessDateStart:{immediate:!0,handler:function(t){this.beginDate=t}},businessDateEnd:{immediate:!0,handler:function(t){this.endDate=t}}},computed:Object(d["a"])({},Object(h["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId},businessDateStart:function(t){return t.systemParamsCld.businessDateStart},businessDateEnd:function(t){return t.systemParamsCld.businessDateEnd}})),methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onBeginDateClick:function(){this.datePickerShow=!0,this.beginDate&&(this.currentDate=new Date(this.beginDate)),this.dateType="begin"},onEndDateClick:function(){this.datePickerShow=!0,this.endDate&&(this.currentDate=new Date(this.endDate)),this.dateType="end"},dateConfirmhandle:function(t){"begin"===this.dateType?this.beginDate=this.$fxUtils.setDate(t):this.endDate=this.$fxUtils.setDate(t),this.datePickerShow=!1},onRdcClick:function(){var t=this;this.getRdcListData().then(function(e){t.rdcList=e.shops,t.rdcPopShow=!0})},selectRdcs:function(t){this.rdc=t,this.house={name:"请选择"},this.goods={name:"请选择"}},searchRdcs:function(t){var e=this;this.getRdcListData(t).then(function(t){e.rdcList=t.shops})},getRdcListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getRdcListData")({data:e})},onHouseClick:function(){var t=this;if(!this.rdc.id)return this.$fxToast.fail("请先选择配送中心!"),!1;this.getHouseListData().then(function(e){t.houseList=e.shops,t.housePopShow=!0})},selectHouse:function(t){this.house=t,this.goods={name:"请选择"}},searchHouse:function(t){var e=this;this.getHouseListData(t).then(function(t){e.houseList=t.shops})},getHouseListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getStoreListData",this.rdc.id)({data:e})},onGoodsClick:function(){var t=this;this.goodsListStart=0,this.searchGoodsKeyword="",this.getGoodsListData().then(function(e){t.goodsLoading=!1,t.goodsPopShow=!0,t.goodsList=e.goods})},selectGoods:function(t){this.goods=t},searchGoods:function(t){var e=this;this.goodsListStart=0,this.searchGoodsKeyword=t,this.getGoodsListData(t).then(function(t){t.goods.length<T&&(e.goodsLoadFinished=!0),e.goodsList=t.goods})},loadGoodsList:function(){var t=this;!0!==this.goodsLoadFinished&&(this.goodsListStart=this.goodsListStart+T,this.getGoodsListData(this.searchGoodsKeyword).then(function(e){var i;t.goodsLoading=!1,e.goods.length<T&&(t.goodsLoadFinished=!0),(i=t.goodsList).push.apply(i,Object(a["a"])(e.goods))}))},getGoodsListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={start:this.goodsListStart,size:T,paged:!0,keyword:t};return this.$fxApi("common.getGoodsListData")({data:e})},onBillTypeClick:function(){var t=this;this.getBillTypeListData().then(function(e){t.billTypeList=e.businessTypes,t.billTypePopShow=!0})},selectBillType:function(t){this.billType=t},searchBillType:function(t){var e=this;this.getBillTypeListData(t).then(function(t){e.billTypeList=t.businessTypes})},getBillTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={m:"list4CenterCheck",keyword:t};return this.$fxApi("common.getBusinessTypeListData")({data:e})},onResetClick:function(){this.resetHandler()},resetHandler:function(){this.beginDate=this.businessDateStart,this.endDate=this.businessDateEnd,this.rdc={name:"请选择"},this.inShop={name:"请选择"},this.house={name:"请选择"},this.billType={name:"请选择"},this.goods={name:"请选择"},this.billNo=""},onConfirmClick:function(){if(new Date(this.endDate)<new Date(this.beginDate))return this.$fxToast.fail("开始日期不能大于结束日期!"),!1;this.$emit("update:visibleFlag",!1),this.$emit("update:filterParams",this.getFilterParams()),this.$emit("on-confirm",this.getFilterParams())},getFilterParams:function(){return{beginDate:this.beginDate,endDate:this.endDate,rdcId:this.rdc.id,houseId:this.house.id,billTypeId:this.billType.id,goodsId:this.goods.id,billNo:this.billNo}},onFocus:function(t){this.onScrollTop(t)},onScrollTop:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=this.$refs[t];if(!i||0===i.length)return!1;var s=i.$el.offsetTop,n=this.$refs["filterContent"];this.$fxUtils.scrollTopW({offsetTop:s,$el:n,distance:e})},onBillTypeClearClick:function(){this.billType={name:"请选择",id:""}}}},A=x,I=Object(C["a"])(A,D,w,!1,null,null,null),P=I.exports,_=50,L={name:"centerCheckBill4cld",components:{orderBlock:y,filterPop:P},data:function(){return{routeParams:this.$route.params,orderList:[],filterPopShow:!1,filterStateAndRestate:"0",filterSortingState:null,listStart:0,pullRefreshLoading:!1,loadFinished:!0,orderEditFlag:!1,filterParams:{},checkActionSheetShow:!1,checkActions:[],sortingActionSheetShow:!1,sortingCheckActions:this.$fxStateMiddleware.getStateList("sortingState")}},beforeRouteEnter:function(t,e,i){var s=["/main/home","/"],n=["/centerCheckBill4cldDetails"];s.includes(e.path)?i(function(t){t.restFilterParams(),t.refreshOrderList()}):n.includes(e.path)?i(function(t){t.refreshOrderList()}):i()},computed:Object(d["a"])({},Object(h["c"])({billListPostParams:"billListPostParams",businessDateStart:function(t){return t.systemParamsCld.businessDateStart},businessDateEnd:function(t){return t.systemParamsCld.businessDateEnd},disOut_setDate4Check:function(t){return t.systemParamsCld.disOut_setDate4Check}}),{computedShowOrder:function(t){var e=this;return function(t){return!e.orderEditFlag||!e.$fxStateMiddleware.stateIs("stateCld")("checked")(t)}},isSelectAll:function(){var t=this;return this.$fxCommon.orderListIsSelectAll(function(){return t.orderList.filter(function(e){return!t.$fxStateMiddleware.stateIs("stateCld")("checked")(e.billStateFlag)})})}}),methods:{orderListPostHandler:function(t){return this.$store.commit({type:"SETSTATE",billListPostParams:t}),this.$fxApi("centerCheckBill4cld.getOrderListData")({data:t})},refreshOrderList:function(){var t=this;return new r.a(function(e){t.listStart=0;var i={start:t.listStart,size:_,paged:!0,businessDateStart:t.businessDateStart,businessDateEnd:t.businessDateEnd,billStateFlag:t.filterStateAndRestate,weightState:t.filterSortingState};i=c()(i,t.translateFilterParams(t.filterParams)),t.orderListPostHandler(i).then(function(i){t.orderList=i.storeBills,e(i)})})},onFilterConfirm:function(t){var e=this;this.listStart=0;var i={start:this.listStart,size:_,paged:!0,businessDateStart:t.beginDate,businessDateEnd:t.endDate,billStateFlag:this.filterStateAndRestate,weightState:this.filterSortingState,rdcId:""===t.rdcId?null:t.rdcId,houseId:""===t.houseId?null:t.houseId,goodsId:""===t.goodsId?null:t.goodsId,businessType:""===t.billTypeId?null:t.billTypeId,sysBillCode:""===t.billNo?null:t.billNo};this.orderListPostHandler(i).then(function(t){e.orderList=t.storeBills})},translateFilterParams:function(t){return this.$fxUtils.isEmptyObjSHW(t)?{}:{businessDateStart:t.beginDate,businessDateEnd:t.endDate,rdcId:""===t.rdcId?null:t.rdcId,inShopId:""===t.inShopId?null:t.inShopId,houseId:""===t.houseId?null:t.houseId,goodsId:""===t.goodsId?null:t.goodsId,businessType:""===t.billTypeId?null:t.billTypeId,sysBillCode:""===t.billNo?null:t.billNo}},onPullRefresh:function(){var t=this;this.refreshOrderList().then(function(e){t.pullRefreshLoading=!1})},onLoadMore:function(){var t=this,e=c()(this.billListPostParams,{start:this.listStart});this.orderListPostHandler(e).then(function(e){var i;(i=t.orderList).push.apply(i,Object(a["a"])(e.storeBills))})},onSearchClick:function(){this.filterPopShow=!0},onStateSelect:function(t){this.filterStateAndRestate=t.id,this.refreshOrderList()},onSortingSelect:function(t){this.filterSortingState=t.id,this.refreshOrderList()},onClickOrder:function(t){this.$router.push({path:"centerCheckBill4cldDetails",query:{orderId:t.id}})},onCreateClick:function(){this.$router.push("createCenterCheckBill4cld")},onOrderEditClick:function(t){this.orderEditFlag=!t},onExpressClick:function(){var t=this,e=this.orderList.reduce(function(t,e){var i=e.checked?t.concat(e.id):t;return i},[]);if(0===e.length)return this.$fxToast.fail("请选择要审核的单据"),!1;var i={ids:e.join(",")};this.$dialog.confirm({title:"提示",message:"确定要审核已选择单据吗?"}).then(function(){t.expressHandler(i)})},expressHandler:function(t){var e=this;this.$fxApi("centerCheckBill4cld.checkMulity")({data:t}).then(function(t){e.orderEditFlag=!e.orderEditFlag,e.refreshOrderList().then(function(){e.$fxToast.success(t.message)})})},onSelectAllClick:function(t){var e=this;this.$fxCommon.orderListOnSelectAll(this.orderList,function(t){return!e.$fxStateMiddleware.stateIs("stateCld")("checked")(t.billStateFlag)},!t)},restFilterParams:function(){this.filterParams={},this.filterStateAndRestate=this.$fxStateMiddleware.getStateVal("stateAndRecheckSingleCld")("all"),this.filterSortingState=null,this.orderEditFlag=!1}}},B=L,F=Object(C["a"])(B,s,n,!1,null,null,null);e["default"]=F.exports},c644:function(t,e,i){},d444:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"add-item-class-content fx-vant-class-collapse"},[i("div",{staticClass:"all-class",class:{"is-active":""===t.value},on:{click:function(e){return e.stopPropagation(),t.selectClass("")}}},[t._v(t._s(t.classTitle))]),i("van-collapse",{attrs:{accordion:!0},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.itemClassList,function(e){return i("van-collapse-item",{key:e.id,attrs:{name:e.id}},[i("div",{staticClass:"big-class",attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))]),t._l(e.smallType,function(e){return i("van-cell",{key:e.id,staticClass:"small-class",class:{"is-active":t.value===e.id},attrs:{title:e.name},on:{click:function(i){return i.stopPropagation(),t.selectClass(e.id)}}})})],2)}),1)],1)},n=[],a=(i("c5f6"),{name:"addItemClassList",props:{value:[String,Number],itemClassList:{type:Array,default:function(){return[]}},classTitle:{type:String,default:"全部品项"}},data:function(){return{activeNames:[]}},methods:{selectClass:function(t){this.$emit("input",t),this.$emit("on-select-class",t),this.$emit("on-change-class",[t,this.value])}}}),o=a,c=(i("5402"),i("2877")),l=Object(c["a"])(o,s,n,!1,null,"df69e854",null);e["a"]=l.exports},dab9:function(t,e,i){"use strict";var s=i("a09d"),n=i.n(s);n.a},e27e:function(t,e,i){"use strict";var s=i("f18d"),n=i.n(s);n.a},e7ae:function(t,e,i){"use strict";var s=i("7290"),n=i.n(s);n.a},eb53:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",[i("w-header",{attrs:{title:"中心盘点单",border:!0}}),i("orderInfo",{ref:"orderInfo",attrs:{data:t.orderInfoData},on:{"on-rdc-click":t.onRdcClick,"on-house-click":t.onHouseClick,"on-checkType-click":t.onCheckTypeClick,"on-busdate-click":t.onBusinessDateClick,"on-notCheckType-click":t.onNotCheckTypeClick,"on-groupFlag-click":t.onGroupFlagClick,"on-costType-click":t.onCostTypeClick,"on-businessType-click":t.onBillTypeClick}}),i("w-bottom-btn-bar",[i("w-button",{attrs:{size:"large",type:"primary"},on:{click:t.onCreateClick}},[t._v("生成单据\n\t\t")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.rdcPopShow,expression:"rdcPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.rdcPopShow,callback:function(e){t.rdcPopShow=e},expression:"rdcPopShow"}},[i("listComp",{attrs:{visibleFlag:t.rdcPopShow,data:t.rdcList,loadFinished:!0,title:"请选择配送中心"},on:{"update:visibleFlag":function(e){t.rdcPopShow=e},"update:visible-flag":function(e){t.rdcPopShow=e},"on-search":t.searchRdc,"on-select":t.selectRdc}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.housePopShow,expression:"housePopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.housePopShow,callback:function(e){t.housePopShow=e},expression:"housePopShow"}},[i("listComp",{attrs:{visibleFlag:t.housePopShow,data:t.houseList,loadFinished:!0,title:"请选择盘点仓库"},on:{"update:visibleFlag":function(e){t.housePopShow=e},"update:visible-flag":function(e){t.housePopShow=e},"on-search":t.searchHouse,"on-select":t.selectHouse}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.checkTypePopShow,expression:"checkTypePopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.checkTypePopShow,callback:function(e){t.checkTypePopShow=e},expression:"checkTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.checkTypePopShow,data:t.checkTypeList,loadFinished:!0,title:"请选择盘点分类"},on:{"update:visibleFlag":function(e){t.checkTypePopShow=e},"update:visible-flag":function(e){t.checkTypePopShow=e},"on-search":t.searchCheckType,"on-select":t.selectCheckType}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.datePickerShow,expression:"datePickerShow"}],attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.billTypePopShow,expression:"billTypePopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.billTypePopShow,callback:function(e){t.billTypePopShow=e},expression:"billTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.billTypePopShow,data:t.billTypeList,loadFinished:!0,title:"单据类型检索"},on:{"update:visibleFlag":function(e){t.billTypePopShow=e},"update:visible-flag":function(e){t.billTypePopShow=e},"on-search":t.searchBillType,"on-select":t.selectBillType}})],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.notCheckTypeActionShow,expression:"notCheckTypeActionShow"}],ref:"notCheckTypeActionSheet",attrs:{actions:t.notCheckTypeList},model:{value:t.notCheckTypeActionShow,callback:function(e){t.notCheckTypeActionShow=e},expression:"notCheckTypeActionShow"}}),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.groupFlagActionShow,expression:"groupFlagActionShow"}],ref:"groupFlagActionSheet",attrs:{actions:t.groupFlagList},model:{value:t.groupFlagActionShow,callback:function(e){t.groupFlagActionShow=e},expression:"groupFlagActionShow"}}),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.costTypeActionShow,expression:"costTypeActionShow"}],ref:"costTypeActionSheet",attrs:{actions:t.costTypeList},model:{value:t.costTypeActionShow,callback:function(e){t.costTypeActionShow=e},expression:"costTypeActionShow"}})],1)},n=[],a=(i("a481"),i("795b")),o=i.n(a),c=(i("ac6a"),i("cebc")),l=i("2f62"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create-order-info fx-shadow-block"},[i("van-cell-group",[i("w-cell",{attrs:{title:"配送中心","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-rdc-click")}}},[t._v(t._s(t.data.rdcDTO&&t.data.rdcDTO.name))]),i("w-cell",{attrs:{title:"盘点仓库","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-house-click")}}},[t._v(t._s(t.data.houseDTO&&t.data.houseDTO.name))]),i("w-cell",{attrs:{title:"盘点分类","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-checkType-click")}}},[t._v(t._s(t.data.checkTypeDTO&&t.data.checkTypeDTO.name))]),i("w-cell",{attrs:{title:"业务日期","is-link":!t.isDisabled},on:{click:t.onBusDateClick}},[t._v(t._s(t.formatterDate(t.data.businessDate)))]),i("w-cell",{attrs:{title:"未盘品项","is-link":!t.isDisabled&&this.data.unCheckItemDoTypeEnable},on:{click:function(e){return t.onUncheckItemDoTypeEmitClick("on-notCheckType-click")}}},[t._v(t._s(t.unCheckItemDoTypeName))]),i("w-cell",{attrs:{title:"盘点方式","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-groupFlag-click")}}},[t._v(t._s(t.groupFlagName))]),i("w-cell",{attrs:{title:"成本类型","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-costType-click")}}},[t._v(t._s(t.costTypeName))]),i("w-cell",{attrs:{title:"业务类型","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-businessType-click")}}},[t._v(t._s(t.data.businessTypeDTO&&t.data.businessTypeDTO.name))])],1)],1)},d=[],h=(i("7f7f"),{name:"orderInfoAdd",components:{},props:{data:{type:Object,default:function(){return{}}},isDisabled:Boolean},computed:Object(c["a"])({},Object(l["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId}}),{formatterDate:function(t){var e=this;return function(t){return"number"===typeof t?e.$fxUtils.setDateTime(new Date(t),"时分"):t}},unCheckItemDoTypeName:function(){return this.data?this.$fxTypeMiddleware.getCommonTypeItemById("notCheckType")(this.data.unCheckItemDoType).name:""},groupFlagName:function(){return this.$fxTypeMiddleware.getCommonTypeItemById("checkWay")(this.data.groupFlag).name},costTypeName:function(){return this.$fxTypeMiddleware.getCommonTypeItemById("costType")(this.data.costType).name}}),methods:{onUncheckItemDoTypeEmitClick:function(t){if(this.isDisabled||!this.data.unCheckItemDoTypeEnable)return!1;this.$emit(t)},onEmitClick:function(t){if(this.isDisabled)return!1;this.$emit(t)},onBusDateClick:function(){this.onEmitClick("on-busdate-click")}}}),u=h,m=(i("0a97"),i("2877")),f=Object(m["a"])(u,r,d,!1,null,"2fa7d800",null),p=f.exports,k=i("f6bb"),v={name:"createUniformDistributionOut",components:{orderInfo:p,listComp:k["a"]},data:function(){return{query:this.$route.query,orderInfoData:{},currentDate:new Date,rdcPopShow:!1,rdcList:[],housePopShow:!1,houseList:[],checkTypePopShow:!1,checkTypeList:[],datePickerShow:!1,notCheckTypeActionShow:!1,notCheckTypeList:this.$fxTypeMiddleware.getCommonTypeList("notCheckType"),groupFlagActionShow:!1,groupFlagList:this.$fxTypeMiddleware.getCommonTypeList("checkWay"),costTypeActionShow:!1,costTypeList:this.$fxTypeMiddleware.getCommonTypeList("costType"),billTypePopShow:!1,billTypeList:[]}},computed:Object(c["a"])({},Object(l["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerShopName:function(t){return t.loginer.loginerShopName},loginerId:function(t){return t.loginer.loginerId},loginerName:function(t){return t.loginer.loginerName},centerCheck_defaultCurrentTime:function(t){return t.systemParamsCld.centerCheck_defaultCurrentTime},centerCheck_defaultCurrentDay:function(t){return t.systemParamsCld.centerCheck_defaultCurrentDay},centerCheck_unCheckDoWay:function(t){return t.systemParamsCld.centerCheck_unCheckDoWay}})),created:function(){this.getSystemParams().then(this.initDefaultOrderData)},methods:{getSystemParams:function(){var t=this;return this.$fxApi("centerCheckBill4cld.getSystemParams").then(function(e){var i={},s=e.baseDataVO;return s.forEach(function(t){i[t.key]=t.value}),t.$store.commit({type:"ADD_SYSTEM_PARAMS_CLD",state:{centerCheck_defaultCurrentTime:i.defaultCurrentTime,centerCheck_defaultCurrentDay:i.defaultCurrentDay,centerCheck_unCheckDoWay:i.unCheckDoWay,centerCheck_showAllCheckType:i.showAllCheckType,centerCheck_enableItemPack:i.enableItemPack}}),o.a.resolve(e)})},initDefaultOrderData:function(){var t=1,e=!1;switch(this.centerCheck_unCheckDoWay){case"0":t=1,e=!0;break;case"1":t=2,e=!0;break;case"2":t=1,e=!1;break;case"3":t=2,e=!1;break}var i="0"===this.centerCheck_defaultCurrentTime?"23:59:59":this.$fxUtils.getCurrentTime(),s="0"===this.centerCheck_defaultCurrentDay?this.$fxUtils.setDate(this.$fxUtils.getCustomDate(-1)):this.$fxUtils.setDate();this.orderInfoData={rdcDTO:{id:this.loginerShopId,name:this.loginerShopName},houseDTO:{},checkTypeDTO:{},busUser:{id:this.loginerId,name:this.loginerName},manualCode:"",businessDate:this.$fxUtils.newDate("".concat(s," ").concat(i)).getTime(),billMemo:"",unCheckItemDoType:t,unCheckItemDoTypeEnable:e,groupFlag:1,costType:null,businessTypeDTO:{id:"0430_0100_0100",name:"中心盘点单"},accountDTO:{},billState:0,details:[],updateIndicator:"Append",expressFlag:!1,freight:0}},onRdcClick:function(){var t=this;this.getRdcListData().then(function(e){t.rdcList=e.shops,t.rdcPopShow=!0})},searchRdc:function(t){var e=this;this.getRdcListData(t).then(function(t){e.rdcList=t.shops})},selectRdc:function(t){var e=this;this.checkRdc(t).then(function(){e.$dialog.confirm({title:"提示",message:"修改配送中心将清空盘点仓库，是否继续?"}).then(function(){e.orderInfoData.rdcDTO=t,e.orderInfoData.houseDTO={}})})},checkRdc:function(t){var e=this;return new o.a(function(i){var s=e.orderInfoData.rdcDTO;s.id!==t.id&&i()})},getRdcListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getRdcListData")({data:e})},onHouseClick:function(){var t=this;if(!this.orderInfoData.rdcDTO.id)return this.$fxToast.fail("请先选择配送中心!"),!1;this.getHouseListData().then(function(e){t.houseList=e.shops,t.housePopShow=!0})},searchHouse:function(t){var e=this;this.getHouseListData(t).then(function(t){e.houseList=t.shops})},selectHouse:function(t){this.orderInfoData.houseDTO=t},getHouseListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getStoreListData",this.orderInfoData.rdcDTO.id)({data:e})},onCheckTypeClick:function(){var t=this;this.getCheckTypeListData().then(function(e){t.checkTypeList=e.baseDataVO,t.checkTypePopShow=!0})},searchCheckType:function(t){var e=this;this.getCheckTypeListData(t).then(function(t){e.checkTypeList=t.baseDataVO})},selectCheckType:function(t){this.orderInfoData.checkTypeDTO=t},getCheckTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("centerCheckBill4cld.getCheckTypeList",this.orderInfoData.rdcDTO.id)({data:e})},onBusinessDateClick:function(){this.orderInfoData.businessDate&&(this.currentDate=new Date(this.orderInfoData.businessDate)),this.datePickerShow=!0},dateConfirmhandle:function(t){var e=t.getTime();this.orderInfoData.businessDate=e,this.datePickerShow=!1},onNotCheckTypeClick:function(){var t=this;this.$refs.notCheckTypeActionSheet.doSelect().then(function(e){t.orderInfoData.unCheckItemDoType=e.id})},onGroupFlagClick:function(){var t=this;this.$refs.groupFlagActionSheet.doSelect().then(function(e){t.orderInfoData.groupFlag=e.id})},onCostTypeClick:function(){var t=this;this.$refs.costTypeActionSheet.doSelect().then(function(e){t.orderInfoData.costType=e.id})},onBillTypeClick:function(){var t=this;this.getBillTypeListData().then(function(e){t.billTypeList=e.businessTypes,t.billTypePopShow=!0})},selectBillType:function(t){this.billType=t},searchBillType:function(t){var e=this;this.getBillTypeListData(t).then(function(t){e.billTypeList=t.businessTypes})},getBillTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={m:"list4CenterCheck",keyword:t};return this.$fxApi("common.getBusinessTypeListData")({data:e})},checkOrderInfo:function(){var t=this;return new o.a(function(e,i){t.orderInfoData.rdcDTO.id?t.orderInfoData.houseDTO.id?t.orderInfoData.checkTypeDTO.id?t.orderInfoData.businessDate?e():t.$fxToast.top("请先选择业务日期!"):t.$fxToast.top("请先选择盘点分类!"):t.$fxToast.top("请先选择盘点仓库!"):t.$fxToast.top("请先选择配送中心!")})},onCreateClick:function(){var t=this;this.checkOrderInfo().then(function(){t.$dialog.confirm({title:"提示",message:"确定生成单据吗?"}).then(function(){t.createHandler(t.orderInfoData)})})},createHandler:function(t){var e=this;this.$fxApi("centerCheckBill4cld.createOrder")({data:t}).then(function(t){e.$fxToast.success("生成单据成功").then(function(){e.$router.replace({path:"centerCheckBill4cldDetails",query:{orderId:t.storeBills[0].id}})})})}}},b=v,C=Object(m["a"])(b,s,n,!1,null,null,null);e["default"]=C.exports},eee7:function(t,e,i){},f18d:function(t,e,i){},f3c0:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRFMEVGQjYxREY1QzExRTk4NEQxQzk4RUQzQjYwMzQxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRFMEVGQjYyREY1QzExRTk4NEQxQzk4RUQzQjYwMzQxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEUwRUZCNUZERjVDMTFFOTg0RDFDOThFRDNCNjAzNDEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEUwRUZCNjBERjVDMTFFOTg0RDFDOThFRDNCNjAzNDEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5jgS7LAAAC50lEQVR42sSXy2tTQRTGzyS1KFgxYqkLQaWtAREXYiJpNUQLEaqCj/pAfBStuHHhRtC/wG4EX4hvKrpR3NWapq2KsZigreimBJtErSsfNYipSKh3/KYZ4zWZ3HtjEnrgy+ZOzm/mnJkzZxjnnKbDqsRP2xnNbByD1kIboWaoAXLIb0koBj2D7kNPIcPV3Dtmy4ANzAa1QyclTGV1UmJCx+UkTkFdkGbkuJAtgSLQdQOoyhrkfyLSR1FgH/QccpWQRpf04bUK9kNBaH4Z9pDw0Q9tMAM7Re6h6jJu4Grp01kIbIduQTUVOD2zpW+7CnygxJxayXl7LpjJI1M28y1jdHZ/3hY6IVlZsLfII2NoLcsZdaxjtGCu8qh59eDWckH9Kxgd9DGagWzejSgLWGu2ZMKalHUSQbFjapO/rEE3rWS0p4lRFaC3Bzl1v1SCPXpwo2rEkRZGNsDvhDmNpwwKOcZsXcVox2o2lcGuJ5wCrzkVuH+W6sEOZe2rY7S4FmdhJtHVR5ySE2rwdhejXR5Gk6jMN0OcggJaeJ4Os1pNlwY0+jBO5K7P5G3OrH+/izTsRmiF0kjHlYeceo2heQUkqfoY+0h0oU+jMcA9jYwOr2dUI+HViJVYZZub0fefRJcHOD0esXS3J/Xg0UKj4oCfD/6Fd2DlC+fRVD63IcTffojIcApFLTcUb/Q5DkNrCo18+4noXK9GR/02anYyWlSbgX+dyIR3KFFUFxPWr7jHbPS7z4Bj5QlMQkDFLr/YVzRU2AM9OCQ7B0Mb+wJYv0bhUU7XsMtfvS8aGpOtURYsPHRa+adY+ekeTi8S/9Ukdv5ph/THSfRIQxW8nYYlI+9aFIVxH5SqAFT43CsZyg4kCu2E0mWEpqXPqFnPFYC2lGnlKekrYLXLDMiOYbjEnLpUULNaLULjhg6JAlYEMC7/484Nb94TxsDE1r8hd6OobJvl3V2f84SJyydMNzRo9ILIXqXT9Wj7LcAAqr/RbQBzkgIAAAAASUVORK5CYII="},f6bb:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shop-popup"},[i("w-header",{attrs:{title:t.title,leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("van-pro-search",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"}],attrs:{shape:"round"},on:{search:t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),i("div",{staticClass:"popup-content"},[i("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"immediate-check":t.immediateCheck,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.data,function(e){return i("van-cell",{key:e.id,staticClass:"fx-van-cell",attrs:{title:e.name},on:{click:function(i){return t.indexListClick(e)}}})}),1)],1)],1)},n=[],a={name:"filterPop",props:{loading:Boolean,visibleFlag:Boolean,title:String,data:{type:Array,default:function(){return[]}},searchShow:{type:Boolean,default:!0},loadFinished:Boolean,immediateCheck:{type:Boolean,default:!0}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",listLoading:!1,listError:!1}},watch:{loading:{handler:function(t){t||(this.listLoading=!1)},immediate:!0},visibleFlag:function(t){t&&(this.searchKey="")}},methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},indexListClick:function(t){this.$emit("on-select",t),this.$emit("update:visibleFlag",!1)},search:function(t){this.$emit("on-search",t)},onLoad:function(){this.$emit("update:loading",!0),this.$emit("on-load",this.searchKey||null)}}},o=a,c=(i("8d5d"),i("2877")),l=Object(c["a"])(o,s,n,!1,null,"2a1c11fe",null);e["a"]=l.exports},ff4f:function(t,e,i){}}]);
//# sourceMappingURL=centerCheckBill4cld.fd1e51ca.js.map