(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["reportKc011"],{"074f":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("reportFormContainer",{ref:"reportForm",attrs:{reportFormConfig:t.reportFormConfig,reportPlans:t.reportPlans,getReportParams:t.getReportParams,filterPopShow:t.filterPopShow,showSearchBar:""},on:{"update:filterPopShow":function(e){t.filterPopShow=e},"update:filter-pop-show":function(e){t.filterPopShow=e}}},[o("filterPop",{attrs:{slot:"slot-filter",visibleFlag:t.filterPopShow,filterParams:t.filterParams},on:{"update:visibleFlag":function(e){t.filterPopShow=e},"update:visible-flag":function(e){t.filterPopShow=e},"update:filterParams":function(e){t.filterParams=e},"update:filter-params":function(e){t.filterParams=e},"on-confirm":t.filterConfirm},slot:"slot-filter"})],1)},i=[],n=(o("7f7f"),o("795b")),s=o.n(n),l=(o("96cf"),o("3b8d")),a=o("cebc"),h=o("2f62"),p=o("fe17"),c=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("filterPopComp",{on:{"on-close":t.onCloseClick,"on-confirm":t.onConfirmClick,"on-reset":t.onResetClick}},[o("van-cell-group",{attrs:{slot:"solt-filter-cell"},slot:"solt-filter-cell"},[o("van-cell",{attrs:{title:"业务日期"}}),o("van-cell",{attrs:{title:"起始时间",value:t.beginDate,"is-link":""},on:{click:t.onBeginDateClick}}),o("van-cell",{attrs:{title:"结束时间",value:t.endDate,"is-link":""},on:{click:t.endDateClick}}),o("filterCell",{attrs:{title:"门店区域",value:t.shopArea,showCloseBtn:!!t.shopAreaId},on:{"on-click":function(e){return t.onFilterCellClick("shopAreaPopShow")},"on-clear":function(e){return t.onFilterCellClear(["shopArea","shop"])}}}),o("filterCell",{attrs:{title:"机构名称",value:t.shop,showCloseBtn:!!t.shopId},on:{"on-click":function(e){return t.onFilterCellClick("shopPopShow")},"on-clear":function(e){return t.onFilterCellClear("shop")}}}),o("filterCell",{attrs:{title:"仓库类型",value:t.storeType,showCloseBtn:!!t.storeTypeId},on:{"on-click":function(e){return t.onFilterCellClick("storeTypePopShow")},"on-clear":function(e){return t.onFilterCellClear(["storeType","store"])}}}),o("filterCell",{attrs:{title:"仓库名称",value:t.store,showCloseBtn:!!t.storeId},on:{"on-click":function(e){return t.onFilterCellClick("storePopShow")},"on-clear":function(e){return t.onFilterCellClear("store")}}}),o("filterCell",{attrs:{title:"品项大类",value:t.bigClass,showCloseBtn:!!t.bigClassId},on:{"on-click":function(e){return t.onFilterCellClick("bigClassPopShow")},"on-clear":function(e){return t.onFilterCellClear(["bigClass","smallClass","item"])}}}),o("filterCell",{attrs:{title:"品项小类",value:t.smallClass,showCloseBtn:!!t.smallClassId},on:{"on-click":function(e){return t.onFilterCellClick("smallClassPopShow")},"on-clear":function(e){return t.onFilterCellClear(["smallClass","item"])}}}),o("filterCell",{attrs:{title:"品项类型",value:t.itemType,showCloseBtn:!!t.itemTypeId},on:{"on-click":function(e){return t.onFilterCellClick("itemTypePopShow")},"on-clear":function(e){return t.onFilterCellClear(["itemType","item"])}}}),o("filterCell",{attrs:{title:"品项名称",value:t.item,showCloseBtn:!!t.itemId},on:{"on-click":function(e){return t.onFilterCellClick("itemPopShow")},"on-clear":function(e){return t.onFilterCellClear("item")}}}),o("filterCell",{attrs:{title:"储藏方式",value:t.goodsStore,showCloseBtn:!!t.goodsStoreId},on:{"on-click":function(e){return t.onFilterCellClick("goodsStorePopShow")},"on-clear":function(e){return t.onFilterCellClear(["goodsStore","item"])}}})],1),o("van-popup",{attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[o("datePicker",{attrs:{visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),o("filterListPopup",{attrs:{title:"门店区域检索",getDataApi:t.getShopAreaListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"shopArea")}},model:{value:t.shopAreaPopShow,callback:function(e){t.shopAreaPopShow=e},expression:"shopAreaPopShow"}}),o("filterListPopup",{attrs:{title:"机构名称检索",rollingLoad:!0,getDataApi:t.getShopListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"shop")}},model:{value:t.shopPopShow,callback:function(e){t.shopPopShow=e},expression:"shopPopShow"}}),o("filterListPopup",{attrs:{title:"仓库类型检索",rollingLoad:!0,getDataApi:t.getStoreTypeListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"storeType")}},model:{value:t.storeTypePopShow,callback:function(e){t.storeTypePopShow=e},expression:"storeTypePopShow"}}),o("filterListPopup",{attrs:{title:"仓库检索",rollingLoad:!0,getDataApi:t.getStoreListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"store")}},model:{value:t.storePopShow,callback:function(e){t.storePopShow=e},expression:"storePopShow"}}),o("filterListPopup",{attrs:{title:"品项大类检索",rollingLoad:!0,getDataApi:t.getBigClassListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"bigClass")}},model:{value:t.bigClassPopShow,callback:function(e){t.bigClassPopShow=e},expression:"bigClassPopShow"}}),o("filterListPopup",{attrs:{title:"品项小类检索",rollingLoad:!0,getDataApi:t.getSmallClassListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"smallClass")}},model:{value:t.smallClassPopShow,callback:function(e){t.smallClassPopShow=e},expression:"smallClassPopShow"}}),o("filterListPopup",{attrs:{title:"品项类别检索",rollingLoad:!0,getDataApi:t.getItemTypeListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"itemType")}},model:{value:t.itemTypePopShow,callback:function(e){t.itemTypePopShow=e},expression:"itemTypePopShow"}}),o("filterListPopup",{attrs:{title:"品项检索",rollingLoad:!0,getDataApi:t.getItemListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"item")}},model:{value:t.itemPopShow,callback:function(e){t.itemPopShow=e},expression:"itemPopShow"}}),o("filterListPopup",{attrs:{title:"储藏方式检索",rollingLoad:!0,getDataApi:t.getGoodsStoreWayListData},on:{"on-select":function(e){return t.onFilterSelect(arguments,"goodsStore")}},model:{value:t.goodsStorePopShow,callback:function(e){t.goodsStorePopShow=e},expression:"goodsStorePopShow"}})],1)},u=[],f=(o("ac6a"),o("768b")),d=o("cd56"),g=o("a343"),m=o("3a5e"),C=o("eb03"),S=["shopArea","shop","storeType","store","bigClass","smallClass","itemType","item","goodsStore"],P={name:"filterPop",components:{filterPopComp:d["a"],datePicker:g["a"],filterCell:m["a"],filterListPopup:C["a"]},props:{visibleFlag:Boolean,filterParams:{type:Object,default:function(){return{}}}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},dateType:"",currentDate:new Date,beginDate:this.$fxUtils.getCurrentMonthFirst(),endDate:this.$fxUtils.getCurrentMonthLast(),shopArea:"请选择",shopAreaId:"",shop:"请选择",shopId:"",storeType:"请选择",storeTypeId:"",store:"请选择",storeId:"",bigClass:"请选择",bigClassId:"",smallClass:"请选择",smallClassId:"",itemType:"请选择",itemTypeId:"",item:"请选择",itemId:"",goodsStore:"请选择",goodsStoreId:"",datePickerShow:!1,shopAreaPopShow:!1,shopPopShow:!1,storeTypePopShow:!1,storePopShow:!1,bigClassPopShow:!1,smallClassPopShow:!1,itemTypePopShow:!1,goodsStorePopShow:!1,itemPopShow:!1}},created:function(){this.initDefaultShop()},watch:{visibleFlag:{handler:function(t){t&&(this.$fxUtils.isEmptyObjSHW(this.filterParams)?this.resetHandler():this.setFilterParams())},immediate:!0}},computed:Object(a["a"])({},Object(h["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerShopName:function(t){return t.loginer.loginerShopName},loginerId:function(t){return t.loginer.loginerId},loginerOrganType:function(t){return t.loginer.loginerOrganType}}),{shopCellDisable:function(){return this.$fxStateMiddleware.stateIs("loginerOrganType")(["shop","center","area"])(this.loginerOrganType)}}),methods:{initDefaultShop:function(){this.shopId=this.filterParams.shopId,this.shop=this.filterParams.shop},getFilterParams:function(){return{beginDate:this.beginDate||this.$fxUtils.getCurrentMonthFirst(),endDate:this.endDate||this.$fxUtils.getCurrentMonthLast(),shopArea:this.shopArea,shopAreaId:this.shopAreaId,shop:this.shop,shopId:this.shopId,storeType:this.storeType,storeTypeId:this.storeTypeId,store:this.store,storeId:this.storeId,bigClass:this.bigClass,bigClassId:this.bigClassId,smallClass:this.smallClass,smallClassId:this.smallClassId,itemType:this.itemType,itemTypeId:this.itemTypeId,item:this.item,itemId:this.itemId,goodsStore:this.goodsStore,goodsStoreId:this.goodsStoreId}},onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onConfirmClick:function(){var t=this;this.confirmCheck().then(function(){t.$emit("update:visibleFlag",!1),t.$emit("update:filterParams",t.getFilterParams()),t.$emit("on-confirm",t.getFilterParams())})},onResetClick:function(){this.resetHandler()},resetHandler:function(){this.beginDate=this.$fxUtils.getCurrentMonthFirst(),this.endDate=this.$fxUtils.getCurrentMonthLast(),this.resetFilterCell(S),this.shopCellDisable&&(this.shop=this.loginerShopName,this.shopId=this.loginerShopId)},setFilterParams:function(){var t=this;S.forEach(function(e){t.filterParams[e]?(t[e]=t.filterParams[e],t["".concat(e,"Id")]=t.filterParams["".concat(e,"Id")]):t.resetFilterCell(e)})},confirmCheck:function(){var t=this;return new s.a(function(e){if(!t.shopId)return t.$fxToast.fail("请选择机构!"),!1;e()})},onBeginDateClick:function(){this.dateType="begin",this.beginDate&&(this.currentDate=new Date(this.beginDate)),this.datePickerShow=!0},endDateClick:function(){this.dateType="end",this.endDate&&(this.currentDate=new Date(this.endDate)),this.datePickerShow=!0},dateConfirmhandle:function(t){"begin"===this.dateType?(this.beginDate=this.$fxUtils.setDate(t),this.endDate&&this.$fxUtils.compareDateRange(this.beginDate,this.endDate,31)||(this.endDate=this.setDateRange(this.beginDate,31))):(this.endDate=this.$fxUtils.setDate(t),this.beginDate&&this.$fxUtils.compareDateRange(this.beginDate,this.endDate,31)||(this.beginDate=this.setDateRange(this.endDate,-31))),this.datePickerShow=!1},setDateRange:function(t,e){return this.$fxUtils.setDate(this.$fxUtils.getCustomAssignDate(t,e))},onFilterCellClick:function(t){this[t]=!0},onFilterCellClear:function(t){this.resetFilterCell(t)},onFilterSelect:function(t,e){var o=Object(f["a"])(t,1),r=o[0];this[e]=r.name,this["".concat(e,"Id")]=r.id,this.selectAfterHandler(e)},selectAfterHandler:function(t){switch(t){case"shopArea":this.resetFilterCell(["shop","store"]);break;case"shop":this.resetFilterCell("store");break;case"storeType":this.resetFilterCell("store");break;case"bigClass":this.resetFilterCell(["smallClass","item"]);break;case"smallClass":this.resetFilterCell("item");break;case"itemType":this.resetFilterCell("item");break}},resetFilterCell:function(t){var e=this,o=[].concat(t);o.forEach(function(t){e[t]="请选择",e["".concat(t,"Id")]=""})},getShopAreaListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("reportForm.getShopArea")(e)},getShopListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,shoparea:this.shopAreaId||null,start:e,size:o};return this.$fxApi("reportForm.getShop")(r)},getStoreTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,start:e,size:o};return this.$fxApi("reportForm.getStoreType")(r)},getStoreListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,shopName:this.shopId,houseType:this.storeTypeId,start:e,size:o};return this.$fxApi("reportForm.getStore")(r)},getBigClassListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,bigOrSmall:"1",start:e,size:o};return this.$fxApi("reportForm.getItemClass")(r)},getSmallClassListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,bigOrSmall:"2",goodsBigType:this.bigClassId,start:e,size:o};return this.$fxApi("reportForm.getItemClass")(r)},getItemListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,start:e,size:o,goodsBigType:this.bigClassId,goodsSmallType:this.smallClassId,goodsStyle:this.itemTypeId};return this.$fxApi("reportForm.getItem")(r)},getItemTypeListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,start:e,size:o};return this.$fxApi("reportForm.getItemType")(r)},getGoodsStoreWayListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,r={keyword:t,start:e,size:o};return this.$fxApi("reportForm.getGoodsStoreWay")(r)}}},w=P,b=o("2877"),k=Object(b["a"])(w,c,u,!1,null,null,null),D=k.exports,y="kc011",v={name:"report-kc011",components:{reportFormContainer:p["a"],filterPop:D},data:function(){var t=this.$fxCommon.getReportFormConfig(y);return{reportFormConfig:t,filterPopShow:!1,filterParams:{}}},mounted:function(){this.$refs.reportForm.init({reportPlan:this.reportPlans[0],getReportParams:this.getReportParams})},computed:Object(a["a"])({},Object(h["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerShopName:function(t){return t.loginer.loginerShopName},loginerOrganType:function(t){return t.loginer.loginerOrganType}}),Object(h["b"])(["reportPlansGetter"]),{reportPlans:function(){return this.reportPlansGetter(y)},shopCellDisable:function(){return this.$fxStateMiddleware.stateIs("loginerOrganType")(["shop","center","area"])(this.loginerOrganType)}}),methods:{filterConfirm:function(t){var e=this;this.getReportParams(t).then(function(t){e.$refs.reportForm.refreshReportForm(t)})},getReportParams:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,o=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:{},!this.$fxUtils.isEmptyObjSHW(e)){t.next=7;break}return t.next=4,this.getReportParamsDefault();case 4:t.t0=t.sent,t.next=8;break;case 7:t.t0={sWorkDate:e.beginDate?"".concat(e.beginDate," 00:00:00"):"",eWorkDate:e.beginDate?"".concat(e.endDate," 23:59:59"):"",shopAreaId:e.shopAreaId,shopId:e.shopId,houseTypeId:e.storeTypeId,houseId:e.storeId,goodBigTypeId:e.bigClassId,goodSmallTypeId:e.smallClassId,goodStyleId:e.itemTypeId,goodsId:e.itemId,goodStoreId:e.goodsStoreId,agg:{jyMoney:"sum",qcAmount:"sum",qcMoney:"sum",inAmount:"sum",inMoney:"sum",notCheckInAmount:"sum",outAmount:"sum",outMoney:"sum",notCheckOutAmount:"sum",jyAmount:"sum",notCheckJyAmount:"sum"}};case 8:return t.abrupt("return",t.t0);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getReportParamsDefault:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,o,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getDefaultShop();case 2:return e=t.sent,o=e.shop,r=e.shopId,this.setDefaultShop(o,r),t.abrupt("return",{sWorkDate:"".concat(this.$fxUtils.getCurrentMonthFirst()," 00:00:00"),eWorkDate:"".concat(this.$fxUtils.setDate()," 23:59:59"),shopId:r,agg:{jyMoney:"sum",qcAmount:"sum",qcMoney:"sum",inAmount:"sum",inMoney:"sum",notCheckInAmount:"sum",outAmount:"sum",outMoney:"sum",notCheckOutAmount:"sum",jyAmount:"sum",notCheckJyAmount:"sum"}});case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getDefaultShop:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.shopCellDisable){t.next=4;break}t.t0={shop:this.loginerShopName,shopId:this.loginerShopId},t.next=7;break;case 4:return t.next=6,this.getDefaultShopHandler();case 6:t.t0=t.sent;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setDefaultShop:function(t,e){this.filterParams.shop=t,this.filterParams.shopId=e},getDefaultShopHandler:function(){var t=this;return new s.a(function(e,o){t.getShopListData().then(function(r){if(r.length>0)e({shop:r[0].name,shopId:r[0].id});else{var i="当前没有可查询机构";t.$fxToast.fail(i),o(i)}})})},getShopListData:function(){var t={keyword:null,start:0,size:1};return this.$fxApi("reportForm.getShop")(t)}}},I=v,F=Object(b["a"])(I,r,i,!1,null,null,null);e["default"]=F.exports},a343:function(t,e,o){"use strict";var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("van-datetime-picker",t._g({attrs:{type:"date",formatter:t.dataPickerFormatter},on:{cancel:t.onCancelClick},model:{value:t.$attrs.currentDate,callback:function(e){t.$set(t.$attrs,"currentDate",e)},expression:"$attrs.currentDate"}},t.$listeners))},i=[],n={name:"datePicker",props:{visibleFlag:Boolean},methods:{dataPickerFormatter:function(t,e){return"".concat(e,"year"===t?"年":"month"===t?"月":"日")},onCancelClick:function(){this.$emit("update:visibleFlag",!1)}}},s=n,l=o("2877"),a=Object(l["a"])(s,r,i,!1,null,null,null);e["a"]=a.exports}}]);
//# sourceMappingURL=reportKc011.9555dd8e.js.map