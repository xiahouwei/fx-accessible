(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["stockInBill4cld"],{"0136":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",[i("w-header",{attrs:{title:t.orderInfoData.sysbillCode,titleFontSize:"3.733vw",border:!0}}),i("orderInfo",{ref:"orderInfo",attrs:{isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("stockInBill4cld.save")||t.isBillWeightState(["waitWeight","weighting"])||!t.isHandCreate,data:t.orderInfoData},on:{"on-rdc-click":t.onRdcClick,"on-supplier-click":t.onSupplierClick,"on-busdate-click":t.onBusinessDateClick,"on-account-click":t.onAccountClick,"on-item-clear":t.onItemClear}}),i("orderItem",{ref:"orderItem",attrs:{data:t.orderItemList,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("stockInBill4cld.save")||t.isBillWeightState(["waitWeight","weighting"]),itemInputFocusing:t.itemInputFocusing,showAddItemBtn:t.isHandCreate,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,supplierId:t.orderInfoData.supplierDTO&&t.orderInfoData.supplierDTO.id},on:{"update:itemInputFocusing":function(e){t.itemInputFocusing=e},"update:item-input-focusing":function(e){t.itemInputFocusing=e},"on-add-click":t.onAddClick,"on-search-click":t.onSearchClick,"on-item-edit":t.onItemEdit,"on-item-focus":t.onItemFocus}}),i("w-bottom-btn-bar",[i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("stockInBill4cld.del")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('stockInBill4cld.del') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onDeleteClick")}}},[t._v("删除")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.copy"),expression:"$fxAuth('stockInBill4cld.copy')"}],attrs:{size:"large",type:"primary"},on:{click:function(e){return t.onClickHandler("onCopyClick")}}},[t._v("复制")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState("unCheck")&&t.$fxAuth("stockInBill4cld.drawback")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillState('unCheck') && $fxAuth('stockInBill4cld.drawback') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onReturnClick")}}},[t._v("退回")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState("checked")&&t.$fxAuth("stockInBill4cld.unCheck")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillState('checked') && $fxAuth('stockInBill4cld.unCheck') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onUnExpressClick")}}},[t._v("反审")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillReState("rechecked")&&t.$fxAuth("stockInBill4cld.unReCheck")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillReState('rechecked') && $fxAuth('stockInBill4cld.unReCheck') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"danger"},on:{click:function(e){return t.onClickHandler("onUnExpressAgainClick")}}},[t._v("取消复审")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unCheck","unSubmit","returned"])&&t.$fxAuth("stockInBill4cld.check")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillState(['unCheck', 'unSubmit', 'returned']) && $fxAuth('stockInBill4cld.check') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"info"},on:{click:function(e){return t.onClickHandler("onExpressClick")}}},[t._v("审核")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("stockInBill4cld.submit")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('stockInBill4cld.submit') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"info"},on:{click:function(e){return t.onClickHandler("onSubmitClick")}}},[t._v("提交")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillState(["unSubmit","returned"])&&t.$fxAuth("stockInBill4cld.save")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillState(['unSubmit', 'returned']) && $fxAuth('stockInBill4cld.save') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"primary"},on:{click:function(e){return t.onClickHandler("onSaveClick")}}},[t._v("保存")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.isBillReState("unRecheck")&&t.isBillState("checked")&&t.$fxAuth("stockInBill4cld.reCheck")&&t.isBillWeightState(["unWeight","hasWeight"]),expression:"isBillReState('unRecheck') && isBillState('checked') && $fxAuth('stockInBill4cld.reCheck') && isBillWeightState(['unWeight', 'hasWeight'])"}],attrs:{size:"large",type:"info"},on:{click:function(e){return t.onClickHandler("onExpressAgainClick")}}},[t._v("复审")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.rdcPopShow,expression:"rdcPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.rdcPopShow,callback:function(e){t.rdcPopShow=e},expression:"rdcPopShow"}},[i("listComp",{attrs:{visibleFlag:t.rdcPopShow,data:t.rdcList,loadFinished:!0,title:"请选择配送中心"},on:{"update:visibleFlag":function(e){t.rdcPopShow=e},"update:visible-flag":function(e){t.rdcPopShow=e},"on-search":t.searchRdc,"on-select":t.selectRdc}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.supplierPopShow,expression:"supplierPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.supplierPopShow,callback:function(e){t.supplierPopShow=e},expression:"supplierPopShow"}},[i("listComp",{attrs:{visibleFlag:t.supplierPopShow,data:t.supplierList,loadFinished:!0,title:"请选择供货商"},on:{"update:visibleFlag":function(e){t.supplierPopShow=e},"update:visible-flag":function(e){t.supplierPopShow=e},"on-search":t.searchSupplier,"on-select":t.selectSupplier}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.datePickerShow,expression:"datePickerShow"}],attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.accountPopShow,expression:"accountPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.accountPopShow,callback:function(e){t.accountPopShow=e},expression:"accountPopShow"}},[i("listComp",{attrs:{visibleFlag:t.accountPopShow,data:t.accountList,loadFinished:!0,title:"请选择业务人"},on:{"update:visibleFlag":function(e){t.accountPopShow=e},"update:visible-flag":function(e){t.accountPopShow=e},"on-search":t.searchAccount,"on-select":t.selectAccount}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemStorePopShow,expression:"itemStorePopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemStorePopShow,callback:function(e){t.itemStorePopShow=e},expression:"itemStorePopShow"}},[i("storeItemComp",{attrs:{visibleFlag:t.itemStorePopShow,storeItemData:t.storeItem,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,supplierId:t.orderInfoData.supplierDTO&&t.orderInfoData.supplierDTO.id,businessDate:t.orderInfoData.businessDate},on:{"update:visibleFlag":function(e){t.itemStorePopShow=e},"update:visible-flag":function(e){t.itemStorePopShow=e},"on-save":t.onStoreItemSave,"on-select-store":t.onStoreItemSelect}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemPopShow,expression:"itemPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemPopShow,callback:function(e){t.itemPopShow=e},expression:"itemPopShow"}},[i("itemEditComp",{attrs:{visibleFlag:t.itemPopShow,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,supplierId:t.orderInfoData.supplierDTO&&t.orderInfoData.supplierDTO.id,inHouse:t.currentInHouseObj,businessDate:t.orderInfoData.businessDate,parentStoreItem:t.getStoreItem()},on:{"update:visibleFlag":function(e){t.itemPopShow=e},"update:visible-flag":function(e){t.itemPopShow=e},"on-confirm":t.onItemEditConfirm}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemRowEditPopShow,expression:"itemRowEditPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemRowEditPopShow,callback:function(e){t.itemRowEditPopShow=e},expression:"itemRowEditPopShow"}},[i("itemRowEditPop",{attrs:{visibleFlag:t.itemRowEditPopShow,itemData:t.itemEditRowData,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("stockInBill4cld.save")},on:{"update:visibleFlag":function(e){t.itemRowEditPopShow=e},"update:visible-flag":function(e){t.itemRowEditPopShow=e}}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemSearchPopShow,expression:"itemSearchPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemSearchPopShow,callback:function(e){t.itemSearchPopShow=e},expression:"itemSearchPopShow"}},[i("itemSearchPop",{attrs:{visibleFlag:t.itemSearchPopShow,data:t.searchItem,isDisabled:t.isBillState(["unCheck","checked"])||!t.$fxAuth("stockInBill4cld.save")},on:{"update:visibleFlag":function(e){t.itemSearchPopShow=e},"update:visible-flag":function(e){t.itemSearchPopShow=e},"on-search-confirm":t.onSearchConfirm}})],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.checkActionSheetShow,expression:"checkActionSheetShow"}],ref:"checkActionSheet",attrs:{actions:t.checkActions},model:{value:t.checkActionSheetShow,callback:function(e){t.checkActionSheetShow=e},expression:"checkActionSheetShow"}})],1)},s=[],o=i("5176"),a=i.n(o),r=(i("20d6"),i("768b")),l=(i("7514"),i("75fc")),c=(i("ac6a"),i("f499")),u=i.n(c),d=i("b6d0"),h=i.n(d),f=i("774e"),m=i.n(f),p=i("795b"),v=i.n(p),g=i("cebc"),b=i("2f62"),S=i("cc4d"),w=i("f93b"),k=i("f6bb"),I=i("36a9"),D=i("1e73"),x=i("91a14"),C=i("9a42"),A={name:"stockInBill4cldDetails",components:{orderInfo:S["a"],orderItem:w["a"],listComp:k["a"],storeItemComp:I["a"],itemRowEditPop:D["a"],itemSearchPop:x["a"],itemEditComp:C["a"]},data:function(){return{query:this.$route.query,orderInfoData:{},orderItemList:[],dateType:"business",currentDate:new Date,rdcPopShow:!1,rdcList:[],datePickerShow:!1,supplierPopShow:!1,supplierList:[],billTypePopShow:!1,billTypeList:[],itemStorePopShow:!1,storeItem:[],itemRowEditPopShow:!1,itemEditRowData:{},itemSearchPopShow:!1,searchItem:[],currentInHouseObj:{},itemPopShow:!1,accountList:[],accountPopShow:!1,itemInputFocusing:!1,checkActionSheetShow:!1,checkActions:[],fxOrderInfoVerification:this.$fxUtils.fxDataVerification(),fxOrderDetailsVerification:this.$fxUtils.fxDataVerification(),backAbsolute:!1}},created:function(){this.getBillOtherAuth().then(this.refreshOrderDetails)},beforeRouteLeave:function(t,e,i){var n=this;if(this.itemInputFocusing)return this.$router.go(1),!1;"/stockInBill4cld"===t.path&&this.isChange&&!this.backAbsolute?this.$dialog.confirm({title:"提示",message:"当前单据已修改<br/>是否保存单据?"}).then(function(){return n.$router.go(1),n.checkHasDetails().then(n.saveHandler).then(function(){n.backAbsolute=!0,n.$fxGo("BACK",n.$router)}),!1}).catch(function(){i()}):i()},computed:Object(g["a"])({},Object(b["c"])({sysPointSize:"sysPointSize",sysMoneyPointSize:"sysMoneyPointSize",loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId},stockIn_resetBusDate:function(t){return t.systemParamsCld.stockIn_resetBusDate}}),{isBillState:function(t){var e=this;return function(t){return e.$fxStateMiddleware.stateIs("stateCld")(t)(e.orderInfoData.billStateFlag)}},isBillReState:function(t){var e=this;return function(t){return e.$fxStateMiddleware.stateIs("reState")(t)(e.orderInfoData.billReState)}},isBillWeightState:function(t){var e=this;return function(t){return e.$fxStateMiddleware.stateIs("weightStateCld")(t)(e.orderInfoData.weightState)}},isHandCreate:function(){return 3===this.orderInfoData.createWay},isChange:function(){return!this.fxOrderInfoVerification.checkData(this.orderInfoData)||!this.fxOrderDetailsVerification.checkData(this.orderItemList)}}),methods:{getBillOtherAuth:function(){var t=this;return this.$fxApi("stockInBill4cld.getBillOtherAuth",this.query.orderId).then(function(e){return t.$store.commit("RESET_BILL_AUTH",e.functionMapData[0]),v.a.resolve(e)})},refreshOrderDetails:function(){return this.$fxApi("stockInBill4cld.getOrderDetails",this.query.orderId).then(this.initOrderDetails)},initOrderDetails:function(t){var e=this,i=t.storeBills[0];return this.orderInfoData=i,this.orderItemList=this.filterStoreItem(i.details),this.setDataUUID(this.orderItemList),this.$nextTick(function(){e.fxOrderInfoVerification.resetData(e.orderInfoData),e.fxOrderDetailsVerification.resetData(e.orderItemList)}),v.a.resolve()},filterStoreItem:function(t){var e=m()(new h.a(t.map(function(t){return t.inHouseDTO.id})));return e.map(function(e){var i=t.filter(function(t){return t.inHouseDTO.id===e}),n=JSON.parse(u()(i[0].inHouseDTO));return n.details=i,n})},setDataUUID:function(t){var e=this;t.forEach(function(t){t.uuid=e.$fxUtils.createUUID(),t.details.forEach(function(t){t.uuid=e.$fxUtils.createUUID()})})},clearItemConfirm:function(t){var e=this;return new v.a(function(i){var n=e.orderItemList.filter(function(t){return 0!==t.details.filter(function(t){return"del"!==t.changeType}).length});0===n.length?i():e.$dialog.confirm({title:"提示",message:t}).then(function(){e.onItemClear(),i()})})},onRdcClick:function(){this.$fxAuth("stockInBill4cld.changeOrgan")&&this.onRdcRefresh()},searchRdc:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onRdcRefresh(t)},selectRdc:function(t){var e=this;this.checkRdc(t).then(function(){e.clearItemConfirm("修改配送中心将清空发货仓库和单据明细，是否继续?").then(function(){e.orderInfoData.rdcDTO=t})})},checkRdc:function(t){var e=this;return new v.a(function(i){var n=e.orderInfoData.rdcDTO;n.id!==t.id&&i()})},onRdcRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getRdcListData(e).then(function(e){t.rdcList=e.shops,t.rdcPopShow=!0})},getRdcListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t,selAll:"on"};return this.$fxApi("common.getRdcListData")({data:e})},onSupplierClick:function(){this.$fxAuth("stockInBill4cld.modifySupplier")&&this.onSupplierRefresh()},searchSupplier:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onSupplierRefresh(t)},selectSupplier:function(t){var e=this;this.checkSupplier(t).then(function(){e.clearItemConfirm("修改供货商将清空发货仓库和单据明细，是否继续?").then(function(){e.orderInfoData.supplierDTO=t})})},checkSupplier:function(t){var e=this;return new v.a(function(i){var n=e.orderInfoData.supplierDTO;n.id!==t.id&&i()})},onSupplierRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getSupplierListData(e).then(function(e){t.supplierList=e.suppliers,t.supplierPopShow=!0})},getSupplierListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t,selAll:"on"};return this.$fxApi("common.getSupplierListData")({data:e})},onBusinessDateClick:function(){this.dateType="business",this.orderInfoData.businessDate&&(this.currentDate=new Date(this.orderInfoData.businessDate)),this.datePickerShow=!0},dateConfirmhandle:function(t){var e=t.getTime();"business"===this.dateType&&(this.orderInfoData.businessDate=e),this.datePickerShow=!1},onAccountClick:function(){var t=this;this.getAccountListData().then(function(e){t.accountList=e,t.accountPopShow=!0})},selectAccount:function(t){this.orderInfoData.busUser=t},searchAccount:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getAccountListData(e).then(function(e){t.accountList=e})},getAccountListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={searchText:t,rdcId:this.orderInfoData.rdcDTO?this.orderInfoData.rdcDTO.id:""};return this.$fxApi("stockInBill4cld.getAccountListData")({data:e})},getValidItem:function(){var t=[];return this.orderItemList.forEach(function(e){t.push.apply(t,Object(l["a"])(e.details))}),t.filter(function(t){return"del"!==t.changeType})},getItemLength:function(){return this.getValidItem().length},checkHasDetails:function(){var t=this;return new v.a(function(e){0===t.getItemLength()?t.onDeleteClick("当前单据没有明细,是否要删除该单据吗?"):e()})},onItemClear:function(){this.orderInfoData.details=[],this.orderItemList=this.orderInfoData.details},onItemEdit:function(t){this.itemEditRowData=t,this.itemRowEditPopShow=!0},onAddClick:function(){var t=this;this.checkOrderInfo().then(function(){t.storeItem=JSON.parse(u()(t.orderItemList)),t.itemStorePopShow=!0})},checkOrderInfo:function(){var t=this;return new v.a(function(e,i){t.orderInfoData.businessDate?t.orderInfoData.rdcDTO.id?t.orderInfoData.supplierDTO.id?e():t.$fxToast.top("请先选择供货商!"):t.$fxToast.top("请先选择配送中心!"):t.$toast.fail("请先选择业务日期!")})},onItemFocus:function(){this.$refs.orderInfo.closeCollapse()},onSearchClick:function(){this.itemSearchPopShow=!0,this.searchItem=JSON.parse(u()(this.orderItemList))},onSearchConfirm:function(t){this.orderItemList=t},onStoreItemSave:function(t){this.orderInfoData.details=t,this.orderItemList=this.orderInfoData.details},onStoreItemSelect:function(t){this.currentInHouseObj=t,this.itemPopShow=!0},getStoreItem:function(){var t=this;if(this.$fxUtils.isEmptyObjSHW(this.currentInHouseObj))return[];var e=this.orderItemList.find(function(e){return e.id===t.currentInHouseObj.id});return e?e.details:[]},onItemEditConfirm:function(t){var e=this,i=Object(r["a"])(t,2),n=i[0],s=i[1],o=this.orderItemList.find(function(t){return t.id===s.id});if(o)if(this.$fxAuth("stockInBill4cld.inputMultipleDetails")){var l=o.details.filter(function(t){var i=n.findIndex(function(i){return i.goodsDTO.id===t.goodsDTO.id&&i.unitDTO.id===t.unitDTO.id&&i.batchCode===t.batchCode&&e.$fxUtils.isDef(t.batchCode)});return!~i});o.details=n.concat(l)}else o.details=n;else{var c=a()({},s);c.details=n,this.orderItemList.push(c)}},onClickHandler:function(t){if(this.itemInputFocusing)return!1;this[t]()},onSaveClick:function(){this.$fxCommon.orderFrontFunc("save").then(this.checkHasDetails).then(this.saveHandler).then(this.refreshOrderDetails).then(this.$fxCommon.orderSuccess("save"))},saveHandler:function(){if(this.isBillState(["unSubmit","returned"])&&this.isChange){var t=this.getSaveParams();return this.$fxApi("stockInBill4cld.saveOrder",this.query.orderId)({data:t})}return v.a.resolve()},getSaveParams:function(){var t=[];this.orderItemList.forEach(function(e){t.push.apply(t,Object(l["a"])(e.details))});var e=t.filter(function(t){return"add"===t.changeType}),i=t.filter(function(t){return"del"===t.changeType}),n=t.filter(function(t){return"edit"===t.changeType}),s=a()({},this.orderInfoData,{detailAdd:e.length>0?e:null,detailDel:i.length>0?i:null,detailMdf:n.length>0?n:null,details:[],resetFlag:0===this.stockIn_resetBusDate});return s},onSubmitClick:function(){this.$fxCommon.orderFrontFunc("submit").then(this.checkHasDetails).then(this.saveHandler).then(this.onSubmitHandler).then(this.refreshOrderDetails).then(this.$fxCommon.orderSuccess("submit"))},onSubmitHandler:function(){return this.$fxApi("stockInBill4cld.submitOrder",this.query.orderId)},onReturnClick:function(){this.$fxCommon.orderFrontFunc("returned").then(this.onReturnHandler).then(this.refreshOrderDetails).then(this.$fxCommon.orderSuccess("returned"))},onReturnHandler:function(){return this.$fxApi("stockInBill4cld.returnOrder",this.query.orderId)},setOrderInfoHasNoticed:function(){this.orderInfoData.hasNoticed=!0},onDeleteClick:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"确定要删除该单据吗?";this.$dialog.confirm({title:"提示",message:e}).then(this.deleteOrderHandler).then(function(){t.$fxToast.success("删除成功").then(function(){t.backAbsolute=!0,t.$router.go(-1)})})},deleteOrderHandler:function(){var t=this.getSaveParams();return this.$fxApi("stockInBill4cld.deleteOrder",this.query.orderId)({data:t})},onExpressClick:function(){var t=this;0===this.stockIn_resetBusDate?this.$fxCommon.orderFrontFunc("check").then(this.checkHasDetails).then(this.saveHandler).then(this.expressHandler):(1===this.stockIn_resetBusDate?this.checkActions=[{id:1,name:"审核并重置业务日期"},{id:0,name:"审核但不重置业务日期"}]:2===this.stockIn_resetBusDate&&(this.checkActions=[{id:1,name:"审核并重置业务日期"}]),this.$refs.checkActionSheet.doSelect().then(function(e){t.$fxCommon.orderFrontFunc("check").then(t.checkHasDetails).then(t.saveHandler).then(function(){t.expressByBusinessDate(e.id)})}))},expressByBusinessDate:function(t){var e=this,i=this.getSaveParams();return this.$fxApi("stockInBill4cld.checkOrderByBusinessDate",this.query.orderId,t)({data:i}).then(function(t){e.refreshOrderDetails().then(function(){e.$fxToast.success(t.message)})}).catch(function(i){"1"===i.errorCode?e.refreshOrderDetails():"isToContinue"===i.errorCode&&(e.setOrderInfoHasNoticed(),e.expressByBusinessDate(t))})},expressHandler:function(){var t=this,e=this.getSaveParams();return this.$fxApi("stockInBill4cld.checkOrder",this.query.orderId)({data:e}).then(function(e){t.refreshOrderDetails().then(function(){t.$fxToast.success(e.message)})}).catch(function(e){"1"===e.errorCode?t.refreshOrderDetails():"isToContinue"===e.errorCode&&(t.setOrderInfoHasNoticed(),t.expressHandler())})},onUnExpressClick:function(){this.$fxCommon.orderFrontFunc("uncheck").then(this.unExpressHandler).then(this.refreshOrderDetails).then(this.$fxCommon.orderSuccess("uncheck"))},unExpressHandler:function(){var t=this.getSaveParams();return this.$fxApi("stockInBill4cld.uncheckOrder",this.query.orderId)({data:t})},onExpressAgainClick:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定要复审该单据吗?"}).then(this.checkAgainHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("复审成功")})},checkAgainHandler:function(){var t=this.getSaveParams();return this.$fxApi("stockInBill4cld.checkAgain",this.query.orderId)({data:t})},onUnExpressAgainClick:function(){var t=this;this.$dialog.confirm({title:"提示",message:"确定要取消复审该单据吗?"}).then(this.UnExpressAgainHandler).then(this.refreshOrderDetails).then(function(){t.$fxToast.success("取消复审成功")})},UnExpressAgainHandler:function(){var t=this.getSaveParams();return this.$fxApi("stockInBill4cld.unReCheck",this.query.orderId)({data:t})},onCopyClick:function(){var t=this;this.$fxCommon.orderFrontFunc("copy").then(this.checkHasDetails).then(this.copyHandler).then(function(e){t.query.orderId=e,t.refreshOrderDetails()}).then(this.$fxCommon.orderSuccess("copy"))},copyHandler:function(){var t=this.getSaveParams();return this.$fxApi("stockInBill4cld.copyOrder",this.query.orderId)({data:t})}}},y=A,P=i("2877"),L=Object(P["a"])(y,n,s,!1,null,null,null);e["default"]=L.exports},"01f7":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"details-content",staticClass:"item-details-content"},[i("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoadMore},model:{value:t.currentListLoading,callback:function(e){t.currentListLoading=e},expression:"currentListLoading"}},t._l(t.itemList,function(e,n){return i("div",{key:e.goodsDTO.id,ref:"details-row-"+n,refInFor:!0,staticClass:"item-detail"},[t._t("item-cell",null,{$item:e,$index:n})],2)}),0)],1)},s=[],o=i("795b"),a=i.n(o),r=(i("c5f6"),{name:"addItemList",props:{value:[String,Number],itemList:{type:Array,default:function(){return[]}},listLoading:Boolean,loadFinished:Boolean,listError:{type:Boolean,default:!1}},data:function(){return{currentListLoading:!1}},watch:{listLoading:{handler:function(t){this.currentListLoading=t},immediate:!0},currentListLoading:function(t){this.$emit("update:listLoading",t)}},computed:{comptedItemImgSrc:function(t){return function(t){return 0===t.length?"":t[0]}}},methods:{onLoadMore:function(){this.$emit("on-load-more")},onSelectLetter:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,i=this.$refs["details-row-".concat(t)];if(!i||0===i.length)return!1;var n=i[0].offsetTop,s=this.$refs["details-content"];this.$fxUtils.scrollTopW({offsetTop:n,$el:s,distance:e})},prev:function(t){var e=this;return new a.a(function(i){if(0===t)return!1;var n=t-1,s=e.itemList[n];e.onSelectLetter(n),i({data:s,index:n})})},next:function(t){var e=this;return new a.a(function(i){if(t===e.itemList.length-1)return!1;var n=t+1,s=e.itemList[n];e.onSelectLetter(n),i({data:s,index:n})})}}}),l=r,c=(i("2f8b"),i("2877")),u=Object(c["a"])(l,n,s,!1,null,"7690e6e7",null);e["a"]=u.exports},"08d9":function(t,e,i){},"0f38":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.visibleFlag,expression:"visibleFlag"}],staticClass:"order-checkbox",on:{click:t.onCheckboxClick},scopedSlots:t._u([{key:"icon",fn:function(e){return i("img",{staticClass:"checked-box-icon",attrs:{src:e.checked?t.checkedIcon.active:t.checkedIcon.normal}})}}]),model:{value:t.$attrs.checked,callback:function(e){t.$set(t.$attrs,"checked",e)},expression:"$attrs.checked"}})},s=[],o={name:"checkBox",props:{visibleFlag:{type:Boolean,default:!1}},data:function(){return{checkedIcon:{normal:i("41c0"),active:i("f3c0")}}},methods:{onCheckboxClick:function(){this.$emit("on-checkbox-click")}}},a=o,r=(i("dab9"),i("2877")),l=Object(r["a"])(a,n,s,!1,null,"4e0c8b3e",null);e["a"]=l.exports},"11d4":function(t,e,i){"use strict";var n=i("f944"),s=i.n(n);s.a},"154a":function(t,e,i){"use strict";var n=i("7925"),s=i.n(n);s.a},"1e73":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fx-item-row-edit",{attrs:{title:t.itemData.goodsDTO.name},on:{"on-back":t.onConfirmClick}},[i("van-cell-group",[i("w-cell",{attrs:{title:"申购数量"}},[t._v(t._s(t.itemData.parentAmount?t.itemData.parentAmount:0))]),i("van-pro-number-field",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{label:"非税单价","input-align":"right",min:"0",defaultValue:0,max:t.maxAmount,intLength:t.numberLength,pointSize:t.sysMoneyPointSize,disabled:t.isDisabled||!t.itemData.canChangePriceFlag},on:{change:t.onPriceChange},model:{value:t.itemData.price,callback:function(e){t.$set(t.itemData,"price",e)},expression:"itemData.price"}}),i("van-pro-number-field",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{label:"不含运费非税金额","input-align":"right",min:"0",defaultValue:0,max:t.maxAmount,intLength:t.numberLength,pointSize:t.sysMoneyPointSize,disabled:t.isDisabled||!t.itemData.canChangePriceFlag},on:{change:t.onInMoneyChange},model:{value:t.itemData.noTransMoney,callback:function(e){t.$set(t.itemData,"noTransMoney",e)},expression:"itemData.noTransMoney"}}),i("w-cell",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{title:"税率","is-link":!t.isDisabled,disabled:t.isDisabled||!t.itemData.canChangeTaxFlag},on:{click:t.onTaxClick}},[t._v(t._s(t.fomatterTaxes(t.itemData.tax)))]),i("van-pro-number-field",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{label:"含税单价","input-align":"right",min:"0",defaultValue:0,max:t.maxAmount,intLength:t.numberLength,pointSize:t.sysMoneyPointSize,disabled:t.isDisabled||!t.itemData.canChangePriceFlag},on:{change:t.onTaxPriceChange},model:{value:t.itemData.taxPrice,callback:function(e){t.$set(t.itemData,"taxPrice",e)},expression:"itemData.taxPrice"}}),i("van-pro-number-field",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{label:"不含运费含税金额","input-align":"right",min:"0",defaultValue:0,max:t.maxAmount,intLength:t.numberLength,pointSize:t.sysMoneyPointSize,disabled:t.isDisabled||!t.itemData.canChangePriceFlag},on:{change:t.onTaxInMoneyChange},model:{value:t.itemData.noTransInTaxesMoney,callback:function(e){t.$set(t.itemData,"noTransInTaxesMoney",e)},expression:"itemData.noTransInTaxesMoney"}}),i("w-cell",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{title:"非税金额"}},[t._v(t._s(t.itemData.inMoney))]),i("w-cell",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{title:"含税金额"}},[t._v(t._s(t.itemData.inMoneyWithTax))]),i("w-cell",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{title:"税额"}},[t._v(t._s(t.itemData.taxInMoney))]),i("w-cell",{attrs:{title:"订单数量"}},[t._v(t._s(t.itemData.inBusPlanAmount||0))]),i("w-cell",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{title:"订单单价"}},[t._v(t._s(t.itemData.inPlanPrice||0))]),i("w-cell",{attrs:{title:"品项编号"}},[t._v(t._s(t.itemData.goodsDTO.code))]),i("w-cell",{attrs:{title:"赠送"}},[i("w-switch",{attrs:{disabled:t.isDisabled,type:"normal"},on:{change:t.changeGiftFlag},model:{value:t.itemData.giftFlag,callback:function(e){t.$set(t.itemData,"giftFlag",e)},expression:"itemData.giftFlag"}})],1),i("w-cell",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],attrs:{title:"运费金额"}},[t._v(t._s(t.itemData.transMoney))]),i("van-pro-field",{ref:"memo",attrs:{placeholder:t.setPlaceholder("请输入备注"),disabled:t.isDisabled,label:"备注","input-align":"right"},on:{focus:function(e){return t.onFocus("memo")}},model:{value:t.itemData.memo,callback:function(e){t.$set(t.itemData,"memo",e)},expression:"itemData.memo"}})],1),t.isDisabled?t._e():i("w-button",{attrs:{slot:"bottom-btn",size:"large",type:"primary"},on:{click:t.onConfirmClick},slot:"bottom-btn"},[t._v("保存\n\t")]),i("taxesActionSheet",{attrs:{sync:!0},on:{"on-taxes-select":t.onTaxesSelect},model:{value:t.taxesActionShow,callback:function(e){t.taxesActionShow=e},expression:"taxesActionShow"}})],1)},s=[],o=i("cebc"),a=i("2f62"),r=i("f729"),l={name:"itemRowEdit",components:{taxesActionSheet:r["a"]},props:{visibleFlag:Boolean,itemData:{type:Object,default:function(){return{}}},isDisabled:Boolean},data:function(){return{taxesActionShow:!1}},computed:Object(o["a"])({},Object(a["c"])({sysMoneyPointSize:"sysMoneyPointSize",numberLength:"numberLength",maxAmount:"maxAmount"}),{fomatterTaxes:function(t){return function(t){return t?"".concat(t,"%"):"0%"}},setPlaceholder:function(t){var e=this;return function(t){return e.isDisabled?"":t}}}),methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onConfirmClick:function(){this.itemData.id&&(this.itemData.changeType="edit"),this.$emit("on-Confirm",this.itemData),this.$emit("update:visibleFlag",!1)},onFocus:function(t){this.$fxUtils.doScrollTop(this.$refs[t].$el)},changeGiftFlag:function(t){this.$fxCalculation("stockInBill4cld").giftChange(this.itemData)},onPriceChange:function(){this.$fxCalculation("stockInBill4cld").changePrice(this.itemData)},onInMoneyChange:function(){this.$fxCalculation("stockInBill4cld").changeMoney(this.itemData)},onTaxPriceChange:function(){this.$fxCalculation("stockInBill4cld").changePriceWithTax(this.itemData)},onTaxInMoneyChange:function(){this.$fxCalculation("stockInBill4cld").changeMoneyWithTax(this.itemData)},onTaxClick:function(){this.taxesActionShow=!0},onTaxesSelect:function(t){this.itemData.tax=this.$fxUtils.toFixedParseNumber(100*t.tax,2,!1),this.$fxCalculation("stockInBill4cld").changeTaxes(this.itemData),this.taxesActionShow=!1},onBatchCodeClear:function(){this.itemData.batchCode=""}}},c=l,u=(i("154a"),i("2877")),d=Object(u["a"])(c,n,s,!1,null,"2f6499c6",null);e["a"]=d.exports},"23c1c":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",[i("w-header",{attrs:{title:"新增中心采购入库单",border:!0}}),i("orderInfo",{ref:"orderInfo",attrs:{data:t.orderInfoData},on:{"on-rdc-click":t.onRdcClick,"on-supplier-click":t.onSupplierClick,"on-busdate-click":t.onBusinessDateClick,"on-account-click":t.onAccountClick,"on-item-clear":t.onItemClear}}),i("orderItem",{attrs:{data:t.orderItemList,itemInputFocusing:t.itemInputFocusing,showAddItemBtn:!0,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,supplierId:t.orderInfoData.supplierDTO&&t.orderInfoData.supplierDTO.id},on:{"update:itemInputFocusing":function(e){t.itemInputFocusing=e},"update:item-input-focusing":function(e){t.itemInputFocusing=e},"on-add-click":t.onAddClick,"on-search-click":t.onSearchClick,"on-item-edit":t.onItemEdit}}),i("w-bottom-btn-bar",[i("w-button",{attrs:{size:"large",type:"primary"},on:{click:t.onCreateClick}},[t._v("生成单据\n\t\t")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.rdcPopShow,expression:"rdcPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.rdcPopShow,callback:function(e){t.rdcPopShow=e},expression:"rdcPopShow"}},[i("listComp",{attrs:{visibleFlag:t.rdcPopShow,data:t.rdcList,loadFinished:!0,title:"请选择配送中心"},on:{"update:visibleFlag":function(e){t.rdcPopShow=e},"update:visible-flag":function(e){t.rdcPopShow=e},"on-search":t.searchRdc,"on-select":t.selectRdc}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.supplierPopShow,expression:"supplierPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.supplierPopShow,callback:function(e){t.supplierPopShow=e},expression:"supplierPopShow"}},[i("listComp",{attrs:{visibleFlag:t.supplierPopShow,data:t.supplierList,loadFinished:!0,title:"请选择供货商"},on:{"update:visibleFlag":function(e){t.supplierPopShow=e},"update:visible-flag":function(e){t.supplierPopShow=e},"on-search":t.searchSupplier,"on-select":t.selectSupplier}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.datePickerShow,expression:"datePickerShow"}],attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.accountPopShow,expression:"accountPopShow"}],staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.accountPopShow,callback:function(e){t.accountPopShow=e},expression:"accountPopShow"}},[i("listComp",{attrs:{visibleFlag:t.accountPopShow,data:t.accountList,loadFinished:!0,title:"请选择业务人"},on:{"update:visibleFlag":function(e){t.accountPopShow=e},"update:visible-flag":function(e){t.accountPopShow=e},"on-search":t.searchAccount,"on-select":t.selectAccount}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemStorePopShow,expression:"itemStorePopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemStorePopShow,callback:function(e){t.itemStorePopShow=e},expression:"itemStorePopShow"}},[i("storeItemComp",{attrs:{visibleFlag:t.itemStorePopShow,storeItemData:t.storeItem,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,supplierId:t.orderInfoData.supplierDTO&&t.orderInfoData.supplierDTO.id,businessDate:t.orderInfoData.businessDate},on:{"update:visibleFlag":function(e){t.itemStorePopShow=e},"update:visible-flag":function(e){t.itemStorePopShow=e},"on-save":t.onStoreItemSave,"on-select-store":t.onStoreItemSelect}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemPopShow,expression:"itemPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemPopShow,callback:function(e){t.itemPopShow=e},expression:"itemPopShow"}},[i("itemEditComp",{attrs:{visibleFlag:t.itemPopShow,rdcId:t.orderInfoData.rdcDTO&&t.orderInfoData.rdcDTO.id,supplierId:t.orderInfoData.supplierDTO&&t.orderInfoData.supplierDTO.id,inHouse:t.currentInHouseObj,businessDate:t.orderInfoData.businessDate,parentStoreItem:t.getStoreItem()},on:{"update:visibleFlag":function(e){t.itemPopShow=e},"update:visible-flag":function(e){t.itemPopShow=e},"on-confirm":t.onItemEditConfirm}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemRowEditPopShow,expression:"itemRowEditPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemRowEditPopShow,callback:function(e){t.itemRowEditPopShow=e},expression:"itemRowEditPopShow"}},[i("itemRowEditPop",{attrs:{visibleFlag:t.itemRowEditPopShow,itemData:t.itemEditRowData},on:{"update:visibleFlag":function(e){t.itemRowEditPopShow=e},"update:visible-flag":function(e){t.itemRowEditPopShow=e}}})],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemSearchPopShow,expression:"itemSearchPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemSearchPopShow,callback:function(e){t.itemSearchPopShow=e},expression:"itemSearchPopShow"}},[i("itemSearchPop",{attrs:{visibleFlag:t.itemSearchPopShow,data:t.searchItem},on:{"update:visibleFlag":function(e){t.itemSearchPopShow=e},"update:visible-flag":function(e){t.itemSearchPopShow=e},"on-search-confirm":t.onSearchConfirm}})],1)],1)},s=[],o=(i("20d6"),i("768b")),a=(i("7514"),i("5176")),r=i.n(a),l=i("75fc"),c=(i("ac6a"),i("a481"),i("f499")),u=i.n(c),d=i("795b"),h=i.n(d),f=i("cebc"),m=i("2f62"),p=i("cc4d"),v=i("f93b"),g=i("f6bb"),b=i("36a9"),S=i("1e73"),w=i("91a14"),k=i("9a42"),I={name:"createStockInBill4cld",components:{orderInfo:p["a"],orderItem:v["a"],listComp:g["a"],storeItemComp:b["a"],itemRowEditPop:S["a"],itemSearchPop:w["a"],itemEditComp:k["a"]},data:function(){return{query:this.$route.query,orderInfoData:{},orderItemList:[],dateType:"business",currentDate:new Date,rdcPopShow:!1,rdcList:[],datePickerShow:!1,supplierPopShow:!1,supplierList:[],billTypePopShow:!1,billTypeList:[],itemStorePopShow:!1,storeItem:[],itemRowEditPopShow:!1,itemEditRowData:{},itemSearchPopShow:!1,searchItem:[],currentInHouseObj:{},itemPopShow:!1,accountList:[],accountPopShow:!1,itemInputFocusing:!1,backAbsolute:!1}},computed:Object(f["a"])({},Object(m["c"])({sysPointSize:"sysPointSize",sysMoneyPointSize:"sysMoneyPointSize",loginerShopId:function(t){return t.loginer.loginerShopId},loginerShopName:function(t){return t.loginer.loginerShopName},loginerId:function(t){return t.loginer.loginerId},loginerUserName:function(t){return t.loginer.loginerUserName}})),created:function(){this.getBillOtherAuth().then(this.initDefaultOrderData)},beforeRouteLeave:function(t,e,i){var n=this;if(this.itemInputFocusing)return this.$router.go(1),!1;"/stockInBill4cld"!==t.path||0===this.orderItemList.length||this.backAbsolute?i():this.$dialog.confirm({title:"提示",message:"当前单据未生成<br/>是否生成单据?"}).then(function(){return n.$router.go(1),n.onCreateClick(),!1}).catch(function(){i()})},methods:{initDefaultOrderData:function(){this.orderInfoData={busUser:{id:this.loginerId,name:this.loginerUserName},billEmp:"",billMemo:"",billState:0,businessDate:(new Date).getTime(),businessTypeDTO:{id:"0430_0010_0100",name:"中心采购入库单"},rdcDTO:{id:this.loginerShopId,name:this.loginerShopName},supplierDTO:{},details:[],updateIndicator:"Append"}},getBillOtherAuth:function(){var t=this;return this.$fxApi("stockInBill4cld.getBillOtherAuth","0").then(function(e){return t.$store.commit({type:"EXTEND_AUTH",billAuth:e.functionMapData[0]}),h.a.resolve(e)})},clearItemConfirm:function(t){var e=this;return new h.a(function(i){var n=e.orderItemList.filter(function(t){var e=t.details.filter(function(t){return"del"!==t.changeType});return 0!==e.length});0===n.length?i():e.$dialog.confirm({title:"提示",message:t}).then(function(){e.onItemClear(),i()}).catch(function(){})})},onRdcClick:function(){this.onRdcRefresh()},searchRdc:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onRdcRefresh(t)},selectRdc:function(t){var e=this;this.checkRdc(t).then(function(){e.clearItemConfirm("修改配送中心将清空发货仓库和单据明细，是否继续?").then(function(){e.orderInfoData.rdcDTO=t})})},checkRdc:function(t){var e=this;return new h.a(function(i){var n=e.orderInfoData.rdcDTO;n.id!==t.id&&i()})},onRdcRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getRdcListData(e).then(function(e){t.rdcList=e.shops,t.rdcPopShow=!0})},getRdcListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t,selAll:"on"};return this.$fxApi("common.getRdcListData")({data:e})},onSupplierClick:function(){this.onSupplierRefresh()},searchSupplier:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onSupplierRefresh(t)},selectSupplier:function(t){var e=this;this.checkSupplier(t).then(function(){e.clearItemConfirm("修改供货商将清空发货仓库和单据明细，是否继续?").then(function(){e.orderInfoData.supplierDTO=t})})},checkSupplier:function(t){var e=this;return new h.a(function(i){var n=e.orderInfoData.supplierDTO;n.id!==t.id&&i()})},onSupplierRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getSupplierListData(e).then(function(e){t.supplierList=e.suppliers,t.supplierPopShow=!0})},getSupplierListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t,selAll:"on"};return this.$fxApi("common.getSupplierListData")({data:e})},onBusinessDateClick:function(){this.dateType="business",this.orderInfoData.businessDate&&(this.currentDate=new Date(this.orderInfoData.businessDate)),this.datePickerShow=!0},dateConfirmhandle:function(t){var e=t.getTime();"business"===this.dateType&&(this.orderInfoData.businessDate=e),this.datePickerShow=!1},onAccountClick:function(){var t=this;this.getAccountListData().then(function(e){t.accountList=e,t.accountPopShow=!0})},selectAccount:function(t){this.orderInfoData.busUser=t},searchAccount:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getAccountListData(e).then(function(e){t.accountList=e})},getAccountListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={searchText:t,rdcId:this.orderInfoData.rdcDTO?this.orderInfoData.rdcDTO.id:""};return this.$fxApi("stockInBill4cld.getAccountListData")({data:e})},onAddClick:function(){var t=this;this.checkOrderInfo().then(function(){t.storeItem=JSON.parse(u()(t.orderItemList)),t.itemStorePopShow=!0})},checkOrderInfo:function(){var t=this;return new h.a(function(e,i){t.orderInfoData.businessDate?t.orderInfoData.rdcDTO.id?t.orderInfoData.supplierDTO.id?e():t.$fxToast.top("请先选择供货商!"):t.$fxToast.top("请先选择配送中心!"):t.$fxToast.top("请先选择业务日期!")})},onSearchClick:function(){this.itemSearchPopShow=!0,this.searchItem=JSON.parse(u()(this.orderItemList))},onSearchConfirm:function(t){this.orderItemList=t},onStoreItemSave:function(t){this.orderInfoData.details=t,this.orderItemList=this.orderInfoData.details},verifyCreateBill:function(){var t=this;return new h.a(function(e){if(0===t.getValidItem().length)return t.onAddClick(),!1;e()})},onCreateClick:function(){var t=this;if(this.itemInputFocusing)return!1;this.verifyCreateBill().then(function(){t.$dialog.confirm({title:"提示",message:"确定生成单据吗?"}).then(function(){var e=t.getSaveParams();t.createHandler(e)})})},createHandler:function(t){var e=this;this.$fxApi("stockInBill4cld.createOrder")({data:t}).then(function(t){e.$fxToast.success("生成单据成功").then(function(){e.$router.replace({path:"stockInBill4cldDetails",query:{orderId:t.storeBills[0].id}})})})},getSaveParams:function(){var t=[];this.orderItemList.forEach(function(e){t.push.apply(t,Object(l["a"])(e.details))});var e=t.filter(function(t){return"add"===t.changeType});e.noTransMoney=e.inMoney,e.noTransInTaxesMoney=e.inMoneyWithTax;var i=r()({},this.orderInfoData,{detailAdd:e,accountDTO:{id:this.loginerId},houseDTO:JSON.parse(u()(e[0].inHouseDTO))});return i},getValidItem:function(){var t=[];return this.orderItemList.forEach(function(e){t.push.apply(t,Object(l["a"])(e.details))}),t},onItemClear:function(){this.orderInfoData.details=[],this.orderItemList=this.orderInfoData.details},onItemEdit:function(t){this.itemEditRowData=t,this.itemRowEditPopShow=!0},onStoreItemSelect:function(t){this.currentInHouseObj=t,this.itemPopShow=!0},getStoreItem:function(){var t=this;if(this.$fxUtils.isEmptyObjSHW(this.currentInHouseObj))return[];var e=this.orderItemList.find(function(e){return e.id===t.currentInHouseObj.id});return e?e.details:[]},onItemEditConfirm:function(t){var e=this,i=Object(o["a"])(t,2),n=i[0],s=i[1],a=this.orderItemList.find(function(t){return t.id===s.id});if(a)if(this.$fxAuth("stockInBill4cld.inputMultipleDetails")){var l=a.details.filter(function(t){var i=n.findIndex(function(i){return i.goodsDTO.id===t.goodsDTO.id&&i.unitDTO.id===t.unitDTO.id&&i.batchCode===t.batchCode&&e.$fxUtils.isDef(t.batchCode)});return!~i});a.details=n.concat(l)}else a.details=n;else{var c=r()({},s);c.details=n,this.orderItemList.push(c)}}}},D=I,x=i("2877"),C=Object(x["a"])(D,n,s,!1,null,null,null);e["default"]=C.exports},"2f8b":function(t,e,i){"use strict";var n=i("8c37"),s=i.n(n);s.a},3033:function(t,e,i){},"36a9":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",{staticClass:"store-item"},[i("w-header",{attrs:{title:"编辑中心采购入库单明细",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("div",{staticClass:"add-store-bar"},[i("van-button",{staticClass:"add-store-btn",attrs:{type:"primary",round:""},on:{click:function(e){return t.onHouseRefresh(null)}}},[t._v(t._s(t.currentInHouseObj.id?t.currentInHouseObj.name:"添加入库仓库"))])],1),i("div",{staticClass:"store-item-content"},[i("van-collapse",{attrs:{border:!1},model:{value:t.activeStoreNames,callback:function(e){t.activeStoreNames=e},expression:"activeStoreNames"}},t._l(t.currentStoreItemData,function(e,n){return i("van-collapse-item",{directives:[{name:"show",rawName:"v-show",value:t.storeShowComputed(e),expression:"storeShowComputed(storeItem)"}],key:e.id,staticClass:"store-row",attrs:{name:e.id}},[i("div",{staticClass:"item-store-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"item-store-name fx-ellipsis"},[t._v("入库仓库："+t._s(e.name))])]),i("div",{staticClass:"item-storn-btn"},[i("i",{staticClass:"edit-btn",on:{click:function(i){return t.editStoreItem(e)}}}),i("i",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.delDetail"),expression:"$fxAuth('stockInBill4cld.delDetail')"}],staticClass:"delete-btn",on:{click:function(i){return t.deleteStoreItem(e,n)}}})]),t._l(e.details,function(t){return i("div",{directives:[{name:"show",rawName:"v-show",value:"del"!==t.changeType,expression:"item.changeType !== 'del'"}],key:t.goodsUUid,staticClass:"item-row"},[i("itemInfoCell",{attrs:{itemData:t,isDisabled:!0,disabledWatchBtn:!0,showEditBtn:!1}})],1)})],2)}),1)],1),i("div",{staticClass:"store-item-bottom"},[i("van-button",{staticClass:"save-btn fx-no-radius",attrs:{type:"primary"},on:{click:t.onSaveClick}},[t._v("保存")])],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.storePopShow,callback:function(e){t.storePopShow=e},expression:"storePopShow"}},[i("listComp",{attrs:{visibleFlag:t.storePopShow,data:t.storeList,loadFinished:!0,title:"仓库检索"},on:{"update:visibleFlag":function(e){t.storePopShow=e},"update:visible-flag":function(e){t.storePopShow=e},"on-search":t.onHouseRefresh,"on-select":t.selectStore}})],1)],1)},s=[],o=(i("7f7f"),i("5176")),a=i.n(o),r=i("795b"),l=i.n(r),c=i("75fc"),u=(i("ac6a"),i("cebc")),d=i("2f62"),h=i("f6bb"),f=i("5546"),m={name:"storeItemComp",components:{listComp:h["a"],itemInfoCell:f["a"]},props:{visibleFlag:Boolean,rdcId:{type:String,default:""},storeItemData:{type:Array,default:function(){return[]}}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},storePopShow:!1,storeList:[],currentInHouseObj:{},currentStoreObj:{},currentStoreItemData:[],activeStoreNames:[]}},computed:Object(u["a"])({},Object(d["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId}}),{storeShowComputed:function(t){return function(t){var e=t.details.filter(function(t){return"del"!==t.changeType}).length;return e>0}},dataUUID:function(){var t=this;return this.data.forEach(function(e){e.uuid=t.$fxUtils.createUUID(),e.details.forEach(function(e){e.goodsUUid=t.$fxUtils.createUUID()})}),this.data}}),watch:{visibleFlag:{handler:function(t){if(t){console.log(this.storeItemData),this.resetHandler(),this.currentStoreItemData=this.storeItemData;var e=this.storeItemData.reduce(function(t,e){return t.push.apply(t,Object(c["a"])(e.details)),t},[]).filter(function(t){return"del"!==t.changeType});e.lengths>0&&(this.currentInHouseObj=e[e.lengths-1].outHouseDTO),this.openStoreItemList(this.currentStoreItemData)}},immediate:!0}},methods:{resetHandler:function(){this.currentInHouseObj={},this.currentStoreItemData=[]},onCloseClick:function(){this.$emit("update:visibleFlag",!1)},clearItemConfim:function(t){var e=this;return new l.a(function(i){var n=e.currentStoreItemData.filter(function(t){var e=t.details.filter(function(t){return"del"!==t.changeType});return 0!==e.length});0===n.length?i():e.$dialog.confirm({title:"提示",message:t}).then(function(){e.onItemClear(),i()}).catch(function(){})})},onHouseRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getHouseListData(e).then(function(e){t.storeList=e.shops,t.storePopShow=!0})},getHouseListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getStoreListData",this.rdcId)({data:e})},selectStore:function(t){this.currentInHouseObj=t,this.$emit("on-select-store",this.currentInHouseObj),this.$emit("update:visibleFlag",!1)},editStoreItem:function(t){this.currentInHouseObj=a()({},{code:t.code,id:t.id,name:t.name,pinYin:t.pinYin,updateIndicator:t.updateIndicator}),this.$emit("on-select-store",this.currentInHouseObj),this.$emit("update:visibleFlag",!1)},deleteStoreItem:function(t,e){var i=this;this.$dialog.confirm({title:"提示",message:"确定要删除当前仓库品项吗?"}).then(function(){var n=t.details.filter(function(t){return!!t.id});if(0===n.length)return i.currentStoreItemData.splice(e,1),!1;n.forEach(function(t){t.changeType="del"}),i.currentStoreItemData[e].details=n}).catch(function(){})},onSaveClick:function(){this.$emit("on-save",this.currentStoreItemData),this.$emit("update:visibleFlag",!1)},openStoreItemList:function(t){var e=this;t.forEach(function(t){var i=t.details.filter(function(t){return"del"!==t.changeType}).length;i>0&&e.activeStoreNames.push(t.id)})}}},p=m,v=(i("8281"),i("2877")),g=Object(v["a"])(p,n,s,!1,null,"3b2864d5",null);e["a"]=g.exports},"37dd":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"inteledi-changePassWord"},[i("w-header",{attrs:{title:"修改密码",border:!0}}),i("div",{staticClass:"changepwd-content"},[i("van-cell-group",[i("van-field",{attrs:{required:"",clearable:"",type:"password",label:"原密码",placeholder:"请输入原密码","error-message":t.errorMessage.oldPwd},model:{value:t.formData.oldPwd,callback:function(e){t.$set(t.formData,"oldPwd",e)},expression:"formData.oldPwd"}}),i("van-field",{attrs:{required:"",clearable:"",type:"password",label:"新密码","error-message":t.errorMessage.newPwd,placeholder:"请输入新密码"},model:{value:t.formData.newPwd,callback:function(e){t.$set(t.formData,"newPwd",e)},expression:"formData.newPwd"}}),i("van-field",{attrs:{required:"",clearable:"",type:"password",label:"密码确认","error-message":t.errorMessage.newPwdAffirm,placeholder:"请确认新密码"},model:{value:t.formData.newPwdAffirm,callback:function(e){t.$set(t.formData,"newPwdAffirm",e)},expression:"formData.newPwdAffirm"}})],1)],1),i("div",{staticClass:"changepwd-bottom"},[i("van-button",{staticClass:"add-btn fx-no-radius",attrs:{type:"primary"},on:{click:t.onClickConfirm}},[t._v("确认")])],1)],1)},s=[],o=i("795b"),a=i.n(o),r={name:"changePassWord",data:function(){return{validateFlag:!1,formData:{newPwd:"",oldPwd:"",newPwdAffirm:""},errorMessage:{newPwd:"",oldPwd:"",newPwdAffirm:""}}},methods:{onClickConfirm:function(){this.submitHanle()},validate:function(){var t=this;return new a.a(function(e){t.clearValidate();var i=!0;""===t.formData.oldPwd&&(t.errorMessage.oldPwd="请输入原密码",i=!1),t.formData.oldPwd.length>50&&(t.errorMessage.oldPwd="密码长度超过50个字符",i=!1),""===t.formData.newPwd&&(t.errorMessage.newPwd="请输入新密码",i=!1),t.formData.newPwd===t.formData.oldPwd&&(t.errorMessage.newPwd="原密码与新密码不能相同",i=!1),t.formData.newPwd.length>50&&(t.errorMessage.newPwd="密码长度超过50个字符",i=!1),""===t.formData.newPwdAffirm&&(t.errorMessage.newPwdAffirm="请确认密码",i=!1),t.formData.newPwdAffirm.length>50&&(t.errorMessage.newPwdAffirm="密码长度超过50个字符",i=!1),t.formData.newPwdAffirm!==t.formData.newPwd&&(t.errorMessage.newPwdAffirm="两次录入新密码不一致",i=!1),e(i)})},submitHanle:function(){var t=this;this.validate().then(function(e){e&&t.PutPassword().then(function(e){t.$dialog.alert({title:"提示",message:e.message}).then(function(){t.$router.push("/main")})})})},PutPassword:function(){var t={password:this.formData.oldPwd,newPassword:this.formData.newPwd};return this.$fxApi("common.changePassword")({data:t})},clearValidate:function(){for(var t in this.errorMessage)this.errorMessage[t]=""}}},l=r,c=(i("5688"),i("2877")),u=Object(c["a"])(l,n,s,!1,null,"09397a4b",null);e["default"]=u.exports},"37e9":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",[i("fx-order-list-header",{attrs:{title:"中心采购入库单",showCheckBtn:t.$fxAuth("stockInBill4cld.check"),checkBtnActive:t.orderEditFlag,showSearchBtn:!t.orderEditFlag,showSelectAllBtn:t.orderEditFlag,selectAllBtnActive:t.isSelectAll},on:{"on-check-click":t.onOrderEditClick,"on-search-click":t.onSearchClick,"on-selectAll-click":t.onSelectAllClick}}),i("fx-filter-tab",{attrs:{leftTabState:t.filterStateAndRestate,rightTabState:t.filterWeightState,leftTabType:"checkAndRecheckStateCld",rightTabType:"weightStateCld"},on:{"on-left-tab-select":t.onStateSelect,"on-right-tab-select":t.onWeightStateSelect}}),i("fx-order-list-container",{attrs:{data:t.orderList,loadFinished:t.loadFinished},on:{"on-refresh":t.onPullRefresh,"on-loadMore":t.onLoadMore},model:{value:t.pullRefreshLoading,callback:function(e){t.pullRefreshLoading=e},expression:"pullRefreshLoading"}},t._l(t.orderList,function(e){return i("orderBlock",{directives:[{name:"show",rawName:"v-show",value:t.computedShowOrder(e.billStateFlag),expression:"computedShowOrder(item.billStateFlag)"}],key:e.id,attrs:{data:e,showCheckBox:t.orderEditFlag},on:{"on-click":function(i){return t.onClickOrder(e)}}})}),1),i("w-bottom-btn-bar",[i("w-button",{directives:[{name:"show",rawName:"v-show",value:!t.orderEditFlag&&t.$fxAuth("stockInBill4cld.add"),expression:"!orderEditFlag && $fxAuth('stockInBill4cld.add')"}],attrs:{size:"large",type:"primary"},on:{click:t.onCreateClick}},[t._v("\n\t\t\t添加单据\n\t\t")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:t.orderEditFlag&&t.$fxAuth("stockInBill4cld.check"),expression:"orderEditFlag && $fxAuth('stockInBill4cld.check')"}],attrs:{size:"large",type:"primary"},on:{click:t.onExpressClick}},[t._v("\n\t\t\t批量审核\n\t\t")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.filterPopShow,expression:"filterPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.filterPopShow,callback:function(e){t.filterPopShow=e},expression:"filterPopShow"}},[i("filterPop",{attrs:{visibleFlag:t.filterPopShow,filterParams:t.filterParams},on:{"update:visibleFlag":function(e){t.filterPopShow=e},"update:visible-flag":function(e){t.filterPopShow=e},"update:filterParams":function(e){t.filterParams=e},"update:filter-params":function(e){t.filterParams=e},"on-confirm":t.onFilterConfirm}})],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.checkActionSheetShow,expression:"checkActionSheetShow"}],ref:"checkActionSheet",attrs:{actions:t.checkActions},model:{value:t.checkActionSheetShow,callback:function(e){t.checkActionSheetShow=e},expression:"checkActionSheetShow"}})],1)},s=[],o=i("75fc"),a=i("5176"),r=i.n(a),l=i("795b"),c=i.n(l),u=i("cebc"),d=(i("6762"),i("2f62")),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-block fx-shadow-block",on:{click:t.onClick}},[i("checkBox",{attrs:{visibleFlag:t.showCheckBox,checked:t.data.checked},on:{"on-checkbox-click":t.onClick}}),i("div",{staticClass:"block-content"},[i("div",{staticClass:"block-title"},[i("i",{staticClass:"block-icon"}),i("span",{staticClass:"title-text"},[t._v(t._s(t.data.rdcDTO.name))]),i("fx-state-tag",{staticClass:"state-tag",attrs:{type:"stateCld",billState:t.data.billStateFlag,reCheckState:t.data.billReState}}),i("fx-state-tag",{staticClass:"weight-state-tag",attrs:{type:"weightStateCld",weightState:t.data.weightState}})],1),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[t._v(t._s(t.data.sysbillCode))])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[i("span",[t._v("供货商：")]),i("span",[t._v(t._s(t.data.supplierDTO.name))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockInBill4cld.canSeeMoney"),expression:"$fxAuth('stockInBill4cld.canSeeMoney')"}],staticClass:"order-date fx-price-font"},[i("span",[t._v("含税金额（含运费）：")]),i("span",[t._v("￥"+t._s(t.toFixedNumberSize(t.data.sumTaxInMoney)))])])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No"},[i("span",[t._v("明细数：")]),i("span",[t._v(t._s(t.data.detailCount))])]),i("div",{staticClass:"order-date"},[i("span",[t._v("业务日期：")]),i("span",[t._v(t._s(t._f("filterDateYMD")(t.data.businessDate)))])])])])],1)},f=[],m=i("59ad"),p=i.n(m),v=i("0f38"),g={name:"OrderBlock",components:{checkBox:v["a"]},props:{data:{type:Object,default:function(){return{}}},showCheckBox:{type:Boolean,default:!1}},computed:Object(u["a"])({},Object(d["c"])({sysMoneyPointSize:"sysMoneyPointSize"}),{toFixedNumberSize:function(t){var e=this;return function(t){return p()(e.$fxUtils.toFixedSHW(t,e.sysMoneyPointSize))}}}),methods:{onClick:function(){this.showCheckBox?this.$set(this.data,"checked",!this.data.checked):this.$emit("on-click",this.data)}}},b=g,S=(i("cbb0"),i("2877")),w=Object(S["a"])(b,h,f,!1,null,"50610246",null),k=w.exports,I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fx-order-list-filter",{on:{"on-back":t.onCloseClick}},[i("van-cell-group",[i("w-cell",{attrs:{title:"业务日期"}}),i("w-cell",{attrs:{title:"起始时间","is-link":""},on:{click:t.onBeginDateClick}},[t._v(t._s(t.beginDate))]),i("w-cell",{attrs:{title:"结束时间","is-link":""},on:{click:t.onEndDateClick}},[t._v(t._s(t.endDate))]),i("w-cell",{attrs:{title:"来源","is-link":""},on:{click:t.onSourceClick}},[t._v(t._s(t.source.name))]),i("w-cell",{attrs:{title:"配送中心","is-link":""},on:{click:t.onRdcClick}},[t._v(t._s(t.rdc.name))]),i("w-cell",{attrs:{title:"仓库","is-link":""},on:{click:t.onInHouseClick}},[t._v(t._s(t.inHouse.name))]),i("w-cell",{attrs:{title:"供货商","is-link":""},on:{click:t.onSupplierClick}},[t._v(t._s(t.supplier.name))]),i("w-cell",{attrs:{title:"品项","is-link":""},on:{click:t.onGoodsClick}},[t._v(t._s(t.goods.name))]),i("van-pro-field",{ref:"billNo",attrs:{label:"系统单号",placeholder:"请输入系统单号","input-align":"right"},on:{focus:function(e){return t.onFocus("billNo")}},model:{value:t.billNo,callback:function(e){t.billNo=e},expression:"billNo"}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{type:"date",visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmHandle}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.sourcePopShow,callback:function(e){t.sourcePopShow=e},expression:"sourcePopShow"}},[i("listComp",{attrs:{visibleFlag:t.sourcePopShow,data:t.sourceList,loadFinished:!0,title:"来源检索"},on:{"update:visibleFlag":function(e){t.sourcePopShow=e},"update:visible-flag":function(e){t.sourcePopShow=e},"on-select":t.selectSource,"on-search":t.searchSource}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.rdcPopShow,callback:function(e){t.rdcPopShow=e},expression:"rdcPopShow"}},[i("listComp",{attrs:{visibleFlag:t.rdcPopShow,data:t.rdcList,loadFinished:!0,title:"配送中心检索"},on:{"update:visibleFlag":function(e){t.rdcPopShow=e},"update:visible-flag":function(e){t.rdcPopShow=e},"on-select":t.selectRdcs,"on-search":t.searchRdcs}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.inHousePopShow,callback:function(e){t.inHousePopShow=e},expression:"inHousePopShow"}},[i("listComp",{attrs:{visibleFlag:t.inHousePopShow,data:t.inHouseList,title:"仓库检索",loadFinished:!0},on:{"update:visibleFlag":function(e){t.inHousePopShow=e},"update:visible-flag":function(e){t.inHousePopShow=e},"on-select":t.selectInHouse,"on-search":t.searchInHouse}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.supplierPopShow,callback:function(e){t.supplierPopShow=e},expression:"supplierPopShow"}},[i("listComp",{attrs:{visibleFlag:t.supplierPopShow,data:t.supplierList,title:"供货商检索",loadFinished:!0},on:{"update:visibleFlag":function(e){t.supplierPopShow=e},"update:visible-flag":function(e){t.supplierPopShow=e},"on-select":t.selectSupplier,"on-search":t.searchSupplier}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.shopPopShow,callback:function(e){t.shopPopShow=e},expression:"shopPopShow"}},[i("listComp",{attrs:{visibleFlag:t.shopPopShow,data:t.shopList,title:"门店检索",loadFinished:!0},on:{"update:visibleFlag":function(e){t.shopPopShow=e},"update:visible-flag":function(e){t.shopPopShow=e},"on-select":t.selectShop,"on-search":t.searchShop}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right"},model:{value:t.goodsPopShow,callback:function(e){t.goodsPopShow=e},expression:"goodsPopShow"}},[i("listComp",{attrs:{visibleFlag:t.goodsPopShow,data:t.goodsList,title:"品项检索",loading:t.goodsLoading,loadFinished:t.goodsLoadFinished},on:{"update:visibleFlag":function(e){t.goodsPopShow=e},"update:visible-flag":function(e){t.goodsPopShow=e},"update:loading":function(e){t.goodsLoading=e},"on-select":t.selectGoods,"on-search":t.searchGoods,"on-load":t.loadGoodsList}})],1),i("w-button",{attrs:{slot:"bottom-btn",size:"large",type:"info"},on:{click:t.onResetClick},slot:"bottom-btn"},[t._v("重置")]),i("w-button",{attrs:{slot:"bottom-btn",size:"large",type:"primary"},on:{click:t.onConfirmClick},slot:"bottom-btn"},[t._v("确定")])],1)},D=[],x=i("f6bb"),C=50,A={name:"FilterPop",components:{listComp:x["a"]},props:{visibleFlag:Boolean,filterParams:{type:Object,default:function(){return{}}}},data:function(){return{currentDate:new Date,datePickerShow:!1,beginDate:"",endDate:"",source:{name:"请选择"},sourceList:[],sourcePopShow:!1,rdc:{name:"请选择"},rdcList:[],rdcPopShow:!1,inHouse:{name:"请选择"},inHouseList:[],inHousePopShow:!1,supplier:{name:"请选择"},supplierList:[],supplierPopShow:!1,shop:{name:"请选择"},shopList:[],shopPopShow:!1,goods:{name:"请选择"},goodsListStart:0,goodsList:[],goodsLoading:!1,goodsLoadFinished:!1,goodsPopShow:!1,searchGoodsKeyword:"",billNo:""}},watch:{visibleFlag:{handler:function(t){t&&this.$fxUtils.isEmptyObjSHW(this.filterParams)&&this.resetHandler()},immediate:!0},businessDateStart:{immediate:!0,handler:function(t){this.beginDate=t}},businessDateEnd:{immediate:!0,handler:function(t){this.endDate=t}}},computed:Object(u["a"])({},Object(d["c"])({loginerShopId:function(t){return t.loginerId.loginerShopId},loginerId:function(t){return t.loginer.loginerId},businessDateStart:function(t){return t.systemParamsCld.businessDateStart},businessDateEnd:function(t){return t.systemParamsCld.businessDateEnd}})),methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onBeginDateClick:function(){this.datePickerShow=!0,this.beginDate&&(this.currentDate=new Date(this.beginDate)),this.dateType="begin"},onEndDateClick:function(){this.datePickerShow=!0,this.endDate&&(this.currentDate=new Date(this.endDate)),this.dateType="end"},dateConfirmHandle:function(t){"begin"===this.dateType?this.beginDate=this.$fxUtils.setDate(t):this.endDate=this.$fxUtils.setDate(t),this.datePickerShow=!1},onSourceClick:function(){var t=this;this.getSourceListData().then(function(e){t.sourceList=e.baseDataVO,t.sourcePopShow=!0})},selectSource:function(t){this.source=t},searchSource:function(t){var e=this;this.getSourceListData(t).then(function(t){e.sourceList=t.baseDataVO})},getSourceListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getSourceListData",t)({data:e})},onRdcClick:function(){var t=this;this.getRdcListData().then(function(e){t.rdcList=e.shops,t.rdcPopShow=!0})},selectRdcs:function(t){this.rdc=t},searchRdcs:function(t){var e=this;this.getRdcListData(t).then(function(t){e.rdcList=t.shops})},getRdcListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getRdcListData",t)({data:e})},onInHouseClick:function(){var t=this;if(!this.rdc.id)return this.$fxToast.fail("请先选择配送中心"),!1;this.getInHouseListData().then(function(e){t.inHouseList=e.shops,t.inHousePopShow=!0})},selectInHouse:function(t){this.inHouse=t},searchInHouse:function(t){var e=this;this.getInHouseListData(t).then(function(t){e.inHouseList=t.shops})},getInHouseListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getStoreListData",this.rdc.id)({data:e})},onSupplierClick:function(){var t=this;this.getSupplierListData().then(function(e){t.supplierList=e.suppliers,t.supplierPopShow=!0})},selectSupplier:function(t){this.supplier=t},searchSupplier:function(t){var e=this;this.getSupplierListData(t).then(function(t){e.supplierList=t.suppliers})},getSupplierListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={keyword:t};return this.$fxApi("common.getSupplierListData",t)({data:e})},onGoodsClick:function(){var t=this;this.goodsListStart=0,this.searchGoodsKeyword="",this.getGoodsListData().then(function(e){t.goodsList=e.goods,t.goodsLoading=!1,t.goodsPopShow=!0})},selectGoods:function(t){this.goods=t},searchGoods:function(t){var e=this;this.goodsListStart=0,this.searchGoodsKeyword="",this.getGoodsListData(t).then(function(t){t.goods.length<C&&(e.goodsLoadFinished=!0),e.goodsList=t.goods})},loadGoodsList:function(){var t=this;!0!==this.goodsLoadFinished&&(this.goodsListStart=this.goodsListStart+C,this.getGoodsListData(this.searchGoodsKeyword).then(function(e){var i;t.goodsLoading=!1,e.goods.length<C&&(t.goodsLoadFinished=!0),(i=t.goodsList).push.apply(i,Object(o["a"])(e.goods))}))},getGoodsListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={start:this.goodsListStart,size:C,paged:!0,keyword:t};return this.$fxApi("common.getGoodsListData")({data:e})},onResetClick:function(){this.resetHandler()},resetHandler:function(){this.beginDate=this.businessDateStart,this.endDate=this.businessDateEnd,this.source={name:"请选择"},this.rdc={name:"请选择"},this.inHouse={name:"请选择"},this.supplier={name:"请选择"},this.shop={name:"请选择"},this.goods={name:"请选择"},this.billNo=""},onConfirmClick:function(){if(new Date(this.endDate)<new Date(this.beginDate))return this.$fxToast.fail("开始日期不能大于结束日期!"),!1;this.$emit("update:visibleFlag",!1),this.$emit("update:filterParams",this.getFilterParams()),this.$emit("on-confirm",this.getFilterParams())},getFilterParams:function(){return{beginDate:this.beginDate,endDate:this.endDate,sourceId:this.source.id,rdcId:this.rdc.id,inHouseId:this.inHouse.id,shopId:this.shop.id,supplierId:this.supplier.id,goodsId:this.goods.id,billNo:this.billNo}},onFocus:function(t){this.onScrollTop(t)},onScrollTop:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=this.$refs[t];if(!i||0===i.length)return!1;var n=i.$el.offsetTop,s=this.$refs["filterContent"];this.$fxUtils.scrollTopW({offsetTop:n,$el:s,distance:e})}}},y=A,P=Object(S["a"])(y,I,D,!1,null,"33226040",null),L=P.exports,B=50,O={name:"stockInBill4cld",components:{orderBlock:k,filterPop:L},data:function(){return{routeParams:this.$route.params,orderList:[],filterPopShow:!1,filterStateAndRestate:"0",filterState:"0",filterBillReState:null,filterWeightState:null,listStart:0,pullRefreshLoading:!1,loadFinished:!0,orderEditFlag:!1,filterParams:{},checkActionSheetShow:!1,checkActions:[]}},beforeRouteEnter:function(t,e,i){var n=["/main/home","/"],s=["/stockInBill4cldDetails"];n.includes(e.path)?i(function(t){t.restFilterParams(),t.refreshOrderList()}):s.includes(e.path)?i(function(t){t.refreshOrderList()}):i()},computed:Object(u["a"])({},Object(d["c"])({billListPostParams:"billListPostParams",businessDateStart:function(t){return t.systemParams.businessDateStart},businessDateEnd:function(t){return t.systemParams.businessDateEnd}}),{computedShowOrder:function(t){var e=this;return function(t){return!e.orderEditFlag||!e.$fxStateMiddleware.stateIs("stateCld")("checked")(t)}},isSelectAll:function(){var t=this;return this.$fxCommon.orderListIsSelectAll(function(){return t.orderList.filter(function(e){return!t.$fxStateMiddleware.stateIs("stateCld")("checked")(e.billStateFlag)})})}}),methods:{orderListPostHandler:function(t){return this.$store.commit({type:"SETSTATE",billListPostParams:t}),this.$fxApi("stockInBill4cld.getOrderListData")({data:t})},refreshOrderList:function(){var t=this;return new c.a(function(e){t.listStart=0;var i={start:t.listStart,size:B,paged:!0,businessDateStart:t.businessDateStart,businessDateEnd:t.businessDateEnd,billStateFlag:t.filterState,reCheckState:t.filterBillReState,billWeightState:t.filterWeightState};i=r()(i,t.translateFilterParams(t.filterParams)),t.orderListPostHandler(i).then(function(i){t.orderList=i.storeBills,e(i)})})},onFilterConfirm:function(t){var e=this;this.listStart=0;var i={start:this.listStart,size:B,paged:!0,businessDateStart:t.beginDate,businessDateEnd:t.endDate,billStateFlag:this.filterState,reCheckState:this.filterBillReState,billWeightState:this.filterWeightState,sourceId:""===t.sourceId?null:t.sourceId,rdcId:""===t.rdcId?null:t.rdcId,inHouseId:""===t.inHouseId?null:t.inHouseId,supplierId:""===t.supplierId?null:t.supplierId,shopId:""===t.shopId?null:t.shopId,goodsId:""===t.goodsId?null:t.goodsId,sysBillCode:""===t.billNo?null:t.billNo};this.orderListPostHandler(i).then(function(t){e.orderList=t.storeBills})},translateFilterParams:function(t){return this.$fxUtils.isEmptyObjSHW(t)?{}:{businessDateStart:t.beginDate,businessDateEnd:t.endDate,rdcId:""===t.rdcId?null:t.rdcId,supplierId:""===t.supplierId?null:t.supplierId,shopId:""===t.shopId?null:t.shopId,inHouseId:""===t.inHouseId?null:t.inHouseId,goodsId:""===t.goodsId?null:t.goodsId,businessType:""===t.billTypeId?null:t.billTypeId,sysBillCode:""===t.billNo?null:t.billNo}},onPullRefresh:function(){var t=this;this.refreshOrderList().then(function(e){t.pullRefreshLoading=!1})},onLoadMore:function(){var t=this,e=r()(this.billListPostParams,{start:this.listStart});this.orderListPostHandler(e).then(function(e){var i;(i=t.orderList).push.apply(i,Object(o["a"])(e.storeBills))})},onSearchClick:function(){this.filterPopShow=!0},onStateSelect:function(t){this.filterStateAndRestate=t.id,this.filterState=t.state,this.filterBillReState=t.rescheck,this.refreshOrderList()},onWeightStateSelect:function(t){this.filterWeightState=t.id,this.refreshOrderList()},onClickOrder:function(t){this.$router.push({path:"stockInBill4cldDetails",query:{orderId:t.id}})},onCreateClick:function(){this.$router.push("createStockInBill4cld")},onOrderEditClick:function(t){this.orderEditFlag=!t},onExpressClick:function(){var t=this,e=this.orderList.reduce(function(t,e){var i=e.checked?t.concat(e.id):t;return i},[]);this.$fxCommon.orderFrontFunc("checkMulity",e).then(this.expressBillList).then(this.$fxApi("stockInBill4cld.checkMulity")).then(function(e){t.orderEditFlag=!t.orderEditFlag,t.refreshOrderList().then(function(){t.$fxToast.success(e.message)})}).catch(function(){t.refreshOrderList()})},onSelectAllClick:function(t){var e=this;this.$fxCommon.orderListOnSelectAll(this.orderList,function(t){return!e.$fxStateMiddleware.stateIs("stateCld")("checked")(t.billStateFlag)},!t)},restFilterParams:function(){this.filterParams={},this.filterStateAndRestate=this.$fxStateMiddleware.getStateVal("stateAndRecheckCld")("all"),this.filterState=this.$fxStateMiddleware.getStateVal("stateCld")("all"),this.filterBillReState=null,this.filterWeightState=null,this.orderEditFlag=!1}}},T=O,$=Object(S["a"])(T,n,s,!1,null,null,null);e["default"]=$.exports},"3e54":function(t,e,i){"use strict";var n=i("4619"),s=i.n(n);s.a},"41c0":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU5MzM3ODc2REY1QzExRTlBNjU4QkY2NDE0MTBEMjAzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU5MzM3ODc3REY1QzExRTlBNjU4QkY2NDE0MTBEMjAzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTkzMzc4NzRERjVDMTFFOUE2NThCRjY0MTQxMEQyMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTkzMzc4NzVERjVDMTFFOUE2NThCRjY0MTQxMEQyMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6ky6P/AAACeElEQVR42sSXTW8SURSGLwNhAZLQBAhb09K6Vxd+xpWJNboxqRub9meoP0D7M5roRl36lW6tsQvtvkobd4QASUkYWPDp+07OkENtYabD1ZO8cyHMvM+9d+695xAbjUbmf0QiyE3lcjmG5hZ0H7oBLUEL8vMxdAh9gz5Au6VSaeZoYtNGDKCDZhN6JrAgwU68hLbRgWFoMKAX0byBrnpTk0iYTCZjUqmUSSaTJh6PGz7b7/c9dTod47qu6fV6vsV36DHgvwODAb2D5h2UIzCXy3nQINFqtUyj0fA6g2hAjwD/MhMM6F0076FkOp02xWLROI4TauEMh0NTrVZNu93m1y70EPCdM8GArsgUZbLZrMnn85FWbr1eN81mkx9d6ArgP/3fHAWNo3lFKKc1KpRBD3lFF+gtjEkwYoMLie+0UCjMbb/Si56ySDcnwLJPuWW8hRT2nU4LetFT4qmwxiO+zX3qb5l5Bz1l1EvCGoNX/RtshfJe1eDrvPBwsBXK+5oGl3jhiWQrlPeyBnsHPo9BW6G8F05up38ajkptZjAYWAMp72MNLnuHardrDay8f2nwHi9MbbZCee9p8Ec/pdkK5f1Jg5kvD5lDbcDpKfmZ1cnuGCw10paXuZHEmU/nFfSip8SWXw7p7bQN/WDParXa3MD0ktHuC2MyLaInXO/rTNqcGibxqEEPeXUsBJ4I4698TPgBmjWuflYOlUrlXNPOZ/isVB/cR2viPbPYu4fmLSuHiMWeK9DPYcrbS2heQ5fPKm/9E4mHwynl7b5M70GUgv45tBhwpo+gF+cu6E/pwE3ogeTuxRN/YY7kLwzL4q/TgKHANuKPAAMAun8rS4SUYuAAAAAASUVORK5CYII="},4619:function(t,e,i){},"4ff5":function(t,e,i){},5402:function(t,e,i){"use strict";var n=i("73b7"),s=i.n(n);s.a},5546:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-info-cell"},[i("div",{staticClass:"item-img"},[i("w-img",{attrs:{src:t.itemData.goodsDTO.imageUrls}})],1),i("div",{staticClass:"item-details"},[i("div",{staticClass:"item-details-cell"},[i("div",{staticClass:"item-name fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.name))]),i("w-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled&&!t.disabledEditBtn,expression:"!isDisabled && !disabledEditBtn"}],staticClass:"block-item-edit",attrs:{type:"item-edit"},on:{click:t.onItemEditClick}}),i("w-icon",{directives:[{name:"show",rawName:"v-show",value:t.isDisabled&&t.showEditBtn,expression:"isDisabled && showEditBtn"}],staticClass:"block-item-edit",attrs:{type:"item-info"},on:{click:t.onItemEditClick}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.itemData.goodsDTO.spec,expression:"itemData.goodsDTO.spec"}],staticClass:"item-details-cell"},[i("span",[t._v("规格：")]),i("div",{staticClass:"item-spec fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.spec))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],staticClass:"item-details-cell"},[i("div",{staticClass:"item-amount"},[i("span",[t._v("数量：")]),i("w-stepper",{attrs:{min:"0",max:t.maxAmount,stepperBtnShow:!1,intLength:t.numberLength,pointSize:t.sysPointSize,inputWidth:"26vw"},on:{change:t.onChange,focus:t.onFocus,blur:t.onBlur},model:{value:t.itemData.busUnitInAmount,callback:function(e){t.$set(t.itemData,"busUnitInAmount",e)},expression:"itemData.busUnitInAmount"}})],1),i("div",{staticClass:"unit-text",on:{click:function(e){return e.stopPropagation(),t.onUnitClick(e)}}},[i("span",{staticClass:"fx-ellipsis"},[t._v(t._s(t.itemData.unitDTO.name))]),i("van-icon",{attrs:{name:"arrow-down"}})],1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isDisabled,expression:"isDisabled"}],staticClass:"item-details-cell"},[i("div",{staticClass:"item-amount"},[i("span",[t._v("数量：")]),i("span",[t._v(t._s(t.itemData.busUnitInAmount))])]),i("div",{staticClass:"unit-text"},[i("span",{staticClass:"fx-ellipsis"},[t._v(t._s(t.itemData.unitDTO.name))])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.itemData.assistUnit,expression:"itemData.assistUnit"}],staticClass:"item-details-cell"},[i("div",{staticClass:"item-amount"},[i("span",[t._v("辅助数量：")]),i("w-stepper",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],attrs:{min:"0",max:t.maxAmount,stepperBtnShow:!1,intLength:t.numberLength,pointSize:t.sysPointSize,inputWidth:"26vw"},on:{change:t.onChange,focus:t.onFocus,blur:t.onBlur},model:{value:t.itemData.inAssistAmount,callback:function(e){t.$set(t.itemData,"inAssistAmount",e)},expression:"itemData.inAssistAmount"}}),i("span",{directives:[{name:"show",rawName:"v-show",value:t.isDisabled,expression:"isDisabled"}]},[t._v(t._s(t.itemData.inAssistAmount))])],1),i("div",{staticClass:"unit-text"},[i("span",{staticClass:"fx-ellipsis"},[t._v(t._s(t.itemData.assistUnit))])])])])])},s=[],o=i("cebc"),a=i("2f62"),r={name:"itemInfoCell",props:{itemData:{type:Object,default:function(){return{}}},isDisabled:Boolean,disabledEditBtn:Boolean,showEditBtn:{type:Boolean,default:function(){return!0}}},computed:Object(o["a"])({},Object(a["c"])({sysPointSize:"sysPointSize",sysMoneyPointSize:"sysMoneyPointSize",numberLength:"numberLength",maxAmount:"maxAmount"})),data:function(){return{isHasGoods:!1}},methods:{onChange:function(t){this.amountChange(t)},editItem:function(){this.itemData.id&&this.$set(this.itemData,"changeType","edit")},amountChange:function(t){this.editItem()},onItemEditClick:function(){this.editItem(),this.$emit("on-item-edit",this.itemData)},onUnitClick:function(){if(this.isDisabled)return!1;this.editItem(),this.$emit("on-unit-edit",this.itemData)},onFocus:function(){this.$emit("on-item-focus")},onBlur:function(){0===this.itemData.busUnitInAmount&&(this.$fxToast.fail("数量不能为0!"),this.itemData.busUnitInAmount=1),this.itemData.goodsDTO.assistUnitFlag&&0===this.itemData.inAssistAmount&&(this.$fxToast.fail("辅助数量不能为0!"),this.itemData.inAssistAmount=1),this.$fxCalculation("stockInBill4cld").changeAmount(this.itemData),this.$emit("on-item-blur")}}},l=r,c=(i("80db"),i("2877")),u=Object(c["a"])(l,n,s,!1,null,"38716166",null);e["a"]=u.exports},5657:function(t,e,i){},5688:function(t,e,i){"use strict";var n=i("bb50"),s=i.n(n);s.a},6795:function(t,e,i){},"73b7":function(t,e,i){},7925:function(t,e,i){},"80db":function(t,e,i){"use strict";var n=i("4ff5"),s=i.n(n);s.a},8281:function(t,e,i){"use strict";var n=i("3033"),s=i.n(n);s.a},"8c37":function(t,e,i){},"8d5d":function(t,e,i){"use strict";var n=i("08d9"),s=i.n(n);s.a},"91a14":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",{staticClass:"item-search-block"},[i("w-header",{attrs:{title:"搜索品项",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("fx-search-bar",{attrs:{isSelectAll:t.isSelectAll,showSelectAllBtn:!t.isDisabled},on:{"on-select-click":t.onSelectAllClick},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),i("div",{ref:"details-content",staticClass:"item-list"},[i("van-collapse",{attrs:{border:!1},model:{value:t.activeStoreNames,callback:function(e){t.activeStoreNames=e},expression:"activeStoreNames"}},t._l(t.data,function(e){return i("van-collapse-item",{directives:[{name:"show",rawName:"v-show",value:t.storeShowComputed(e),expression:"storeShowComputed(storeItem)"}],key:e.id,staticClass:"store-row",attrs:{name:e.id}},[i("div",{staticClass:"item-store-title-container",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"item-store-title"},[i("span",{staticClass:"item-in-store-title fx-ellipsis"},[t._v("入库仓库："+t._s(e.name))])])]),t._l(t.detailFilter(e.details),function(n,s){return i("van-swipe-cell",{directives:[{name:"show",rawName:"v-show",value:"del"!==n.changeType,expression:"item.changeType !== 'del'"}],key:n.goodsDTO.id+"-"+s,ref:"details-row",refInFor:!0,staticClass:"item-row",attrs:{"right-width":80,disabled:t.isDisabled||t.focusing||!t.$fxAuth("stockInBill4cld.delDetail")}},[i("div",{staticClass:"item-cell"},[i("checkBox",{staticClass:"search-checkbox",attrs:{visibleFlag:!t.isDisabled,checked:n.checked},on:{"on-checkbox-click":function(e){return t.onCheckBoxClick(n)}}}),i("itemInfoCell",{staticClass:"search-info",attrs:{itemData:n,isDisabled:t.isDisabled,disabledEditBtn:t.focusing},on:{"on-item-edit":t.onSearchItemEdit,"on-unit-edit":t.onUnitEdit,"on-item-focus":t.onItemFocus,"on-item-blur":t.onItemBlur}})],1),i("div",{staticClass:"item-row-delete",attrs:{slot:"right"},on:{click:function(i){return t.onDeleteClick(n,s,e.details)}},slot:"right"},[t._v("删除")])])})],2)}),1)],1),i("w-bottom-btn-bar",[i("w-button",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],attrs:{size:"large",type:"primary"},on:{click:t.onSearchConfirm}},[t._v("保存")]),i("w-button",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],attrs:{size:"large",type:"danger"},on:{click:t.onSelectConfirm}},[t._v("删除")])],1),i("van-popup",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.itemRowEditPopShow,expression:"itemRowEditPopShow"}],staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.itemRowEditPopShow,callback:function(e){t.itemRowEditPopShow=e},expression:"itemRowEditPopShow"}},[i("itemRowEditPop",{attrs:{visibleFlag:t.itemRowEditPopShow,itemData:t.itemEditRowData,isDisabled:t.isDisabled},on:{"update:visibleFlag":function(e){t.itemRowEditPopShow=e},"update:visible-flag":function(e){t.itemRowEditPopShow=e}}})],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.unitActionShow,expression:"unitActionShow"}],ref:"unitActionSheet",attrs:{actions:t.unitActions},model:{value:t.unitActionShow,callback:function(e){t.unitActionShow=e},expression:"unitActionShow"}})],1)},s=[],o=(i("7514"),i("cebc")),a=(i("ac6a"),i("2f62")),r=i("5546"),l=i("1e73"),c=i("0f38"),u=["code","name","pinYin"],d={name:"itemSearchPop",components:{itemInfoCell:r["a"],itemRowEditPop:l["a"],checkBox:c["a"]},props:{data:{type:Array,default:function(){return[]}},isDisabled:Boolean,visibleFlag:Boolean},data:function(){return{query:this.$route.query,focusing:!1,leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",searchKeywords:u,itemRowEditPopShow:!1,itemEditRowData:{},unitActions:[],unitActionShow:!1,activeStoreNames:[]}},beforeDestroy:function(){this.$fxEventBus.$off("redCode",this.getItemByRedCode)},watch:{visibleFlag:{handler:function(t){var e=this;t?(this.searchKey="",this.data.forEach(function(t){var i=t.details.filter(function(t){return"del"!==t.changeType}).length;i>0&&e.activeStoreNames.push(t.id)})):this.$dialog.close()},immediate:!0}},computed:Object(o["a"])({},Object(a["c"])({sysPointSize:"sysPointSize"}),{isSelectAll:function(){var t=this,e=0,i=0;return this.data.forEach(function(n){var s=t.detailFilter(n.details);e+=s.filter(function(t){return"del"!==t.changeType&&t.checked}).length,i+=s.length}),0!==e&&e===i}}),methods:{storeShowComputed:function(t){return this.detailFilter(t.details).length>0},detailFilter:function(t){var e=this;return t.filter(function(t){return"del"!==t.changeType&&!!e.searchKeywords.find(function(i){return e.$fxUtils.fuzzyQueryString(t.goodsDTO[i],e.searchKey)})})},onCloseClick:function(){if(this.focusing)return!1;this.$emit("update:visibleFlag",!1)},onDeleteClick:function(t,e,i){t.id?this.$set(t,"changeType","del"):i.splice(e,1)},onItemFocus:function(){this.focusing=!0},onItemBlur:function(){this.focusing=!1},onSearchItemEdit:function(t){this.itemEditRowData=t,this.itemRowEditPopShow=!0},onUnitEdit:function(t){var e=this;this.$fxApi("common.getItemUnit",t.goodsDTO.id).then(function(i){e.unitActions=i.units,e.$refs.unitActionSheet.doSelect(t.unitDTO.id).then(function(i){e.$fxCalculation("stockInBill4cld").changeUnit(t,i)})})},onSearchConfirm:function(){if(this.focusing)return!1;this.data.forEach(function(t){t.details.forEach(function(t){delete t.checked})}),this.$emit("on-search-confirm",this.data),this.$emit("update:visibleFlag",!1)},onCheckBoxClick:function(t){if(this.focusing)return!1;this.$set(t,"checked",!t.checked)},onSelectAllClick:function(){var t=this,e=!this.isSelectAll;this.data.forEach(function(i){var n=t.detailFilter(i.details);n.forEach(function(i){"del"!==i.changeType&&t.$set(i,"checked",e)})})},onSelectConfirm:function(){var t=this,e=this.data.find(function(t){return t.details.find(function(t){return t.checked&&"del"!==t.changeType})});if(!e)return this.$fxToast.top("请先选择品项!"),!0;this.$dialog.confirm({title:"提示",message:"是否删除？"}).then(function(){t.data.forEach(function(e){for(var i=e.details,n=i.length-1;n>=0;n--){var s=i[n];s.checked&&(s.id?t.$set(s,"changeType","del"):e.details.splice(n,1))}})})},computedAssistAmount:function(t){t.assistUnitFlag&&(t.outAssistAmount=t.busUnitOutAmount)},setDataMoneyAndPrice:function(t){return t.forEach(function(t,e){t.goodsDTO={id:t.goodsId,imageUrls:t.goodsImgUrl?[t.goodsImgUrl]:[],name:t.goodsName,spec:t.goodsSpec,code:t.goodsCode,pinYin:t.goodsSign},t.unitDTO={id:t.unitId,name:t.unitName,value:t.unitValue},t.giftFlag=!1,t.price=t.salePrice,t.taxPrice=t.taxesPrice,t.outMoney=0,t.outMoneyWithTax=0,t.tax=t.taxes,t.taxOutMoney=0,t.costDispach=!1}),t},setChangeType:function(t){t.changeType=t.id?"edit":"add"}}},h=d,f=(i("a225"),i("2877")),m=Object(f["a"])(h,n,s,!1,null,"28ca7c42",null);e["a"]=m.exports},"9a42":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("w-app-page",{staticClass:"item-edit"},[i("w-header",{attrs:{title:"选择品项",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}},[i("van-icon",{staticClass:"header-confirm-btn",attrs:{slot:"header-right",name:"success"},on:{click:t.onItemConfirm},slot:"header-right"})],1),i("div",{staticClass:"item-search clearfix"},[i("van-search",{attrs:{placeholder:"请输入搜索关键词",shape:"round"},on:{search:t.search,focus:t.onSearchFocus},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1),i("div",{staticClass:"item-edit-content"},[i("addItemClassList",{attrs:{itemClassList:t.itemClassList},on:{"on-change-class":t.changeClass},model:{value:t.currentClass,callback:function(e){t.currentClass=e},expression:"currentClass"}}),i("addItemList",{ref:"addItemList",attrs:{listLoading:t.listLoading,loadFinished:t.loadFinished,itemList:t.itemList},on:{"update:listLoading":function(e){t.listLoading=e},"update:list-loading":function(e){t.listLoading=e},"on-load-more":t.onLoadMore},scopedSlots:t._u([{key:"item-cell",fn:function(e){return[i("addItemCell",{attrs:{itemData:e.$item,itemIndex:e.$index,rowActive:t.rowActive,itemAmoutName:"busUnitInAmount"},on:{"on-item-click":t.onItemEdit}})]}}]),model:{value:t.rowActive,callback:function(e){t.rowActive=e},expression:"rowActive"}})],1),i("fx-item-number-keyboard",{directives:[{name:"show",rawName:"v-show",value:t.numberKeyboardShow,expression:"numberKeyboardShow"}],attrs:{amountKey:"busUnitInAmount",data:t.currentSelectItem,unitEdit:!0,pointSize:t.sysPointSize,intLength:t.numberLength},on:{change:t.onKeyboardChange,pre:t.onKeyboardPre,next:t.onKeyboardNext,hide:t.onKeyboardHide,"on-unit-select":t.onUnitSelect}})],1)},s=[],o=i("59ad"),a=i.n(o),r=i("768b"),l=(i("20d6"),i("75fc")),c=(i("ac6a"),i("f499")),u=i.n(c),d=i("cebc"),h=(i("c5f6"),i("2f62")),f=i("d444"),m=i("01f7"),p=i("9c7f"),v=10,g={name:"itemEditComp",components:{addItemClassList:f["a"],addItemList:m["a"],addItemCell:p["a"]},props:{visibleFlag:Boolean,rdcId:{type:String,default:""},supplierId:{type:String,default:""},inHouse:{type:Object,default:function(){return{}}},businessDate:{type:[String,Number],default:""},parentStoreItem:{type:Array,default:function(){return[]}}},data:function(){return{query:this.$route.query,leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",currentClass:"",itemClassList:[],itemList:[],numberKeyboardShow:!1,rowActive:"",selectedItemArr:[],itemListStart:0,listLoading:!1,loadFinished:!0,listError:!1,isErrorActive:""}},computed:Object(d["a"])({},Object(h["c"])({sysPointSize:"sysPointSize",numberLength:"numberLength"}),{currentSelectItem:function(){return""===this.rowActive?{}:this.itemList[this.rowActive]}}),watch:{visibleFlag:{handler:function(t){t&&(this.$fxAuth("stockInBill4cld.inputMultipleDetails")?this.selectedItemArr=[]:this.selectedItemArr=JSON.parse(u()(this.parentStoreItem)),this.refresh())},immediate:!0},rowActive:function(t,e){""!==e?(this.numberStringAmount(e),this.pushSelectedItem(this.itemList[e]),""===t?this.numberKeyboardShow=!1:this.scrollToActive(t)):this.scrollToActive(t)}},methods:{refresh:function(){var t=this;this.searchKey="",this.getItemClass().then(function(e){t.itemClassList=e.goodsTypes,t.currentClass="",t.getItemByClass()})},onCloseClick:function(){this.rowActive="",this.$emit("update:visibleFlag",!1)},onItemConfirm:function(){var t=this;this.rowActive="",this.$nextTick(function(){t.selectedItemArr.forEach(function(e){e.inHouseDTO||(e.inHouseDTO=t.inHouse)}),t.$emit("on-confirm",[t.selectedItemArr,t.inHouse]),t.$emit("update:visibleFlag",!1)})},search:function(){this.getItemByClass()},getItemClass:function(){return this.$fxApi("common.getItemClass",this.supplierId)},getItem:function(){var t={start:this.itemListStart,size:v,paged:!0,goodsTypeId:this.currentClass||null,supplierId:this.supplierId,rdcId:this.rdcId,inHouseId:this.inHouse.id,workDate:this.businessDate,searchText:this.searchKey||""};return this.$fxApi("stockInBill4cld.getItemByClass",this.supplierId)({data:t})},getItemByClass:function(){var t=this;this.itemListStart=0,this.getItem().then(function(e){var i=t.setDataMoneyAndPrice(e);t.itemList=t.setResItem(i),t.setListLoading(i.length),t.$nextTick(function(){t.$refs.addItemList&&t.$refs.addItemList.onSelectLetter(0,5)})})},onLoadMore:function(){var t=this;this.getItem().then(function(e){var i,n=t.setDataMoneyAndPrice(e);(i=t.itemList).push.apply(i,Object(l["a"])(t.setResItem(n))),t.setListLoading(n.length)})},setDataMoneyAndPrice:function(t){return t.forEach(function(t){t.goodsDTO={id:t.goodsId,imageUrls:t.goodsImgUrl?[t.goodsImgUrl]:[],name:t.goodsName,spec:t.goodsSpec,code:t.goodsCode,pinYin:t.goodsSign},t.unitDTO={id:t.unitId,name:t.unitName,value:t.unitValue},t.price=t.busPrice,t.taxPrice=t.taxesPrice,t.inMoney=0,t.inMoneyWithTax=0,t.tax=t.taxes,t.taxInMoney=0}),t},setResItem:function(t){var e=this;return t.forEach(function(i,n){var s=e.selectedItemArr.findIndex(function(t){return i.goodsDTO.id===t.goodsDTO.id&&"del"!==t.changeType});~s?t[n]=e.$fxUtils.JSONcopy(e.selectedItemArr[s]):i.busUnitInAmount="0"}),t},setListLoading:function(t){this.listLoading=!1,this.itemListStart+=v,this.loadFinished=t<v},changeClass:function(t){var e=Object(r["a"])(t,2);e[0],e[1];this.searchKey="",this.onKeyboardHide(),this.getItemByClass()},onItemEdit:function(t){this.rowActive=t,this.numberKeyboardShow=!0},onKeyboardChange:function(t){this.itemList[this.rowActive].busUnitInAmount=t,this.computedAssistAmount(this.itemList[this.rowActive])},numberStringAmount:function(t){var e=this.itemList[t].busUnitInAmount;this.itemList[t].busUnitInAmount=a()(e)},pushSelectedItem:function(t){var e=this.selectedItemArr.findIndex(function(e){return t.goodsDTO.id===e.goodsDTO.id});~e?t.id||0!==t.busUnitInAmount?(t.id&&(0===t.busUnitInAmount?this.$fxAuth("stockInBill4cld.delDetail")?this.$fxCommon.delEditItem(this.selectedItemArr,t,e):(t.busUnitInAmount=1,this.$fxCommon.editItem(t),this.$fxToast({message:"当前没有删除品项权限",position:"top"})):this.$fxCommon.editItem(t)),this.$fxCommon.replaceItem(this.selectedItemArr,t,e),this.computedItemByAmount(t,e)):this.$fxCommon.delEditItem(this.selectedItemArr,t,e):t.busUnitInAmount>0&&(t.uuid=this.$fxUtils.createUUID(),this.$fxCommon.addEditItem(this.selectedItemArr,t),this.computedItemByAmount(this.selectedItemArr,this.selectedItemArr.length-1))},computedItemByAmount:function(t,e){this.$fxCalculation("stockInBill4cld").changeAmount(this.selectedItemArr[e])},onKeyboardPre:function(){if(!this.rowActive)return!1;this.rowActive--},onKeyboardNext:function(){if(""===this.rowActive||this.rowActive===this.itemList.length-1)return!1;this.rowActive++},onKeyboardHide:function(){this.rowActive=""},scrollToActive:function(t){var e=this;this.$nextTick(function(){e.$refs.addItemList.onSelectLetter(t,20)})},onSearchFocus:function(){this.rowActive=""},onUnitSelect:function(t,e){this.$fxCalculation("stockInBill4cld").changeUnit(this.itemList[this.rowActive],t)},computedAssistAmount:function(t){t.assistUnitFlag&&(t.inAssistAmount=t.busUnitInAmount)}}},b=g,S=(i("d975"),i("2877")),w=Object(S["a"])(b,n,s,!1,null,"0b3680fd",null);e["a"]=w.exports},"9c7f":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-detail-cell",class:{"is-active":t.rowActive===t.itemIndex,"is-error":t.isError},on:{click:t.onItemClick}},[i("div",{staticClass:"item-details-img"},[i("w-img",{attrs:{src:t.itemData.goodsDTO.imageUrls}})],1),i("div",{staticClass:"item-details-params"},[i("div",{staticClass:"item-details-name fx-ellipsis"},[t._v(t._s(t.itemData.goodsDTO.name))]),t.sysShowCode?i("div",{staticClass:"item-details-name fx-ellipsis"},[t._v("编号："+t._s(t.itemData.goodsDTO.code))]):t._e(),i("div",{staticClass:"item-details-spec fx-ellipsis"},[t._v("\n\t\t\t"+t._s(t.showBom?t.itemData.bomDTO.name:"")+"\n\t\t\t"+t._s(!t.showBom&&t.showSpec?t.itemData.goodsDTO.spec:"")+"\n\t\t")]),i("div",{staticClass:"item-details-amount"},[i("span",{staticClass:"item-details-count"},[t._v(t._s(t.getItemAmount()))]),i("span",{staticClass:"item-details-unit"},[t._v(t._s(t.itemData.unitDTO.name))])]),i("i",{directives:[{name:"show",rawName:"v-show",value:t.getItemAmount()>0||t.isActive,expression:"(getItemAmount()>0 || isActive)"}],staticClass:"item-selected-icon"})])])},s=[],o=i("cebc"),a=(i("c5f6"),i("2f62")),r={name:"addItemCell",props:{itemData:{type:Object,default:function(){return{}}},itemIndex:Number,rowActive:[Number,String],isActive:Boolean,isError:Boolean,showBom:{type:Boolean,default:!1},showSpec:{type:Boolean,default:!0},itemAmoutName:{type:String,default:""}},computed:Object(o["a"])({},Object(a["c"])({sysShowCode:function(t){return t.systemParams.sysShowCode}})),methods:{onItemClick:function(){this.$emit("on-item-click",this.itemIndex)},getItemAmount:function(){return""===this.itemAmoutName?this.itemData.busUnitAmount:this.itemData[this.itemAmoutName]}}},l=r,c=(i("3e54"),i("2877")),u=Object(c["a"])(l,n,s,!1,null,"70501ba1",null);e["a"]=u.exports},a09d:function(t,e,i){},a225:function(t,e,i){"use strict";var n=i("adb4"),s=i.n(n);s.a},adb4:function(t,e,i){},addc:function(t,e,i){"use strict";var n=i("e6b1"),s=i.n(n);s.a},bb50:function(t,e,i){},cbb0:function(t,e,i){"use strict";var n=i("5657"),s=i.n(n);s.a},cc4d:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-info-block fx-shadow-block"},[i("van-collapse",{attrs:{border:!1},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("van-collapse-item",{attrs:{name:"1",disabled:t.collapseDisabled}},[i("div",{staticClass:"info-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"info-title-name"},[t._v("单据信息")]),i("span",{staticClass:"stateTag fl-r"},[t._v(t._s(t.$fxStateMiddleware.getStateName("weightStateCld")(t.data.weightState)))]),i("span",{staticClass:"stateTag fl-r"},[t._v(t._s(t.$fxStateMiddleware.getStateName("stateCld")(t.data.billStateFlag)))])]),i("van-tabs",{attrs:{animated:""},model:{value:t.tabActive,callback:function(e){t.tabActive=e},expression:"tabActive"}},[i("van-tab",{attrs:{title:"表头"}},[i("w-cell",{staticClass:"info-item",attrs:{title:"配送中心","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-rdc-click")}}},[t._v(t._s(t.data.rdcDTO&&t.data.rdcDTO.name))]),i("w-cell",{staticClass:"info-item",attrs:{title:"供货商","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-supplier-click")}}},[t._v(t._s(t.data.supplierDTO&&t.data.supplierDTO.name))]),i("w-cell",{staticClass:"info-item",attrs:{title:"业务日期","is-link":!t.isDisabled},on:{click:t.onBusDateClick}},[t._v(t._s(t.formatterDate(t.data.businessDate)))]),i("w-cell",{staticClass:"info-item",attrs:{title:"业务类型","is-link":!t.isDisabled}},[t._v(t._s(t.data.businessTypeDTO&&t.data.businessTypeDTO.name))]),i("w-cell",{staticClass:"info-item",attrs:{title:"业务人","is-link":!t.isDisabled},on:{click:function(e){return t.onEmitClick("on-account-click")}}},[t._v(t._s(t.data.busUser&&t.data.busUser.name))]),i("van-pro-field",{staticClass:"info-item",attrs:{label:"整单备注",placeholder:t.isDisabled?"":"请输入整单备注","input-align":"right",maxlength:"50",disabled:t.isDisabled},model:{value:t.data.billMemo,callback:function(e){t.$set(t.data,"billMemo",e)},expression:"data.billMemo"}})],1),i("van-tab",{attrs:{title:"更多"}},[i("w-cell",{staticClass:"info-item",attrs:{title:"制单人"}},[t._v(t._s(t.data.billEmp))]),i("w-cell",{staticClass:"info-item",attrs:{title:"制单日期"}},[t._v(t._s(t.formatterDate(t.data.billDate)))]),i("w-cell",{staticClass:"info-item",attrs:{title:"审核人"}},[t._v(t._s(t.data.checkEmp))]),i("w-cell",{staticClass:"info-item",attrs:{title:"审核日期"}},[t._v(t._s(t.formatterDate(t.data.checkDate)))]),i("van-pro-number-field",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled,expression:"!isDisabled"}],staticClass:"info-item",attrs:{label:"整单运费","input-align":"right",min:"0",defaultValue:0,max:t.maxAmount,intLength:t.numberLength,pointSize:t.sysPointSize,disabled:t.isDisabled},model:{value:t.data.transMoney,callback:function(e){t.$set(t.data,"transMoney",e)},expression:"data.transMoney"}})],1)],1)],1)],1)],1)},s=[],o=i("cebc"),a=i("2f62"),r={name:"orderInfo",props:{data:{type:Object,default:function(){return{}}},isDisabled:Boolean,collapseDisabled:Boolean},data:function(){return{activeNames:["1"],tabActive:0}},computed:Object(o["a"])({},Object(a["c"])({sysPointSize:"sysPointSize",numberLength:"numberLength",maxAmount:"maxAmount"}),{formatterDate:function(t){var e=this;return function(t){return"number"===typeof t?e.$fxUtils.setDateTime(new Date(t),"时分"):""}},hasBillType:function(){return this.data.businessTypeDTO&&this.data.businessTypeDTO.id}}),methods:{onEmitClick:function(t){if(this.isDisabled)return!1;this.$emit(t)},closeCollapse:function(){this.activeNames=[]},onBusDateClick:function(){this.onEmitClick("on-busdate-click")}}},l=r,c=(i("11d4"),i("2877")),u=Object(c["a"])(l,n,s,!1,null,"e5d7ba12",null);e["a"]=u.exports},d444:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"add-item-class-content fx-vant-class-collapse"},[i("div",{staticClass:"all-class",class:{"is-active":""===t.value},on:{click:function(e){return e.stopPropagation(),t.selectClass("")}}},[t._v(t._s(t.classTitle))]),i("van-collapse",{attrs:{accordion:!0},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.itemClassList,function(e){return i("van-collapse-item",{key:e.id,attrs:{name:e.id}},[i("div",{staticClass:"big-class",attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))]),t._l(e.smallType,function(e){return i("van-cell",{key:e.id,staticClass:"small-class",class:{"is-active":t.value===e.id},attrs:{title:e.name},on:{click:function(i){return i.stopPropagation(),t.selectClass(e.id)}}})})],2)}),1)],1)},s=[],o=(i("c5f6"),{name:"addItemClassList",props:{value:[String,Number],itemClassList:{type:Array,default:function(){return[]}},classTitle:{type:String,default:"全部品项"}},data:function(){return{activeNames:[]}},methods:{selectClass:function(t){this.$emit("input",t),this.$emit("on-select-class",t),this.$emit("on-change-class",[t,this.value])}}}),a=o,r=(i("5402"),i("2877")),l=Object(r["a"])(a,n,s,!1,null,"df69e854",null);e["a"]=l.exports},d975:function(t,e,i){"use strict";var n=i("6795"),s=i.n(n);s.a},dab9:function(t,e,i){"use strict";var n=i("a09d"),s=i.n(n);s.a},e6b1:function(t,e,i){},f3c0:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRFMEVGQjYxREY1QzExRTk4NEQxQzk4RUQzQjYwMzQxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRFMEVGQjYyREY1QzExRTk4NEQxQzk4RUQzQjYwMzQxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEUwRUZCNUZERjVDMTFFOTg0RDFDOThFRDNCNjAzNDEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEUwRUZCNjBERjVDMTFFOTg0RDFDOThFRDNCNjAzNDEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5jgS7LAAAC50lEQVR42sSXy2tTQRTGzyS1KFgxYqkLQaWtAREXYiJpNUQLEaqCj/pAfBStuHHhRtC/wG4EX4hvKrpR3NWapq2KsZigreimBJtErSsfNYipSKh3/KYZ4zWZ3HtjEnrgy+ZOzm/mnJkzZxjnnKbDqsRP2xnNbByD1kIboWaoAXLIb0koBj2D7kNPIcPV3Dtmy4ANzAa1QyclTGV1UmJCx+UkTkFdkGbkuJAtgSLQdQOoyhrkfyLSR1FgH/QccpWQRpf04bUK9kNBaH4Z9pDw0Q9tMAM7Re6h6jJu4Grp01kIbIduQTUVOD2zpW+7CnygxJxayXl7LpjJI1M28y1jdHZ/3hY6IVlZsLfII2NoLcsZdaxjtGCu8qh59eDWckH9Kxgd9DGagWzejSgLWGu2ZMKalHUSQbFjapO/rEE3rWS0p4lRFaC3Bzl1v1SCPXpwo2rEkRZGNsDvhDmNpwwKOcZsXcVox2o2lcGuJ5wCrzkVuH+W6sEOZe2rY7S4FmdhJtHVR5ySE2rwdhejXR5Gk6jMN0OcggJaeJ4Os1pNlwY0+jBO5K7P5G3OrH+/izTsRmiF0kjHlYeceo2heQUkqfoY+0h0oU+jMcA9jYwOr2dUI+HViJVYZZub0fefRJcHOD0esXS3J/Xg0UKj4oCfD/6Fd2DlC+fRVD63IcTffojIcApFLTcUb/Q5DkNrCo18+4noXK9GR/02anYyWlSbgX+dyIR3KFFUFxPWr7jHbPS7z4Bj5QlMQkDFLr/YVzRU2AM9OCQ7B0Mb+wJYv0bhUU7XsMtfvS8aGpOtURYsPHRa+adY+ekeTi8S/9Ukdv5ph/THSfRIQxW8nYYlI+9aFIVxH5SqAFT43CsZyg4kCu2E0mWEpqXPqFnPFYC2lGnlKekrYLXLDMiOYbjEnLpUULNaLULjhg6JAlYEMC7/484Nb94TxsDE1r8hd6OobJvl3V2f84SJyydMNzRo9ILIXqXT9Wj7LcAAqr/RbQBzkgIAAAAASUVORK5CYII="},f6bb:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shop-popup"},[i("w-header",{attrs:{title:t.title,leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("van-pro-search",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"}],attrs:{shape:"round"},on:{search:t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),i("div",{staticClass:"popup-content"},[i("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"immediate-check":t.immediateCheck,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.data,function(e){return i("van-cell",{key:e.id,staticClass:"fx-van-cell",attrs:{title:e.name},on:{click:function(i){return t.indexListClick(e)}}})}),1)],1)],1)},s=[],o={name:"filterPop",props:{loading:Boolean,visibleFlag:Boolean,title:String,data:{type:Array,default:function(){return[]}},searchShow:{type:Boolean,default:!0},loadFinished:Boolean,immediateCheck:{type:Boolean,default:!0}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",listLoading:!1,listError:!1}},watch:{loading:{handler:function(t){t||(this.listLoading=!1)},immediate:!0},visibleFlag:function(t){t&&(this.searchKey="")}},methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},indexListClick:function(t){this.$emit("on-select",t),this.$emit("update:visibleFlag",!1)},search:function(t){this.$emit("on-search",t)},onLoad:function(){this.$emit("update:loading",!0),this.$emit("on-load",this.searchKey||null)}}},a=o,r=(i("8d5d"),i("2877")),l=Object(r["a"])(a,n,s,!1,null,"2a1c11fe",null);e["a"]=l.exports},f93b:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-item-block fx-shadow-block"},[i("div",{staticClass:"item-title"},[i("span",{staticClass:"title-name"},[t._v("单据明细")]),i("span",{staticClass:"title-count"},[t._v("明细：")]),i("span",[t._v(t._s(t.detailsLength))]),i("i",{directives:[{name:"show",rawName:"v-show",value:!t.isDisabled&&t.showAddItemBtn,expression:"!isDisabled && showAddItemBtn"}],staticClass:"title-add-icon fl-r",on:{click:function(e){return t.onEmitClick("on-add-click")}}}),i("i",{staticClass:"title-search-icon fl-r",on:{click:t.onSearchClick}})]),i("div",{ref:"details-content",staticClass:"item-list"},[i("van-collapse",{attrs:{border:!1},model:{value:t.activeStoreNames,callback:function(e){t.activeStoreNames=e},expression:"activeStoreNames"}},t._l(t.data,function(e){return i("van-collapse-item",{directives:[{name:"show",rawName:"v-show",value:t.storeShowComputed(e),expression:"storeShowComputed(storeItem)"}],key:e.uuid,staticClass:"store-row",attrs:{name:e.id}},[i("div",{staticClass:"item-store-title-container",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"item-out-store-title fx-ellipsis"},[t._v("入库仓库："+t._s(e.name))])]),t._l(e.details,function(n,s){return i("van-swipe-cell",{directives:[{name:"show",rawName:"v-show",value:"del"!==n.changeType,expression:"item.changeType !== 'del'"}],key:n.uuid,staticClass:"item-row",attrs:{"right-width":80,disabled:t.isDisabled||t.focusing||!t.$fxAuth("stockInBill4cld.delDetail")}},[i("itemInfoCell",t._g(t._b({attrs:{itemData:n,isDisabled:t.isDisabled,disabledEditBtn:t.focusing},on:{"on-item-focus":t.onItemFocus,"on-item-blur":t.onItemBlur,"on-unit-edit":t.onUnitEdit}},"itemInfoCell",t.$attrs,!1),t.$listeners)),i("div",{staticClass:"item-row-delete",attrs:{slot:"right"},on:{click:function(i){return t.onDeleteClick(n,s,e.details)}},slot:"right"},[t._v("删除")])],1)})],2)}),1)],1),i("w-action-sheet",{directives:[{name:"fx-history-back",rawName:"v-fx-history-back",value:t.unitActionShow,expression:"unitActionShow"}],ref:"unitActionSheet",attrs:{actions:t.unitActions},model:{value:t.unitActionShow,callback:function(e){t.unitActionShow=e},expression:"unitActionShow"}})],1)},s=[],o=(i("ac6a"),i("5546")),a={name:"orderItem",components:{itemInfoCell:o["a"]},props:{data:{type:Array,default:function(){return[]}},isDisabled:Boolean,showAddItemBtn:Boolean},inheritAttrs:!1,data:function(){return{focusing:!1,activeStoreNames:[],unitActions:[],unitActionShow:!1}},computed:{storeShowComputed:function(t){return function(t){var e=t.details.filter(function(t){return"del"!==t.changeType}).length;return e>0}},detailsLength:function(t){return this.data.reduce(function(t,e){var i=e.details.filter(function(t){return"del"!==t.changeType});return t+i.length},0)}},watch:{focusing:function(t){this.$emit("update:itemInputFocusing",t)},data:function(){var t=this;this.data.forEach(function(e){var i=e.details.filter(function(t){return"del"!==t.changeType}).length;i>0&&t.activeStoreNames.push(e.id)})}},methods:{onEmitClick:function(t){if(this.isDisabled||this.focusing)return!1;this.$emit(t)},onSearchClick:function(){if(this.focusing)return!1;this.$emit("on-search-click")},onDeleteClick:function(t,e,i){t.id?this.$set(t,"changeType","del"):i.splice(e,1)},onItemFocus:function(){this.focusing=!0},onItemBlur:function(){this.focusing=!1},onUnitEdit:function(t){var e=this;this.$fxApi("common.getItemUnit",t.goodsDTO.id).then(function(i){e.unitActions=i.units,e.$refs.unitActionSheet.doSelect(t.unitDTO.id).then(function(i){e.$fxCalculation("stockInBill4cld").changeUnit(t,i)})})}}},r=a,l=(i("addc"),i("2877")),c=Object(l["a"])(r,n,s,!1,null,"aa8365ec",null);e["a"]=c.exports},f944:function(t,e,i){}}]);
//# sourceMappingURL=stockInBill4cld.a2a600f3.js.map