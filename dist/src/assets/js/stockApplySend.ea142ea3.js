(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["stockApplySend"],{"08d9":function(t,e,i){},"0cb6":function(t,e,i){},"0f38":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.visibleFlag,expression:"visibleFlag"}],staticClass:"order-checkbox",on:{click:t.onCheckboxClick},scopedSlots:t._u([{key:"icon",fn:function(e){return i("img",{staticClass:"checked-box-icon",attrs:{src:e.checked?t.checkedIcon.active:t.checkedIcon.normal}})}}]),model:{value:t.$attrs.checked,callback:function(e){t.$set(t.$attrs,"checked",e)},expression:"$attrs.checked"}})},o=[],s={name:"checkBox",props:{visibleFlag:{type:Boolean,default:!1}},data:function(){return{checkedIcon:{normal:i("41c0"),active:i("f3c0")}}},methods:{onCheckboxClick:function(){this.$emit("on-checkbox-click")}}},a=s,l=(i("dab9"),i("2877")),r=Object(l["a"])(a,n,o,!1,null,"4e0c8b3e",null);e["a"]=r.exports},1771:function(t,e,i){"use strict";var n=i("2e90"),o=i.n(n);o.a},"2b82":function(t,e,i){},"2dac":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"inteledi-stockApplySend"},[i("w-header",{attrs:{title:"采购申请分派",border:!0}}),i("div",{staticClass:"stockApplySend-content"},[i("div",{staticClass:"stockApplySend-filter"},[i("FilterInfo",{attrs:{filterParams:t.filterParams},on:{"on-beginDate-click":t.onBeginDateClick,"on-endDate-click":t.endDateClick,"on-shop-click":t.onShopClick,"on-billtype-click":t.onBillTypeClick,"on-billtypeclear-click":t.onBillTypeClearClick}})],1),i("van-search",{attrs:{shape:"round",placeholder:"请输入搜索关键词"},on:{search:t.changeSearchWord,clear:t.changeSearchWord},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}}),i("van-cell",[t._v("单据数量: "+t._s(t.orderList.length))]),i("van-pull-refresh",{directives:[{name:"show",rawName:"v-show",value:0!==t.orderList.length,expression:"orderList.length !== 0"}],staticClass:"stockApplySend-list",on:{refresh:t.onPullRefresh},model:{value:t.pullRefreshLoading,callback:function(e){t.pullRefreshLoading=e},expression:"pullRefreshLoading"}},[i("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoadMore},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.orderList,function(t){return i("orderBlock",{key:t.id,attrs:{data:t,showCheckBox:!0}})}),1)],1),i("emptyBill",{directives:[{name:"show",rawName:"v-show",value:0===t.orderList.length,expression:"orderList.length === 0"}]})],1),i("div",{staticClass:"stockApplySend-bottom"},[i("checkBox",{staticClass:"order-checkbox",attrs:{visibleFlag:!0,checked:t.isSelectAll},on:{"on-checkbox-click":t.onSelectAllClick}}),i("span",{staticClass:"selectall-text"},[t._v("全选")]),i("div",{staticClass:"send-btn"},[i("van-button",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockApplySend.add"),expression:"$fxAuth('stockApplySend.add')"}],attrs:{type:"primary",round:"",size:"small"},on:{click:t.onSendClick}},[t._v("分派")])],1)],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.datePickerShow,callback:function(e){t.datePickerShow=e},expression:"datePickerShow"}},[i("w-date-picker",{attrs:{visibleFlag:t.datePickerShow,currentDate:t.currentDate},on:{"update:visibleFlag":function(e){t.datePickerShow=e},"update:visible-flag":function(e){t.datePickerShow=e},confirm:t.dateConfirmhandle}})],1),i("filterListPopup",{attrs:{title:"申请机构检索",rollingLoad:!0,getDataApi:t.getShopListData},on:{"on-select":function(e){return t.selectShop(arguments)}},model:{value:t.shopPopShow,callback:function(e){t.shopPopShow=e},expression:"shopPopShow"}}),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.billTypePopShow,callback:function(e){t.billTypePopShow=e},expression:"billTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.billTypePopShow,data:t.billTypeList,loadFinished:!0,title:"单据类型检索"},on:{"update:visibleFlag":function(e){t.billTypePopShow=e},"update:visible-flag":function(e){t.billTypePopShow=e},"on-search":t.searchBillType,"on-select":t.selectBillType}})],1)],1)},o=[],s=(i("7f7f"),i("768b")),a=(i("ac6a"),i("75fc")),l=i("5176"),r=i.n(l),c=i("795b"),p=i.n(c),d=i("cebc"),u=(i("6762"),i("2f62")),h=i("4102"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-block",on:{click:t.onClick}},[i("checkBox",{staticClass:"order-checkbox",attrs:{visibleFlag:t.showCheckBox,checked:t.data.checked},on:{"on-checkbox-click":t.onClick}}),i("div",{staticClass:"block-content"},[i("div",{staticClass:"block-title"},[i("span",{staticClass:"title-text fx-ellipsis"},[t._v(t._s(t.data.sysbillCode))])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("业务日期：")]),i("div",{staticClass:"order-date"},[i("span",[t._v(t._s(t.formatterDate(t.data.businessDate)))])])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("到货日期：")]),i("div",{staticClass:"order-date"},[i("span",[t._v(t._s(t.formatterDate(t.data.arriveDate)))])])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("单据类型：")]),i("div",{staticClass:"order-date"},[i("span",[t._v(t._s(t.data.businessTypeDTO.name))])])])])],1)},f=[],g=i("0f38"),v={name:"orderBlock",components:{checkBox:g["a"]},props:{data:{type:Object,default:function(){return{}}},showCheckBox:{type:Boolean,default:!1}},computed:{formatterDate:function(t){var e=this;return function(t){return"number"===typeof t?e.$fxUtils.setDateTime(new Date(t),"时分"):""}}},methods:{onClick:function(){this.showCheckBox?this.$set(this.data,"checked",!this.data.checked):this.$emit("on-click",this.data)}}},S=v,y=(i("48b1"),i("2877")),k=Object(y["a"])(S,m,f,!1,null,"1213102b",null),b=k.exports,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-info-popup fx-shadow-block"},[i("van-cell-group",[i("van-cell",{attrs:{title:"业务日期"}}),i("van-cell",{attrs:{title:"起始时间",value:t.filterParams.beginDate,"is-link":""},on:{click:function(e){return t.onEmitClick("on-beginDate-click")}}}),i("van-cell",{attrs:{title:"结束时间",value:t.filterParams.endDate,"is-link":""},on:{click:function(e){return t.onEmitClick("on-endDate-click")}}}),i("van-cell",{attrs:{title:"申请机构",value:t.filterParams.shop,"value-class":"info-item-value","is-link":""},on:{click:function(e){return t.onEmitClick("on-shop-click")}}}),i("van-cell",{attrs:{title:"单据类型",value:t.filterParams.billType,"value-class":"info-item-value"},on:{click:function(e){return t.onEmitClick("on-billtype-click")}}},[i("van-icon",{staticClass:"item-clear-btn",attrs:{slot:"right-icon",name:t.filterParams.billTypeId?"close":"arrow"},on:{click:function(e){e.stopPropagation(),t.filterParams.billTypeId?t.onEmitClick("on-billtypeclear-click"):t.onEmitClick("on-billtype-click")}},slot:"right-icon"})],1)],1)],1)},T=[],I={name:"filterInfo",props:{filterParams:{type:Object,default:function(){return{}}}},methods:{onEmitClick:function(t){this.$emit(t)}}},C=I,w=(i("ce2a"),Object(y["a"])(C,L,T,!1,null,"7919c94b",null)),P=w.exports,D=i("f6bb"),x=i("eb03"),A=50,B={name:"stockApplySend",components:{emptyBill:h["a"],orderBlock:b,FilterInfo:P,listComp:D["a"],checkBox:g["a"],filterListPopup:x["a"]},data:function(){return{orderList:[],listStart:0,pullRefreshLoading:!1,listLoading:!1,loadFinished:!0,listError:!1,searchWord:"",currentDate:new Date,filterParams:{beginDate:this.$fxCommon.orderFilterStartDate(),endDate:this.$fxCommon.orderFilterEndDate(),shop:"请选择",shopId:"",billType:"请选择",billTypeId:""},datePickerShow:!1,shopPopShow:!1,billTypeList:[],billTypePopShow:!1}},beforeRouteLeave:function(t,e,i){if("/login"===t.path)i();else{if(this.filterPopShow)return this.filterPopShow=!1,this.$router.go(1),!1;i()}},beforeRouteEnter:function(t,e,i){var n=["/main/home","/"],o=["/stockApplySendDetails"];n.includes(e.path)?i(function(t){t.restFilterParams().then(function(){t.refreshOrderList()})}):o.includes(e.path)?i(function(t){t.refreshOrderList()}):i()},computed:Object(d["a"])({},Object(u["c"])({billListPostParams:"billListPostParams",loginerShopId:function(t){return t.loginer.loginerShopId},loginerShopName:function(t){return t.loginer.loginerShopName},loginerId:function(t){return t.loginer.loginerId},loginerOrganType:function(t){return t.loginer.loginerOrganType}}),{isSelectAll:function(){var t=this.orderList.filter(function(t){return!!t.checked});return t.length===this.orderList.length&&this.orderList.length}}),methods:{orderListPostHandler:function(t){var e=this;return new p.a(function(i){e.$store.commit({type:"SETSTATE",billListPostParams:t}),e.$fxHttp.requestPost({url:"".concat(e.$fxBaseApi.url,"/accounts/").concat(e.loginerShopId,"/stockApplies/users/").concat(e.loginerId),query:{m:"pageList4StockSendLeft"},data:t}).then(function(t){i(t)})})},changeFilterParams:function(){this.refreshOrderList()},refreshOrderList:function(){var t=this;return new p.a(function(e){t.listStart=0;var i={start:t.listStart,size:A,paged:!0,businessDateStart:t.$fxCommon.orderFilterStartDate(),businessDateEnd:t.$fxCommon.orderFilterEndDate(),keyword:t.searchWord};i=r()(i,t.translateFilterParams(t.filterParams)),t.orderListPostHandler(i).then(function(i){t.orderList=i.stockApplyBills,e(i)})})},translateFilterParams:function(t){return this.$fxUtils.isEmptyObjSHW(t)?{}:{businessDateStart:t.beginDate,businessDateEnd:t.endDate,shopId:""===t.shopId?null:t.shopId,businessType:""===t.billTypeId?null:t.billTypeId}},onPullRefresh:function(){var t=this;this.refreshOrderList().then(function(e){t.pullRefreshLoading=!1})},onLoadMore:function(){var t=this,e=r()(this.billListPostParams,{start:this.listStart});this.orderListPostHandler(e).then(function(e){var i;(i=t.orderList).push.apply(i,Object(a["a"])(e.stockApplyBills))})},onSelectAllClick:function(){var t=this,e=!this.isSelectAll;this.orderList.forEach(function(i){t.$set(i,"checked",e)})},onBeginDateClick:function(){this.dateType="begin",this.beginDate&&(this.currentDate=new Date(this.beginDate)),this.datePickerShow=!0},endDateClick:function(){this.dateType="end",this.endDate&&(this.currentDate=new Date(this.endDate)),this.datePickerShow=!0},dateConfirmhandle:function(t){"begin"===this.dateType?(this.filterParams.beginDate=this.$fxUtils.setDateTime(t,"时分"),this.filterParams.endDate&&this.$fxUtils.compareDateRange(this.filterParams.beginDate,this.filterParams.endDate,7)||(this.filterParams.endDate=this.$fxCommon.orderFilterDate(t))):(this.filterParams.endDate=this.$fxUtils.setDateTime(t,"时分"),this.filterParams.beginDate&&this.$fxUtils.compareDateRange(this.filterParams.beginDate,this.filterParams.endDate,7)||(this.filterParams.beginDate=this.$fxCommon.orderFilterStartDate(t))),this.datePickerShow=!1,this.changeFilterParams()},onShopClick:function(){this.shopPopShow=!0},selectShop:function(t){var e=Object(s["a"])(t,1),i=e[0];if(i.id===this.filterParams.shopId)return!0;this.filterParams.shop=i.name,this.filterParams.shopId=i.id,this.changeFilterParams()},getShopListData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n={keyword:t,start:e,size:i};return this.$fxApi("z5common.getUserManageShop")({data:n}).then(function(t){return t.shops})},onBillTypeClick:function(){this.onBillTypeRefresh()},searchBillType:function(t){this.onBillTypeRefresh(t)},selectBillType:function(t){if(t.id===this.filterParams.billTypeId)return!0;this.filterParams.billType=t.name,this.filterParams.billTypeId=t.id,this.changeFilterParams()},onBillTypeRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBillTypeListData(e).then(function(e){t.billTypeList=e.businessTypes,t.billTypePopShow=!0})},getBillTypeListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new p.a(function(i){var n={billType:"18_0",keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/businessTypes"),data:n}).then(function(t){i(t)})})},onBillTypeClearClick:function(){this.filterParams.billType="请选择",this.filterParams.billTypeId="",this.changeFilterParams()},changeSearchWord:function(t){this.changeFilterParams()},onSendClick:function(){var t=this.orderList.reduce(function(t,e){var i=e.checked?t.concat(e.id):t;return i},[]);if(0===t.length)return this.$fxToast.fail("请选择一条记录！"),!1;this.$router.push({path:"stockApplySendDetails",query:{orderIds:t}})},restFilterParams:function(){var t=this;return new p.a(function(e){t.searchWord="",t.filterParams={beginDate:t.$fxCommon.orderFilterStartDate(),endDate:t.$fxCommon.orderFilterEndDate(),shop:"请选择",shopId:"",billType:"请选择",billTypeId:""},t.getDefaultShopListData().then(function(i){i.shops&&i.shops.length&&(t.filterParams.shopId=i.shops[0].id,t.filterParams.shop=i.shops[0].name),e()})})},getDefaultShopListData:function(){var t=this;return new p.a(function(e){t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/inshopDefault")}).then(function(t){e(t)})})}}},F=B,R=(i("a3d7"),Object(y["a"])(F,n,o,!1,null,"02b8d6af",null));e["default"]=R.exports},"2e90":function(t,e,i){},"374c":function(t,e,i){},"40ca":function(t,e,i){},4102:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"order-empty"},[n("img",{staticClass:"empty-icon",attrs:{src:i("6ee7")}}),n("div",{staticClass:"empty-text"},[t._v(t._s(t.message))])])},o=[],s={name:"emptyBill",props:{message:{type:String,default:"暂无可查看的订单"}}},a=s,l=(i("faf1"),i("2877")),r=Object(l["a"])(a,n,o,!1,null,"3c6ad708",null);e["a"]=r.exports},"41c0":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU5MzM3ODc2REY1QzExRTlBNjU4QkY2NDE0MTBEMjAzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU5MzM3ODc3REY1QzExRTlBNjU4QkY2NDE0MTBEMjAzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTkzMzc4NzRERjVDMTFFOUE2NThCRjY0MTQxMEQyMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTkzMzc4NzVERjVDMTFFOUE2NThCRjY0MTQxMEQyMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6ky6P/AAACeElEQVR42sSXTW8SURSGLwNhAZLQBAhb09K6Vxd+xpWJNboxqRub9meoP0D7M5roRl36lW6tsQvtvkobd4QASUkYWPDp+07OkENtYabD1ZO8cyHMvM+9d+695xAbjUbmf0QiyE3lcjmG5hZ0H7oBLUEL8vMxdAh9gz5Au6VSaeZoYtNGDKCDZhN6JrAgwU68hLbRgWFoMKAX0byBrnpTk0iYTCZjUqmUSSaTJh6PGz7b7/c9dTod47qu6fV6vsV36DHgvwODAb2D5h2UIzCXy3nQINFqtUyj0fA6g2hAjwD/MhMM6F0076FkOp02xWLROI4TauEMh0NTrVZNu93m1y70EPCdM8GArsgUZbLZrMnn85FWbr1eN81mkx9d6ArgP/3fHAWNo3lFKKc1KpRBD3lFF+gtjEkwYoMLie+0UCjMbb/Si56ySDcnwLJPuWW8hRT2nU4LetFT4qmwxiO+zX3qb5l5Bz1l1EvCGoNX/RtshfJe1eDrvPBwsBXK+5oGl3jhiWQrlPeyBnsHPo9BW6G8F05up38ajkptZjAYWAMp72MNLnuHardrDay8f2nwHi9MbbZCee9p8Ec/pdkK5f1Jg5kvD5lDbcDpKfmZ1cnuGCw10paXuZHEmU/nFfSip8SWXw7p7bQN/WDParXa3MD0ktHuC2MyLaInXO/rTNqcGibxqEEPeXUsBJ4I4698TPgBmjWuflYOlUrlXNPOZ/isVB/cR2viPbPYu4fmLSuHiMWeK9DPYcrbS2heQ5fPKm/9E4mHwynl7b5M70GUgv45tBhwpo+gF+cu6E/pwE3ogeTuxRN/YY7kLwzL4q/TgKHANuKPAAMAun8rS4SUYuAAAAAASUVORK5CYII="},"48b1":function(t,e,i){"use strict";var n=i("0cb6"),o=i.n(n);o.a},5456:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"inteledi-stockApplySend-details"},[i("w-header",{attrs:{title:"分派明细编辑",titleFontSize:"3.733vw",border:!0}},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockApplySend.save"),expression:"$fxAuth('stockApplySend.save')"}],staticClass:"save-btn",attrs:{slot:"header-right"},on:{click:t.onSaveClick},slot:"header-right"},[t._v("保存")])]),i("orderItem",{ref:"orderItem",attrs:{data:t.orderItemList,itemInputFocusing:t.itemInputFocusing,searchKey:t.searchWord},on:{"update:itemInputFocusing":function(e){t.itemInputFocusing=e},"update:item-input-focusing":function(e){t.itemInputFocusing=e},"update:searchKey":function(e){t.searchWord=e},"update:search-key":function(e){t.searchWord=e},"on-supplier-click":t.onSupplierClick,"on-packing-click":t.onPackingClick,"on-search-change":t.onSearchChange,"on-filter-click":t.onFilterClick,"on-batch-click":t.onBatchSetClick}}),i("div",{staticClass:"stockApplySend-bottom"},[i("checkBox",{staticClass:"order-checkbox",attrs:{visibleFlag:!0,checked:t.isSelectAll},on:{"on-checkbox-click":t.onSelectAllClick}}),i("span",{staticClass:"selectall-text"},[t._v("全选")]),i("div",{staticClass:"send-btn-wrap"},[i("van-button",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockApplySend.del"),expression:"$fxAuth('stockApplySend.del')"}],staticClass:"collect-btn",attrs:{type:"default",round:"",size:"small"},on:{click:t.onCollectSendClick}},[t._v("不分派")]),i("van-button",{directives:[{name:"show",rawName:"v-show",value:t.$fxAuth("stockApplySend.add"),expression:"$fxAuth('stockApplySend.add')"}],attrs:{type:"primary",round:"",size:"small"},on:{click:t.onSendClick}},[t._v("分派")])],1)],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.supplierPopShow,callback:function(e){t.supplierPopShow=e},expression:"supplierPopShow"}},[i("listComp",{attrs:{visibleFlag:t.supplierPopShow,data:t.supplierList,loadFinished:!0,title:"供货商检索"},on:{"update:visibleFlag":function(e){t.supplierPopShow=e},"update:visible-flag":function(e){t.supplierPopShow=e},"on-search":t.searchSupplier,"on-select":t.selectSupplier}})],1),i("van-popup",{staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.filterPopShow,callback:function(e){t.filterPopShow=e},expression:"filterPopShow"}},[i("filterPop",{attrs:{visibleFlag:t.filterPopShow,filterParams:t.filterParams},on:{"update:visibleFlag":function(e){t.filterPopShow=e},"update:visible-flag":function(e){t.filterPopShow=e},"update:filterParams":function(e){t.filterParams=e},"update:filter-params":function(e){t.filterParams=e},"on-confirm":t.onFilterConfirm}})],1)],1)},o=[],s=i("75fc"),a=(i("7f7f"),i("7514"),i("ac6a"),i("59ad")),l=i.n(a),r=i("5176"),c=i.n(r),p=i("795b"),d=i.n(p),u=i("cebc"),h=i("2f62"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-item-block"},[i("div",{staticClass:"item-head"},[i("van-search",{staticClass:"head-search",attrs:{shape:"round",placeholder:"请输入搜索关键词"},on:{search:t.changeSearchWord,clear:t.changeSearchWord,input:t.inputSearchKey},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}}),i("i",{staticClass:"filter-icon fl-r",on:{click:t.onFilterClick}}),i("div",{staticClass:"head-text",on:{click:t.onBatchSetClick}},[i("i",{staticClass:"batch-ser-icon fl-l"}),t._v("批量设置")])],1),i("div",{ref:"details-content",staticClass:"item-list"},t._l(t.data,function(e){return i("van-swipe-cell",{directives:[{name:"show",rawName:"v-show",value:"del"!==e.changeType,expression:"item.changeType !== 'del'"}],key:""+e.id,ref:"details-row-"+e.id,refInFor:!0,staticClass:"item-row"},[i("itemInfoCell",t._g(t._b({attrs:{itemData:e,showCheckBox:!0},on:{"on-item-focus":function(i){return t.onItemFocus(arguments,e.houseDTO.id+"-"+e.goodsDTO.id)},"on-item-blur":t.onItemBlur}},"itemInfoCell",t.$attrs,!1),t.$listeners))],1)}),1)])},f=[],g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-block"},[i("checkBox",{staticClass:"order-checkbox",attrs:{visibleFlag:t.showCheckBox,checked:t.itemData.checked},on:{"on-checkbox-click":t.onClick}}),i("div",{staticClass:"block-content"},[i("div",{staticClass:"block-title"},[i("span",{staticClass:"title-text fx-ellipsis"},[t._v(t._s(t.itemData.houseDTO.name))])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("品项编号：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.goodsDTO.code)+"\n\t\t\t")])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("品项名称：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.goodsDTO.name)+"\n\t\t\t")])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("品项规格：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.goodsDTO.spec)+"\n\t\t\t")])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("供货商：")]),i("div",{staticClass:"order-date",on:{click:t.onSupplierClick}},[i("span",[t._v(t._s(t.itemData.supplierDTO.name))]),i("van-icon",{attrs:{name:"arrow"}})],1)]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("单价：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.priceWithTax)+"\n\t\t\t")])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("申请数量：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.busUnitAmount)+"\n\t\t\t")])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("库存数：")]),i("div",{staticClass:"order-date",class:{"fx-red-font":t.itemData.kcAmount<t.itemData.busUnitAmount}},[t._v("\n\t\t\t\t"+t._s(t.itemData.kcAmount)+"\n\t\t\t")])]),i("div",{staticClass:"block-value block-last"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("本次分派数量：")]),i("div",{staticClass:"order-date"},[i("span",[i("w-stepper",{ref:"amountInput",staticClass:"amount-step",attrs:{min:"0",max:t.maxAmount,stepperBtnShow:!1,intLength:t.numberLength,pointSize:t.sysPointSize,inputWidth:"28vw"},on:{change:t.onChange},model:{value:t.itemData.waitAmount,callback:function(e){t.$set(t.itemData,"waitAmount",e)},expression:"itemData.waitAmount"}})],1)])]),i("div",{staticClass:"block-value"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("单据号：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.sysbillCode)+"\n\t\t\t")])]),i("div",{staticClass:"block-value block-last"},[i("div",{staticClass:"order-No fx-ellipsis"},[t._v("备注：")]),i("div",{staticClass:"order-date"},[t._v("\n\t\t\t\t"+t._s(t.itemData.memo)+"\n\t\t\t")])])])],1)},v=[],S=i("0f38"),y={name:"itemInfoCell",components:{checkBox:S["a"]},props:{itemData:{type:Object,default:function(){return{}}},showCheckBox:{type:Boolean,default:!1}},computed:Object(u["a"])({},Object(h["c"])({sysPointSize:"sysPointSize",numberLength:"numberLength",maxAmount:"maxAmount"})),methods:{onClick:function(){this.showCheckBox?this.$set(this.itemData,"checked",!this.itemData.checked):this.$emit("on-check-click",this.itemData)},onPackingClick:function(){this.$emit("on-packing-click",this.itemData)},onSupplierClick:function(){this.$emit("on-supplier-click",this.itemData)},onChange:function(t){this.editItem()},editItem:function(){this.itemData.goodsDTO.id&&this.$set(this.itemData,"changeType","edit")}}},k=y,b=(i("1771"),i("2877")),L=Object(b["a"])(k,g,v,!1,null,"a491379e",null),T=L.exports,I={name:"orderItem",components:{itemInfoCell:T},props:{data:{type:Array,default:function(){return[]}},searchKey:String,itemInputFocusing:Boolean},inheritAttrs:!1,data:function(){return{focusing:!1,searchWord:""}},computed:{},watch:{focusing:function(t){this.$emit("update:itemInputFocusing",t)}},methods:{changeSearchWord:function(){this.$emit("on-search-change",this.searchWord)},inputSearchKey:function(){this.$emit("update:searchKey",this.searchWord)},onFilterClick:function(){if(this.focusing)return!1;this.$emit("on-filter-click")},onBatchSetClick:function(){if(this.focusing)return!1;this.$emit("on-batch-click")},onItemFocus:function(t,e){this.focusing=!0},onItemBlur:function(){this.focusing=!1}}},C=I,w=(i("8081"),Object(b["a"])(C,m,f,!1,null,"edc920b2",null)),P=w.exports,D=i("f6bb"),x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-popup"},[i("w-header",{attrs:{title:"筛选条件",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("div",{ref:"filterContent",staticClass:"filter-content"},[i("van-cell-group",[i("van-cell",{attrs:{title:"仓库",value:t.store,"value-class":"info-item-value","is-link":""},on:{click:t.onStoreClick}}),i("van-cell",{attrs:{title:"供货商",value:t.supplier,"value-class":"info-item-value","is-link":""},on:{click:t.onSupplierClick}}),i("van-cell",{attrs:{title:"品项",value:t.item,"value-class":"info-item-value","is-link":""},on:{click:t.onItemClick}}),i("van-cell",{attrs:{title:"品项大类",value:t.itemBigType,"value-class":"info-item-value","is-link":""},on:{click:t.onItemBigTypeClick}}),i("van-cell",{attrs:{title:"品项小类",value:t.itemSmallType,"value-class":"info-item-value","is-link":""},on:{click:t.onItemSmallTypeClick}}),i("van-cell",{attrs:{title:"品项类别",value:t.itemType,"value-class":"info-item-value","is-link":""},on:{click:t.onItemTypeClick}})],1)],1),i("div",{staticClass:"filter-bottom"},[i("van-button",{staticClass:"reset-btn fx-no-radius",attrs:{type:"info"},on:{click:t.onResetClick}},[t._v("重置")]),i("van-button",{staticClass:"confirm-btn fx-no-radius",attrs:{type:"primary"},on:{click:t.onConfirmClick}},[t._v("确定")])],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.supplierPopShow,callback:function(e){t.supplierPopShow=e},expression:"supplierPopShow"}},[i("listComp",{attrs:{visibleFlag:t.supplierPopShow,data:t.supplierList,loadFinished:!0,title:"供货商检索"},on:{"update:visibleFlag":function(e){t.supplierPopShow=e},"update:visible-flag":function(e){t.supplierPopShow=e},"on-search":t.searchSupplier,"on-select":t.selectSupplier}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.storePopShow,callback:function(e){t.storePopShow=e},expression:"storePopShow"}},[i("listComp",{attrs:{visibleFlag:t.storePopShow,data:t.storeList,loadFinished:t.storeListLoadFinished,loading:t.onStoreLoading,title:"仓库检索"},on:{"update:visibleFlag":function(e){t.storePopShow=e},"update:visible-flag":function(e){t.storePopShow=e},"update:loading":function(e){t.onStoreLoading=e},"on-search":t.searchStore,"on-select":t.selectStore,"on-load":t.onStoreLoad}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.itemPopShow,callback:function(e){t.itemPopShow=e},expression:"itemPopShow"}},[i("listComp",{attrs:{visibleFlag:t.itemPopShow,data:t.itemList,loadFinished:t.itemListLoadFinished,loading:t.onItemLoading,title:"品项检索"},on:{"update:visibleFlag":function(e){t.itemPopShow=e},"update:visible-flag":function(e){t.itemPopShow=e},"update:loading":function(e){t.onItemLoading=e},"on-search":t.searchItem,"on-select":t.selectItem,"on-load":t.onItemLoad}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.itemBigTypePopShow,callback:function(e){t.itemBigTypePopShow=e},expression:"itemBigTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.itemBigTypePopShow,data:t.itemBigTypeList,loadFinished:t.itemBigTypeListLoadFinished,loading:t.itemBigTypeLoading,title:"品项大类检索"},on:{"update:visibleFlag":function(e){t.itemBigTypePopShow=e},"update:visible-flag":function(e){t.itemBigTypePopShow=e},"update:loading":function(e){t.itemBigTypeLoading=e},"on-search":t.searchItemBigType,"on-select":t.selectItemBigType,"on-load":t.onItemBigTypeLoad}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.itemSmallTypePopShow,callback:function(e){t.itemSmallTypePopShow=e},expression:"itemSmallTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.itemSmallTypePopShow,data:t.itemSmallTypeList,loadFinished:t.itemSmallTypeListLoadFinished,loading:t.itemSmallTypeLoading,title:"品项小类检索"},on:{"update:visibleFlag":function(e){t.itemSmallTypePopShow=e},"update:visible-flag":function(e){t.itemSmallTypePopShow=e},"update:loading":function(e){t.itemSmallTypeLoading=e},"on-search":t.searchItemSmallType,"on-select":t.selectItemSmallType,"on-load":t.onItemSmallTypeLoad}})],1),i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.itemTypePopShow,callback:function(e){t.itemTypePopShow=e},expression:"itemTypePopShow"}},[i("listComp",{attrs:{visibleFlag:t.itemTypePopShow,data:t.itemTypeList,loadFinished:t.itemTypeListLoadFinished,loading:t.itemTypeLoading,title:"品项类别检索"},on:{"update:visibleFlag":function(e){t.itemTypePopShow=e},"update:visible-flag":function(e){t.itemTypePopShow=e},"update:loading":function(e){t.itemTypeLoading=e},"on-search":t.searchItemType,"on-select":t.selectItemType,"on-load":t.onItemTypeLoad}})],1)],1)},A=[],B=50,F={name:"filterPop",components:{listComp:D["a"]},props:{visibleFlag:Boolean,filterParams:{type:Object,default:function(){return{}}}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},supplier:"请选择",supplierId:"",supplierList:[],supplierPopShow:!1,store:"请选择",storeId:"",storeList:[],storePopShow:!1,storeListStart:0,onStoreLoading:!1,storeListLoadFinished:!1,item:"请选择",itemId:"",itemList:[],itemPopShow:!1,itemListStart:0,onItemLoading:!1,itemListLoadFinished:!1,itemBigTypeListStart:0,itemBigType:"请选择",itemBigTypeId:"",itemBigTypeList:[],itemBigTypeListLoadFinished:!1,itemBigTypeLoading:!1,itemBigTypePopShow:!1,itemSmallTypeListStart:0,itemSmallType:"请选择",itemSmallTypeId:"",itemSmallTypeList:[],itemSmallTypeListLoadFinished:!1,itemSmallTypeLoading:!1,itemSmallTypePopShow:!1,itemTypeListStart:0,itemType:"请选择",itemTypeId:"",itemTypeList:[],itemTypeListLoadFinished:!1,itemTypeLoading:!1,itemTypePopShow:!1}},watch:{visibleFlag:{handler:function(t){t&&this.$fxUtils.isEmptyObjSHW(this.filterParams)&&this.resetHandler()},immediate:!0}},computed:Object(u["a"])({},Object(h["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId}})),methods:{getFilterParams:function(){return{supplierId:this.supplierId,storeId:this.storeId,itemId:this.itemId,itemBigTypeId:this.itemBigTypeId,itemSmallTypeId:this.itemSmallTypeId,itemTypeId:this.itemTypeId}},onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onConfirmClick:function(){this.$emit("update:visibleFlag",!1),this.$emit("update:filterParams",this.getFilterParams()),this.$emit("on-confirm",this.getFilterParams())},onResetClick:function(){this.resetHandler()},resetHandler:function(){this.supplier="请选择",this.supplierId="",this.store="请选择",this.storeId="",this.item="请选择",this.itemId="",this.itemBigType="请选择",this.itemBigTypeId="",this.itemSmallType="请选择",this.itemSmallTypeId="",this.itemType="请选择",this.itemTypeId=""},onSupplierClick:function(){this.onSupplierRefresh()},searchSupplier:function(t){this.onSupplierRefresh(t)},selectSupplier:function(t){this.supplier=t.name,this.supplierId=t.id},onSupplierRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getSupplierListData(e).then(function(e){t.supplierList=e.suppliers,t.supplierPopShow=!0})},getSupplierListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={m:"getListByKeywordOfselAll",selAll:"on",keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/suppliers"),data:n}).then(function(t){i(t)})})},onStoreClick:function(){this.onStoreRefresh()},searchStore:function(t){this.onStoreRefresh(t)},selectStore:function(t){this.store=t.name,this.storeId=t.id},onStoreRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.storeListStart=0,this.storeListLoadFinished=!1,this.getStoreListData(e).then(function(e){t.storePopShow=!0,t.onStoreLoading=!1,t.storeListStart+=B,e.shops.length<B&&(t.storeListLoadFinished=!0),t.storeList=e.shops})},onStoreLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getStoreListData(e).then(function(e){var i;t.onStoreLoading=!1,t.storeListStart+=B,e.shops.length<B&&(t.storeListLoadFinished=!0),(i=t.storeList).push.apply(i,Object(s["a"])(e.shops))})},getStoreListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={start:t.storeListStart,size:B,paged:!0,keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/houses?m=getAllHouses"),data:n}).then(function(t){i(t)})})},onItemClick:function(){this.onItemRefresh()},searchItem:function(t){this.onItemRefresh(t)},selectItem:function(t){this.item=t.name,this.itemId=t.id},onItemRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.itemListStart=0,this.itemListLoadFinished=!1,this.getItemListData(e).then(function(e){t.itemPopShow=!0,t.onItemLoading=!1,t.itemListStart+=B,e.goods.length<B&&(t.itemListLoadFinished=!0),t.itemList=e.goods})},onItemLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getItemListData(e).then(function(e){var i;t.onItemLoading=!1,t.itemListStart+=B,e.goods.length<B&&(t.itemListLoadFinished=!0),(i=t.itemList).push.apply(i,Object(s["a"])(e.goods))})},getItemListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={start:t.itemListStart,size:B,paged:!0,keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/goods"),data:n}).then(function(t){i(t)})})},onItemBigTypeClick:function(){this.onItemBigTypeRefresh()},searchItemBigType:function(t){this.onItemBigTypeRefresh(t)},selectItemBigType:function(t){this.itemBigType=t.name,this.itemBigTypeId=t.id,this.itemSmallType="请选择",this.itemSmallTypeId=""},onItemBigTypeRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.itemBigTypeListStart=0,this.itemBigTypeListLoadFinished=!1,this.getItemBigTypeListData(e).then(function(e){t.itemBigTypePopShow=!0,t.itemBigTypeLoading=!1,t.itemBigTypeListStart+=B,e.goodsTypes.length<B&&(t.itemBigTypeListLoadFinished=!0),t.itemBigTypeList=e.goodsTypes})},onItemBigTypeLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getItemBigTypeListData(e).then(function(e){var i;t.itemBigTypeLoading=!1,t.itemBigTypeListStart+=B,e.goodsTypes.length<B&&(t.itemBigTypeListLoadFinished=!0),(i=t.itemBigTypeList).push.apply(i,Object(s["a"])(e.goodsTypes))})},getItemBigTypeListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={start:t.itemBigTypeListStart,size:B,paged:!0,bigOrSmall:1,keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/goodTypes/report"),data:n}).then(function(t){i(t)})})},onItemSmallTypeClick:function(){if(""===this.itemBigTypeId)return this.$fxToast.fail("请先选择品项大类!"),!1;this.onItemSmallTypeRefresh()},searchItemSmallType:function(t){this.onItemSmallTypeRefresh(t)},selectItemSmallType:function(t){this.itemSmallType=t.name,this.itemSmallTypeId=t.id},onItemSmallTypeRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.itemSmallTypeListStart=0,this.itemSmallTypeListLoadFinished=!1,this.getItemSmallTypeListData(e).then(function(e){t.itemSmallTypePopShow=!0,t.itemSmallTypeLoading=!1,t.itemSmallTypeListStart+=B,e.goodsTypes.length<B&&(t.itemSmallTypeListLoadFinished=!0),t.itemSmallTypeList=e.goodsTypes})},onItemSmallTypeLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getItemSmallTypeListData(e).then(function(e){var i;t.itemSmallTypeLoading=!1,t.itemSmallTypeListStart+=B,e.goodsTypes.length<B&&(t.itemSmallTypeListLoadFinished=!0),(i=t.itemSmallTypeList).push.apply(i,Object(s["a"])(e.goodsTypes))})},getItemSmallTypeListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={start:t.itemSmallTypeListStart,size:B,paged:!0,bigOrSmall:2,goodsBigType:t.itemBigTypeId,keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/goodTypes/report"),data:n}).then(function(t){i(t)})})},onItemTypeClick:function(){this.onItemTypeRefresh()},searchItemType:function(t){this.onItemTypeRefresh(t)},selectItemType:function(t){this.itemType=t.name,this.itemTypeId=t.id},onItemTypeRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.itemTypeListStart=0,this.itemTypeListLoadFinished=!1,this.getItemTypeListData(e).then(function(e){t.itemTypePopShow=!0,t.itemTypeLoading=!1,t.itemTypeListStart+=B,e.goodsStyle.length<B&&(t.itemTypeListLoadFinished=!0),t.itemTypeList=e.goodsStyle})},onItemTypeLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getItemTypeListData(e).then(function(e){var i;t.itemTypeLoading=!1,t.itemTypeListStart+=B,e.goodsStyle.length<B&&(t.itemTypeListLoadFinished=!0),(i=t.itemTypeList).push.apply(i,Object(s["a"])(e.goodsStyle))})},getItemTypeListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={start:t.itemTypeListStart,size:B,paged:!0,keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/goodsStyle/report"),data:n}).then(function(t){i(t)})})}}},R=F,E=(i("d1da"),Object(b["a"])(R,x,A,!1,null,"7b21bc78",null)),O=E.exports,j=50,$={name:"stockApplySendDetails",components:{orderItem:P,listComp:D["a"],checkBox:S["a"],filterPop:O},data:function(){return{query:this.$route.query,orderItemList:[],formatterSysPointKey:["waitAmount","busUnitAmount"],itemInputFocusing:!1,itemSearchPopShow:!1,searchWord:null,searchItem:[],supplier:"请选择",supplierId:"",supplierPopShow:!1,supplierList:[],currentEditData:[],filterPopShow:!1,filterParams:{},batchSetFlag:!1}},created:function(){this.refreshOrderList()},beforeRouteLeave:function(t,e,i){var n=this;if(this.itemInputFocusing)return this.$router.go(1),!1;"/stockApplySend"===t.path?this.$dialog.confirm({title:"提示",message:"若已修改,请先保存单据<br/>是否关闭页面?"}).then(function(){i()}).catch(function(){return n.$router.go(1),!1}):i()},computed:Object(u["a"])({},Object(h["c"])({sysPointSize:"sysPointSize",loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId}}),{isSelectAll:function(){var t=this.orderItemList.filter(function(t){return!!t.checked});return t.length===this.orderItemList.length&&this.orderItemList.length}}),methods:{orderListPostHandler:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={billId:t.query.orderIds.join(","),keyword:t.searchWord};n=c()(n,e),t.$fxHttp.requestPost({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/stockApplies/users/").concat(t.loginerId),query:{m:"pageList4StockSendRight"},data:n}).then(function(t){i(t)})})},refreshOrderList:function(){var t=this;return new d.a(function(e){t.orderListPostHandler().then(function(i){var n=i.stockApplyBillDetails;t.formatterSysPoint(n),t.orderItemList=n,e(i)})})},formatterSysPoint:function(t){var e=this,i=function(t){return l()(e.$fxUtils.toFixedSHW(t,e.sysPointSize))};t.forEach(function(t){e.formatterSysPointKey.forEach(function(e){t[e]=i(t[e])})})},translateFilterParams:function(t){return this.$fxUtils.isEmptyObjSHW(t)?{}:{houseId:""===t.storeId?null:t.storeId,goodsId:""===t.itemId?null:t.itemId,supplierId:""===t.supplierId?null:t.supplierId,goodsSmallTypeId:""===t.itemSmallTypeId?null:t.itemSmallTypeId,goodsBigTypeId:""===t.itemBigTypeId?null:t.itemBigTypeId,goodsStyleId:""===t.itemTypeId?null:t.itemTypeId}},onFilterClick:function(){this.filterPopShow=!0},onFilterConfirm:function(t){var e=this,i={houseId:""===t.storeId?null:t.storeId,goodsId:""===t.itemId?null:t.itemId,supplierId:""===t.supplierId?null:t.supplierId,goodsSmallTypeId:""===t.itemSmallTypeId?null:t.itemSmallTypeId,goodsBigTypeId:""===t.itemBigTypeId?null:t.itemBigTypeId,goodsStyleId:""===t.itemTypeId?null:t.itemTypeId};this.orderListPostHandler(i).then(function(t){e.orderItemList=t.stockApplyBillDetails})},onSearchChange:function(){this.itemSearchPopShow=!0,this.refreshOrderList()},onSearchConfirm:function(t){this.orderItemList=t},onPackingClick:function(t){this.currentEditData=[t],this.onPackingRefresh()},searchPacking:function(t){this.onPackingRefresh(t)},selectPacking:function(t){var e=this;this.currentEditData.forEach(function(i){var n=e.orderItemList.find(function(t){return i.id===t.id});n.packingDTO={id:t.id,name:t.name},e.$set(n,"changeType","edit")})},onPackingRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.packingListStart=0,this.getPackingListData(e).then(function(e){t.packingPopShow=!0,t.packingList=e.packing})},onPackingLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getPackingListData(e).then(function(e){var i;(i=t.packingList).push.apply(i,Object(s["a"])(e.packing))})},getPackingListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new d.a(function(i){var n={m:"getGoodsPackingList",start:t.packingListStart,size:j,paged:!0,keyword:e,goodsId:t.currentEditData[0].goodsDTO.id};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/goods"),data:n}).then(function(e){t.onPackingLoading=!1,t.packingListStart+=j,e.packing.length<j?t.packingListLoadFinished=!0:t.packingListLoadFinished=!1,i(e)})})},onBatchSetClick:function(){var t=this.orderItemList.filter(function(t){return!!t.checked});if(!t.length)return this.$fxToast.fail("请选择明细！"),!1;this.currentEditData=t,this.onSupplierRefresh(),this.batchSetFlag=!0},onSupplierClick:function(t){this.currentEditData=[t],this.onSupplierRefresh()},searchSupplier:function(t){this.onSupplierRefresh(t)},selectSupplier:function(t){var e=this;this.currentEditData.forEach(function(i){var n=e.orderItemList.find(function(t){return i.id===t.id});n.supplierDTO={id:t.id,name:t.name},n.priceWithTax=t.priceWithTax,e.$set(n,"changeType","edit")}),this.batchSetFlag&&(this.batchSetFlag=!1,this.onSaveClick())},onSupplierRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.getSupplierListData(e).then(function(e){t.supplierList=e.suppliers,t.supplierPopShow=!0})},getSupplierListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new d.a(function(i){var n=t.currentEditData.reduce(function(t,e){return t.concat(e.goodsDTO.id)},[]);if(0===n.length)return t.$fxToast.fail("请选择品项！"),!1;var o={m:"getGoodsSupplier",sendGoodsId:n.join(","),shopId:t.currentEditData[0].shopDTO.id,detailId:t.currentEditData[0].id,keyword:e};t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/stockApplies/").concat(t.loginerId),data:o}).then(function(t){i(t)})})},onSelectAllClick:function(){var t=this,e=!this.isSelectAll;this.orderItemList.forEach(function(i){t.$set(i,"checked",e)})},validatePacking:function(t,e){var i=this;return new d.a(function(n){if(i.sysShowPacking){var o=t.filter(function(t){if((1===t.shopDTO.organType||2===t.shopDTO.organType)&&!t.packingDTO)return t});if(o.length){var s="";return o.forEach(function(t){s+="品项:"+t.goodsDTO.name+"与仓库:"+t.houseDTO.name+"，"}),i.$dialog.alert({title:"提示",message:s+" 无有效包装信息, "+e+"失败！"}),!1}n()}else n()})},validateSupplier:function(t,e){var i=this;return new d.a(function(n){var o=t.filter(function(t){if(!t.supplierDTO)return t});if(o.length){var s="";return o.forEach(function(t){s+="品项:"+t.goodsDTO.name+"与仓库:"+t.houseDTO.name+"，"}),i.$dialog.alert({title:"提示",message:s+" 无有效供货商, "+e+"失败！"}),!1}n()})},validateSaveSupplier:function(t){var e=this;return new d.a(function(i){if(t.length){var n={details:t};e.saveHandler(n).then(function(){i()})}else i()})},onSaveClick:function(){var t=this,e=this.orderItemList.filter(function(t){return"edit"===t.changeType});if(0===e.length)return this.$fxToast.fail("请修改品项！"),!1;this.validateSupplier(e,"保存").then(function(){t.$dialog.confirm({title:"提示",message:"确定要保存吗?"}).then(function(){var e=t.getSaveParams();t.saveHandler(e).then(function(e){t.refreshOrderList().then(function(){t.$dialog.alert({title:"提示",message:e.message})})})})})},saveHandler:function(t){var e=this;return new d.a(function(i){e.$fxHttp.requestPut({url:"".concat(e.$fxBaseApi.url,"/accounts/").concat(e.loginerShopId,"/stockApplies/users/").concat(e.loginerId),data:t,query:{m:"saveRigthSend"}}).then(function(t){i(t)})})},onSendClick:function(){var t=this,e=this.orderItemList.filter(function(t){return t.checked});if(0===e.length)return this.$fxToast.fail("请选择品项！"),!1;this.validateSupplier(e,"分派").then(function(){t.validateSaveSupplier(e).then(function(){t.$dialog.confirm({title:"提示",message:"确定要分派吗?"}).then(function(){var i={details:e};t.sendHandler(i).then(function(e){t.refreshOrderList().then(function(){t.$dialog.alert({title:"提示",message:e.message})})})})})})},sendHandler:function(t){var e=this;return new d.a(function(i){e.$fxHttp.requestPut({url:"".concat(e.$fxBaseApi.url,"/accounts/").concat(e.loginerShopId,"/stockApplies/users/").concat(e.loginerId),data:t,query:{m:"assignRight"}}).then(function(t){i(t)})})},onCollectSendClick:function(){var t=this,e=this.orderItemList.filter(function(t){return t.checked});if(0===e.length)return this.$fxToast.fail("请选择品项！"),!1;this.validateSupplier(e,"放弃分派").then(function(){t.validateSaveSupplier(e).then(function(){t.$dialog.confirm({title:"提示",message:"确定要放弃分派吗?"}).then(function(){var i={details:e};t.collectSendHandler(i).then(function(e){t.refreshOrderList().then(function(){t.$dialog.alert({title:"提示",message:e.message})})})})})})},collectSendHandler:function(t){var e=this;return new d.a(function(i){e.$fxHttp.requestPut({url:"".concat(e.$fxBaseApi.url,"/accounts/").concat(e.loginerShopId,"/stockApplies/users/").concat(e.loginerId),data:t,query:{m:"noAssignRight"}}).then(function(t){i(t)})})},getSaveParams:function(){var t=[];this.orderItemList.forEach(function(e){t.push(e)});var e=t.filter(function(t){return"edit"===t.changeType}),i={details:e.length>0?e:null};return i}}},N=$,W=(i("be31"),Object(b["a"])(N,n,o,!1,null,"7783f7eb",null));e["default"]=W.exports},8081:function(t,e,i){"use strict";var n=i("c691"),o=i.n(n);o.a},"8d5d":function(t,e,i){"use strict";var n=i("08d9"),o=i.n(n);o.a},a09d:function(t,e,i){},a3d7:function(t,e,i){"use strict";var n=i("2b82"),o=i.n(n);o.a},be31:function(t,e,i){"use strict";var n=i("374c"),o=i.n(n);o.a},c691:function(t,e,i){},ce2a:function(t,e,i){"use strict";var n=i("40ca"),o=i.n(n);o.a},cf93:function(t,e,i){},d1da:function(t,e,i){"use strict";var n=i("f903"),o=i.n(n);o.a},dab9:function(t,e,i){"use strict";var n=i("a09d"),o=i.n(n);o.a},eb03:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.popupShowFlag,callback:function(e){t.popupShowFlag=e},expression:"popupShowFlag"}},[i("listComp",{attrs:{visibleFlag:t.popupShowFlag,title:t.title,data:t.listData,loadFinished:t.currentLoadFinish,loading:t.onItemLoading},on:{"update:visibleFlag":function(e){t.popupShowFlag=e},"update:visible-flag":function(e){t.popupShowFlag=e},"update:loading":function(e){t.onItemLoading=e},"on-search":t.onSearchHandler,"on-select":t.onSelectHandler,"on-load":t.onListLoad}})],1)},o=[],s=i("75fc"),a=i("795b"),l=i.n(a),r=(i("c5f6"),i("f6bb")),c=50,p={name:"filterListPopup",components:{listComp:r["a"]},props:{value:Boolean,title:String,rollingLoad:Boolean,itemSize:{type:Number,default:c},getDataApi:Function},data:function(){return{popupShowFlag:!1,itemListLoadFinished:!1,onItemLoading:!1,listStart:0,listData:[]}},computed:{currentLoadFinish:function(){return this.itemListLoadFinished||!this.rollingLoad}},watch:{value:{immediate:!0,handler:function(t){var e=this;t&&this.onListRefresh().then(function(){e.$emit("on-show")})}},popupShowFlag:{immediate:!0,handler:function(t){t||this.$emit("input",!1)}}},methods:{onSearchHandler:function(t){this.onListRefresh(t)},onSelectHandler:function(t){this.$emit("on-select",t)},onListRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.listStart=0,new l.a(function(i){t.getDataApi(e,t.listStart,t.itemSize).then(function(e){t.popupShowFlag=!0,t.onItemLoading=!1,t.listStart+=t.itemSize,t.itemListLoadFinished=e.length<t.itemSize,t.listData=e,i()})})},onListLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getDataApi(e,this.listStart,this.itemSize).then(function(e){var i;t.onItemLoading=!1,t.listStart+=t.itemSize,e.length<t.itemSize&&(t.itemListLoadFinished=!0),(i=t.listData).push.apply(i,Object(s["a"])(e))})}}},d=p,u=i("2877"),h=Object(u["a"])(d,n,o,!1,null,null,null);e["a"]=h.exports},f3c0:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRFMEVGQjYxREY1QzExRTk4NEQxQzk4RUQzQjYwMzQxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRFMEVGQjYyREY1QzExRTk4NEQxQzk4RUQzQjYwMzQxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEUwRUZCNUZERjVDMTFFOTg0RDFDOThFRDNCNjAzNDEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEUwRUZCNjBERjVDMTFFOTg0RDFDOThFRDNCNjAzNDEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5jgS7LAAAC50lEQVR42sSXy2tTQRTGzyS1KFgxYqkLQaWtAREXYiJpNUQLEaqCj/pAfBStuHHhRtC/wG4EX4hvKrpR3NWapq2KsZigreimBJtErSsfNYipSKh3/KYZ4zWZ3HtjEnrgy+ZOzm/mnJkzZxjnnKbDqsRP2xnNbByD1kIboWaoAXLIb0koBj2D7kNPIcPV3Dtmy4ANzAa1QyclTGV1UmJCx+UkTkFdkGbkuJAtgSLQdQOoyhrkfyLSR1FgH/QccpWQRpf04bUK9kNBaH4Z9pDw0Q9tMAM7Re6h6jJu4Grp01kIbIduQTUVOD2zpW+7CnygxJxayXl7LpjJI1M28y1jdHZ/3hY6IVlZsLfII2NoLcsZdaxjtGCu8qh59eDWckH9Kxgd9DGagWzejSgLWGu2ZMKalHUSQbFjapO/rEE3rWS0p4lRFaC3Bzl1v1SCPXpwo2rEkRZGNsDvhDmNpwwKOcZsXcVox2o2lcGuJ5wCrzkVuH+W6sEOZe2rY7S4FmdhJtHVR5ySE2rwdhejXR5Gk6jMN0OcggJaeJ4Os1pNlwY0+jBO5K7P5G3OrH+/izTsRmiF0kjHlYeceo2heQUkqfoY+0h0oU+jMcA9jYwOr2dUI+HViJVYZZub0fefRJcHOD0esXS3J/Xg0UKj4oCfD/6Fd2DlC+fRVD63IcTffojIcApFLTcUb/Q5DkNrCo18+4noXK9GR/02anYyWlSbgX+dyIR3KFFUFxPWr7jHbPS7z4Bj5QlMQkDFLr/YVzRU2AM9OCQ7B0Mb+wJYv0bhUU7XsMtfvS8aGpOtURYsPHRa+adY+ekeTi8S/9Ukdv5ph/THSfRIQxW8nYYlI+9aFIVxH5SqAFT43CsZyg4kCu2E0mWEpqXPqFnPFYC2lGnlKekrYLXLDMiOYbjEnLpUULNaLULjhg6JAlYEMC7/484Nb94TxsDE1r8hd6OobJvl3V2f84SJyydMNzRo9ILIXqXT9Wj7LcAAqr/RbQBzkgIAAAAASUVORK5CYII="},f6bb:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shop-popup"},[i("w-header",{attrs:{title:t.title,leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),i("van-pro-search",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"}],attrs:{shape:"round"},on:{search:t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),i("div",{staticClass:"popup-content"},[i("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"immediate-check":t.immediateCheck,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.data,function(e){return i("van-cell",{key:e.id,staticClass:"fx-van-cell",attrs:{title:e.name},on:{click:function(i){return t.indexListClick(e)}}})}),1)],1)],1)},o=[],s={name:"filterPop",props:{loading:Boolean,visibleFlag:Boolean,title:String,data:{type:Array,default:function(){return[]}},searchShow:{type:Boolean,default:!0},loadFinished:Boolean,immediateCheck:{type:Boolean,default:!0}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",listLoading:!1,listError:!1}},watch:{loading:{handler:function(t){t||(this.listLoading=!1)},immediate:!0},visibleFlag:function(t){t&&(this.searchKey="")}},methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},indexListClick:function(t){this.$emit("on-select",t),this.$emit("update:visibleFlag",!1)},search:function(t){this.$emit("on-search",t)},onLoad:function(){this.$emit("update:loading",!0),this.$emit("on-load",this.searchKey||null)}}},a=s,l=(i("8d5d"),i("2877")),r=Object(l["a"])(a,n,o,!1,null,"2a1c11fe",null);e["a"]=r.exports},f903:function(t,e,i){},faf1:function(t,e,i){"use strict";var n=i("cf93"),o=i.n(n);o.a}}]);
//# sourceMappingURL=stockApplySend.ea142ea3.js.map