(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["reportCb070~reportDp080~reportDqjcb4cld~reportKc010~reportKc011"],{"0498":function(t,e,n){"use strict";var o=n("5550"),r=n.n(o);r.a},"08d9":function(t,e,n){},"1d9d":function(t,e,n){"use strict";var o=n("fe1c"),r=n.n(o);r.a},3026:function(t,e,n){},"3a5e":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{attrs:{title:t.title,value:t.value,"value-class":"filter-cell-value"},on:{click:t.onCellClick}},[n("van-icon",{staticClass:"filter-cell-right-icon",attrs:{slot:"right-icon",name:t.showCloseBtn?"close":"arrow"},on:{click:function(e){e.stopPropagation(),t.showCloseBtn?t.onCellClear():t.onCellClick()}},slot:"right-icon"})],1)},r=[],i={name:"filterCell",props:{title:String,value:null,showCloseBtn:Boolean,disabled:Boolean},methods:{onCellClick:function(){if(this.disabled)return!1;this.$emit("on-click")},onCellClear:function(){if(this.disabled)return!1;this.$emit("on-clear")}}},a=i,l=(n("b4aa"),n("2877")),c=Object(l["a"])(a,o,r,!1,null,"f2f0e5f4",null);e["a"]=c.exports},"3b8d":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var o=n("795b"),r=n.n(o);function i(t,e,n,o,i,a,l){try{var c=t[a](l),s=c.value}catch(u){return void n(u)}c.done?e(s):r.a.resolve(s).then(o,i)}function a(t){return function(){var e=this,n=arguments;return new r.a(function(o,r){var a=t.apply(e,n);function l(t){i(a,o,r,l,c,"next",t)}function c(t){i(a,o,r,l,c,"throw",t)}l(void 0)})}}},"4eb9":function(t,e,n){"use strict";var o=n("d3b8"),r=n.n(o);r.a},5550:function(t,e,n){},"58ab":function(t,e,n){"use strict";var o=n("a4bb"),r=n.n(o),i=(n("ac6a"),n("795b")),a=n.n(i),l=n("cebc"),c=n("2f62");e["a"]={computed:Object(l["a"])({},Object(c["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId}})),methods:{getAuth:function(){var t=this;return new a.a(function(e){t.$fxHttp.requestGet({url:"".concat(t.$fxBaseApi.url,"/accounts/").concat(t.loginerShopId,"/users/").concat(t.loginerId,"/function"),loading:!1}).then(function(t){e(t.functionMapData[0])})})},syncAuth:function(){var t=this;return this.getAuth().then(function(e){return t.commitAuth(e),a.a.resolve(e)})},commitAuth:function(t){var e=this.$fxAuthModule.fxAuthInit(t),n=this.$fxAuthModule.fxSysAuthInit(t),o=this.$fxAuthModule.fxReportFormAuthInit(t);this.$store.commit({type:"SET_AUTH_LOCAL_JSON",billAuth:e,billSysAuth:n,reportFormAuth:o}),console.log(e),console.log(n),console.log(o),this.getAuthHaveSysParam(t)},getAuthHaveSysParam:function(t){var e={};r()(t).forEach(function(n){var o=t[n];e[n]={},o.forEach(function(t){e[n][t.functionCode]=t})}),console.log("包含系统参数的权限:"),console.log(e)}}}},8922:function(t,e,n){"use strict";var o=n("e26f"),r=n.n(o);r.a},"8d5d":function(t,e,n){"use strict";var o=n("08d9"),r=n.n(o);r.a},"96cf":function(t,e,n){var o=function(t){"use strict";var e,n=Object.prototype,o=n.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function c(t,e,n,o){var r=e&&e.prototype instanceof d?e:d,i=Object.create(r.prototype),a=new D(o||[]);return i._invoke=x(t,n,a),i}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(o){return{type:"throw",arg:o}}}t.wrap=c;var u="suspendedStart",h="suspendedYield",f="executing",p="completed",m={};function d(){}function v(){}function g(){}var y={};y[i]=function(){return this};var C=Object.getPrototypeOf,b=C&&C(C(A([])));b&&b!==n&&o.call(b,i)&&(y=b);var w=g.prototype=d.prototype=Object.create(y);function S(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function F(t){function e(n,r,i,a){var l=s(t[n],t,r);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"===typeof u&&o.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):Promise.resolve(u).then(function(t){c.value=t,i(c)},function(t){return e("throw",t,i,a)})}a(l.arg)}var n;function r(t,o){function r(){return new Promise(function(n,r){e(t,o,n,r)})}return n=n?n.then(r,r):r()}this._invoke=r}function x(t,e,n){var o=u;return function(r,i){if(o===f)throw new Error("Generator is already running");if(o===p){if("throw"===r)throw i;return _()}n.method=r,n.arg=i;while(1){var a=n.delegate;if(a){var l=k(a,n);if(l){if(l===m)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===u)throw o=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var c=s(t,e,n);if("normal"===c.type){if(o=n.done?p:h,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=p,n.method="throw",n.arg=c.arg)}}}function k(t,n){var o=t.iterator[n.method];if(o===e){if(n.delegate=null,"throw"===n.method){if(t.iterator["return"]&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=s(o,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,m;var i=r.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(t){if(t){var n=t[i];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){while(++r<t.length)if(o.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:_}}function _(){return{value:e,done:!0}}return v.prototype=w.constructor=g,g.constructor=v,g[l]=v.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l in t||(t[l]="GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},S(F.prototype),F.prototype[a]=function(){return this},t.AsyncIterator=F,t.async=function(e,n,o,r){var i=new F(c(e,n,o,r));return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},S(w),w[l]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){while(e.length){var o=e.pop();if(o in t)return n.value=o,n.done=!1,n}return n.done=!0,n}},t.values=A,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(o,r){return l.type="throw",l.arg=t,n.next=o,r&&(n.method="next",n.arg=e),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),s=o.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;P(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:A(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=o}catch(r){Function("r","regeneratorRuntime = r")(o)}},b4aa:function(t,e,n){"use strict";var o=n("3026"),r=n.n(o);r.a},cd56:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"filter-popup"},[n("w-header",{attrs:{title:"筛选条件",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),n("div",{staticClass:"filter-content"},[t._t("solt-filter-cell")],2),n("div",{staticClass:"filter-bottom"},[n("van-button",{staticClass:"reset-btn fx-no-radius",attrs:{type:"info"},on:{click:t.onResetClick}},[t._v("重置")]),n("van-button",{staticClass:"confirm-btn fx-no-radius",attrs:{type:"primary"},on:{click:t.onConfirmClick}},[t._v("确定")])],1),t._t("default")],2)},r=[],i={name:"filterPopComp",data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0}}},methods:{onCloseClick:function(){this.$emit("on-close")},onConfirmClick:function(){this.$emit("on-confirm")},onResetClick:function(){this.$emit("on-reset")}}},a=i,l=(n("0498"),n("2877")),c=Object(l["a"])(a,o,r,!1,null,"33d6c6d6",null);e["a"]=c.exports},d3b8:function(t,e,n){},e26f:function(t,e,n){},eb03:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-popup",{staticClass:"fx-list-popup-300",attrs:{position:"right","lock-scroll":!1},model:{value:t.popupShowFlag,callback:function(e){t.popupShowFlag=e},expression:"popupShowFlag"}},[n("listComp",{attrs:{visibleFlag:t.popupShowFlag,title:t.title,data:t.listData,loadFinished:t.currentLoadFinish,loading:t.onItemLoading},on:{"update:visibleFlag":function(e){t.popupShowFlag=e},"update:visible-flag":function(e){t.popupShowFlag=e},"update:loading":function(e){t.onItemLoading=e},"on-search":t.onSearchHandler,"on-select":t.onSelectHandler,"on-load":t.onListLoad}})],1)},r=[],i=n("75fc"),a=n("795b"),l=n.n(a),c=(n("c5f6"),n("f6bb")),s=50,u={name:"filterListPopup",components:{listComp:c["a"]},props:{value:Boolean,title:String,rollingLoad:Boolean,itemSize:{type:Number,default:s},getDataApi:Function},data:function(){return{popupShowFlag:!1,itemListLoadFinished:!1,onItemLoading:!1,listStart:0,listData:[]}},computed:{currentLoadFinish:function(){return this.itemListLoadFinished||!this.rollingLoad}},watch:{value:{immediate:!0,handler:function(t){var e=this;t&&this.onListRefresh().then(function(){e.$emit("on-show")})}},popupShowFlag:{immediate:!0,handler:function(t){t||this.$emit("input",!1)}}},methods:{onSearchHandler:function(t){this.onListRefresh(t)},onSelectHandler:function(t){this.$emit("on-select",t)},onListRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.listStart=0,new l.a(function(n){t.getDataApi(e,t.listStart,t.itemSize).then(function(e){t.popupShowFlag=!0,t.onItemLoading=!1,t.listStart+=t.itemSize,t.itemListLoadFinished=e.length<t.itemSize,t.listData=e,n()})})},onListLoad:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getDataApi(e,this.listStart,this.itemSize).then(function(e){var n;t.onItemLoading=!1,t.listStart+=t.itemSize,e.length<t.itemSize&&(t.itemListLoadFinished=!0),(n=t.listData).push.apply(n,Object(i["a"])(e))})}}},h=u,f=n("2877"),p=Object(f["a"])(h,o,r,!1,null,null,null);e["a"]=p.exports},f6bb:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shop-popup"},[n("w-header",{attrs:{title:t.title,leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}}),n("van-pro-search",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"}],attrs:{shape:"round"},on:{search:t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),n("div",{staticClass:"popup-content"},[n("van-list",{attrs:{finished:t.loadFinished,"finished-text":"没有更多了",error:t.listError,"immediate-check":t.immediateCheck,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.listError=e},load:t.onLoad},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.data,function(e){return n("van-cell",{key:e.id,staticClass:"fx-van-cell",attrs:{title:e.name},on:{click:function(n){return t.indexListClick(e)}}})}),1)],1)],1)},r=[],i={name:"filterPop",props:{loading:Boolean,visibleFlag:Boolean,title:String,data:{type:Array,default:function(){return[]}},searchShow:{type:Boolean,default:!0},loadFinished:Boolean,immediateCheck:{type:Boolean,default:!0}},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},searchKey:"",listLoading:!1,listError:!1}},watch:{loading:{handler:function(t){t||(this.listLoading=!1)},immediate:!0},visibleFlag:function(t){t&&(this.searchKey="")}},methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},indexListClick:function(t){this.$emit("on-select",t),this.$emit("update:visibleFlag",!1)},search:function(t){this.$emit("on-search",t)},onLoad:function(){this.$emit("update:loading",!0),this.$emit("on-load",this.searchKey||null)}}},a=i,l=(n("8d5d"),n("2877")),c=Object(l["a"])(a,o,r,!1,null,"2a1c11fe",null);e["a"]=c.exports},fe17:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("w-app-page",[n("w-header",{attrs:{title:t.reportFormConfig.label,border:!0}},[n("w-icon",{staticClass:"report-head-btn",attrs:{slot:"header-right",type:"report-search-filter"},on:{click:t.onSearchClick},slot:"header-right"}),n("w-icon",{staticClass:"report-head-btn",attrs:{slot:"header-right",type:"report-column-filter"},on:{click:t.onColumnFilterClick},slot:"header-right"})],1),n("reportFormSearchBar",{directives:[{name:"show",rawName:"v-show",value:t.showSearchBar,expression:"showSearchBar"}],attrs:{reportFormId:t.reportFormConfig.id},on:{"on-search":t.inputSearchKey},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),n("w-virtual-table",{ref:"table",attrs:{sumCol:t.sumCol,frozenCol:t.frozenColProp,sort:!1,sumFormatter:t.sumFormatter}},t._l(t.columnData,function(e){return n("w-virtual-table-column",{key:e.code,attrs:{prop:e.code,label:e.name,decimal:e.decimal,visiable:e.selected},scopedSlots:t._u([{key:"default",fn:function(o){return"image"===e.type?n("div",{},[n("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.onImgCellClick(o)}}},[t._v("查看")])]):t._e()}}],null,!0)})}),1),n("van-popup",{staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.filterPopShow,callback:function(e){t.filterPopShow=e},expression:"filterPopShow"}},[t._t("slot-filter")],2),n("van-popup",{staticClass:"fx-list-popup-full",attrs:{position:"right","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.columnFilterPopShow,callback:function(e){t.columnFilterPopShow=e},expression:"columnFilterPopShow"}},[n("columnFilterPop",{attrs:{visibleFlag:t.columnFilterPopShow,planList:t.reportPlans,plan:t.defaultPlan,planDetails:t.columnData,planDetailsApi:t.getPlanDetail},on:{"update:visibleFlag":function(e){t.columnFilterPopShow=e},"update:visible-flag":function(e){t.columnFilterPopShow=e},"update:plan":function(e){t.defaultPlan=e},"update:planDetails":function(e){t.columnData=e},"update:plan-details":function(e){t.columnData=e},"on-confirm":t.onColumnFilterConfirm}})],1)],1)},r=[],i=n("59ad"),a=n.n(i),l=n("5176"),c=n.n(l),s=(n("7514"),n("ac6a"),n("a745")),u=n.n(s),h=(n("6762"),n("2fdb"),n("795b")),f=n.n(h),p=n("75fc"),m=n("cebc"),d=n("2f62"),v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"report-form-tools"},[n("w-icon",{staticClass:"frozen-btn",attrs:{type:t.frozenColumnFlag?"report-frozen-column-active":"report-frozen-column"},on:{click:t.onFrozenClick}}),n("van-pro-search",{staticClass:"report-form-search-bar",attrs:{shape:"round",clearable:!0,searchImmediate:!0,duration:100},on:{search:t.onSearch},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1)},g=[],y=n("bd86"),C={name:"reportFormSearchBar",props:{value:null,reportFormId:String},data:function(){return{searchText:""}},computed:Object(m["a"])({},Object(d["b"])(["reportFrozenColGetter"]),{frozenColumnFlag:function(){return this.reportFrozenColGetter(this.reportFormId)}}),watch:{value:{immediate:!0,handler:function(t){this.searchText=t}}},methods:{onSearch:function(t){this.$emit("input",t),this.$emit("on-search",t)},onFrozenClick:function(){this.$store.commit("SET_REPORT_FROZEN_COL",Object(y["a"])({},this.reportFormId,!this.frozenColumnFlag))}}},b=C,w=(n("4eb9"),n("2877")),S=Object(w["a"])(b,v,g,!1,null,"662f9a7a",null),F=S.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"filter-popup"},[n("w-header",{attrs:{title:"报表方案",leftOptions:t.leftOptions},on:{"on-click-back":t.onCloseClick}},[n("van-button",{staticClass:"header-confirm-btn",attrs:{slot:"header-right",type:"primary",size:"small",round:""},on:{click:t.onConfirmClick},slot:"header-right"},[t._v("确定")])],1),n("div",{ref:"filterContent",staticClass:"filter-content"},[n("div",{staticClass:"column-select-all"},[n("div",{staticClass:"column-select-tab",on:{click:t.onSelectAllClick}},[t._v(t._s(t.isSelectedAllColumn?"取消全部":"选择全部"))])]),t._l(t.columnData,function(e){return n("div",{key:e.code,staticClass:"column-select-item"},[n("div",{staticClass:"column-select-tab",class:{"is-active":e.selected},on:{click:function(n){return t.onColumnTabClick(e)}}},[t._v(t._s(e.name))])])})],2),n("div",{staticClass:"filter-bottom fx-shadow-up",on:{click:t.onPlanListClick}},[n("div",{staticClass:"reprot-form-plan-title"},[t._v("选择报表方案")]),n("div",{staticClass:"reprot-form-plan-value"},[t._v(t._s(t.plan.name))])]),n("van-actionsheet",{attrs:{actions:t.planList,"cancel-text":"取消"},on:{select:t.onPlanListSelect},model:{value:t.plansActionShow,callback:function(e){t.plansActionShow=e},expression:"plansActionShow"}})],1)},k=[],L=n("58ab"),P={name:"columnFilterPop",mixins:[L["a"]],props:{visibleFlag:Boolean,plan:{type:Object,default:function(){return{}}},planList:{type:Array,default:function(){return[]}},planDetails:{type:Array,default:function(){return[]}},planDetailsApi:Function},data:function(){return{leftOptions:{showBackBtn:!0,preventGoBack:!0},columnData:[],plansActionShow:!1}},computed:Object(m["a"])({},Object(d["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId}}),{isSelectedAllColumn:function(){return this.columnData.filter(function(t){return t.selected}).length===this.columnData.length}}),watch:{visibleFlag:{immediate:!0,handler:function(t){t&&this.initHandler()}}},methods:{onCloseClick:function(){this.$emit("update:visibleFlag",!1)},onConfirmClick:function(){this.$emit("update:visibleFlag",!1),this.$emit("update:planDetails",this.columnData),this.$emit("on-confirm",this.columnData)},initHandler:function(){this.columnData=this.$fxUtils.JSONcopy(this.planDetails)},onSelectAllClick:function(){var t=this.isSelectedAllColumn;this.columnData.forEach(function(e){e.selected=!t})},onColumnTabClick:function(t){t.selected=!t.selected},onPlanListClick:function(){var t=this;this.syncAuth().then(function(){t.plansActionShow=!0})},onPlanListSelect:function(t){var e=this;this.$emit("update:plan",t),this.planDetailsApi(t.id).then(function(t){e.$emit("update:planDetails",t),e.columnData=e.$fxUtils.JSONcopy(t),e.plansActionShow=!1})}}},D=P,A=(n("1d9d"),Object(w["a"])(D,x,k,!1,null,"6c330cc6",null)),_=A.exports,$=n("247f"),O={name:"report",components:{reportFormSearchBar:F,columnFilterPop:_},props:{reportFormConfig:{type:Object,default:function(){return{}}},planDetailsApi:Function,reportFormApi:Function,reportPlans:{type:Array,default:function(){return[]}},getReportParams:Function,filterPopShow:Boolean,showSearchBar:{type:Boolean,default:!1},reportFormId:{type:String,default:function(){return""}}},data:function(){return{columnData:[],sumCol:[],columnFilterPopShow:!1,defaultPlan:{},searchText:"",tableData:[],searchColumsKey:this.reportFormConfig.searchColumsKey,params:{}}},computed:Object(m["a"])({},Object(d["c"])({loginerShopId:function(t){return t.loginer.loginerShopId},loginerId:function(t){return t.loginer.loginerId},sysPointSize:"sysPointSize",sysMoneyPointSize:"sysMoneyPointSize"}),Object(d["b"])(["reportFrozenColGetter"]),{frozenColumnFlag:function(){return this.reportFrozenColGetter(this.reportFormConfig.id)},frozenColProp:function(){var t=this.columnData.filter(function(t){return!!t.selected});return this.frozenColumnFlag&&0!==t.length?t[0].code:""},extendColumns:function(){return[].concat(Object(p["a"])(this.createColumnsWithSysPointSize(this.reportFormConfig.columnCount||[])),Object(p["a"])(this.createColumnsWithSysMoneyPointSize(this.reportFormConfig.columnPrice||[])),Object(p["a"])(this.createImageColumns(this.reportFormConfig.columnImage||[])))}}),methods:{init:function(t){var e=this,n=t.reportPlan,o=t.getReportParams;this.initReportForm(n).then(function(){o().then(function(t){e.refreshReportForm(t)})})},initReportForm:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new f.a(function(n){t.defaultPlan=e,t.getPlanDetail(e.id).then(function(e){t.setColumnData(e),n()})})},getValidcols:function(){return this.columnData.filter(function(t){return!!t.selected}).map(function(t){return t.code}).join(",")},refreshReportForm:function(t){var e=this;this.$nextTick(function(){var n=e.$fxUtils.isDef(t)?t:e.getReportParams();n.validcols=e.getValidcols(),e.params=n,e.getReportData(n).then(function(t){"cld"===$["a"].getAppType()&&t&&n.validcols.includes("makeTime")&&t.map(function(t){t.makeTime=e.$fxUtils.timestampToTime(t.makeTime)}),e.tableData=t,e.$refs.table.initGrid(t)})})},getColumns:function(){return this.columnData},onColumnFilterClick:function(){this.columnFilterPopShow=!0},setColumnData:function(t){this.columnData=this.extendColumnsHandler(t),this.sumCol=t.reduce(function(t,e){return e.sum&&t.push(e.code),t},[])},extendColumnsHandler:function(t){var e=this;return u()(this.extendColumns)&&this.extendColumns.length>0&&t.forEach(function(t){var n=e.extendColumns.find(function(e){return t.code===e.prop});n&&(t=c()(t,n))}),t},createDecimalColumns:function(t,e){return t.map(function(t){return{prop:t,decimal:e}})},createColumnsWithSysPointSize:function(t){return this.createDecimalColumns(t,this.sysPointSize)},createColumnsWithSysMoneyPointSize:function(t){return this.createDecimalColumns(t,this.sysMoneyPointSize)},createImageColumns:function(t,e){return t.map(function(t){return{prop:t,type:"image"}})},getPlanDetail:function(t){var e={schemeId:t};return"function"===typeof this.planDetailsApi?this.planDetailsApi(e):"cld"===$["a"].getAppType()?this.$fxApi("reportForm.get4CldPlanDetail")(t,this.reportFormId):this.$fxApi("reportForm.getPlanDetail")(e)},getReportData:function(t){return"function"===typeof this.reportFormApi?this.reportFormApi(t):"cld"===$["a"].getAppType()?this.$fxApi("reportForm.get4CldReportData")(t,this.reportFormId):this.$fxApi("reportForm.getReportData")(t,this.reportFormConfig.id,this.reportFormConfig.responseKey)},sumFormatter:function(t,e){var n=this,o=this.columnData.find(function(t){return e===t.code}),r=o?o.decimal:4,i=t.reduce(function(t,o){var i=a()(t),l=a()(n.numberFormat(o[e],r));return isNaN(l)?i:i+l},0);return this.numberFormat(i,r)},onSearchClick:function(){this.$emit("update:filterPopShow",!0)},numberFormat:function(t,e){var n=Math.pow(10,e);return String(Math.round(t*n)/n)},inputSearchKey:function(){var t=this,e=this.tableData.filter(function(e){return!!t.searchColumsKey.find(function(n){return t.$fxUtils.fuzzyQueryString(e[n],t.searchText)})});this.$refs.table.initGrid(e)},onImgCellClick:function(t){var e=this,n=t.row,o=(t.index,document.createRange().createContextualFragment(n.lookPicture));this.$fxApi("reportForm.getGoodsImagesList")(o.firstChild.dataset.goodsId).then(function(t){if(0===t.length)return e.$fxToast.fail("没有可查看图片!"),!1;e.$fxImagePreview(t)})},onColumnFilterConfirm:function(t){this.setColumnData(t),this.refreshReportForm(this.params)}}},I=O,E=(n("8922"),Object(w["a"])(I,o,r,!1,null,"37fe484e",null));e["a"]=E.exports},fe1c:function(t,e,n){}}]);
//# sourceMappingURL=reportCb070~reportDp080~reportDqjcb4cld~reportKc010~reportKc011.423b5cfe.js.map